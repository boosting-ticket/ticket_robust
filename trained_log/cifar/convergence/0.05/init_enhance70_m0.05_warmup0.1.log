train_epochs : 70
results_path : None
log_path : ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance70_m0.05_warmup0.1.log
learning_rate : 0.1
resume : 0
mask_path : ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/pruned_lr0.05_mask_r80.npy
interval_weight : 0.1
gpu : 1
verbose : 200
attack_iter : 10
init : True
prune_method : unstructured
last_model_path : ./trained_models_new/
eps_step : 0.00784313725490196
model_path : ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance70_m0.05_warmup0.1.pth
max_pruning_ratio : 80
enhance_learning_rate : 0.1
starting_epsilon : 1e-05
enhance_method : nat
ft_interval_weight : 50
create_init : False
transfer : False
parallel : False
model_width : 8
init_step : 1400
seed : 7
warmup : True
init_path : ./trained_models_new/cifar/vgg16/init/pure_vgg16_init.pth
test_batch_size : 100
trades_beta : 6.0
weight_decay : 0.0001
targeted : False
batch_size : 64
clip_min : 0
dataset : cifar
train_method : nat
optm : sgd
noise_sd : 1.0
eval : False
epsilon : 0.03137254901960784
finetune_method : nat
early_stop : 100
n_pruning_steps : 1
norm : True
model_type : vgg16
model_name : init_enhance70_m0.05_warmup0.1
n_classes : 10
mask_name : pruned_lr0.05_mask_r80
schedule_length : 10
clip_max : 1.0
init_type : pure
enhance_epochs : 70
CUDA enabled.
Enhance training config:
Enhance training method: nat
model will be saved in: ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance70_m0.05_warmup0.1.pth
Init model is: ./trained_models_new/cifar/vgg16/init/pure_vgg16_init.pth
Init mask used from: ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/pruned_lr0.05_mask_r80.npy
Log will be saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance70_m0.05_warmup0.1.log
Random seed is: 7

model loading from ./trained_models_new/cifar/vgg16/init/pure_vgg16_init.pth
Epoch [0/70]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 2.2821, training acc = 0.14
Batch [200/704] training loss = 1.4941, training acc = 0.47
Batch [400/704] training loss = 1.4630, training acc = 0.50
Batch [600/704] training loss = 0.9208, training acc = 0.70
Valid Test with nat
Test accuracy: 49.02% (2451/5000), Test loss:1.4981
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance70_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 45.20% (4520/10000), Test loss:1.6361
Epoch [1/70], Passed time:[161.470/161.470]
learning rate: 0.020000000000000004
Batch [0/704] training loss = 1.0649, training acc = 0.59
Batch [200/704] training loss = 1.1265, training acc = 0.58
Batch [400/704] training loss = 0.7656, training acc = 0.70
Batch [600/704] training loss = 1.0629, training acc = 0.67
Valid Test with nat
Test accuracy: 71.74% (3587/5000), Test loss:0.8224
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance70_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 71.76% (7176/10000), Test loss:0.8189
Epoch [2/70], Passed time:[165.261/330.522]
learning rate: 0.030000000000000006
Batch [0/704] training loss = 0.6716, training acc = 0.77
Batch [200/704] training loss = 0.7342, training acc = 0.73
Batch [400/704] training loss = 0.8719, training acc = 0.75
Batch [600/704] training loss = 0.7339, training acc = 0.75
Valid Test with nat
Test accuracy: 73.94% (3697/5000), Test loss:0.7844
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance70_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 73.26% (7326/10000), Test loss:0.8023
Epoch [3/70], Passed time:[191.386/574.159]
learning rate: 0.04000000000000001
Batch [0/704] training loss = 0.7348, training acc = 0.72
Batch [200/704] training loss = 0.8184, training acc = 0.72
Batch [400/704] training loss = 0.8779, training acc = 0.69
Batch [600/704] training loss = 0.8326, training acc = 0.67
Valid Test with nat
Test accuracy: 74.82% (3741/5000), Test loss:0.7688
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance70_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 73.97% (7397/10000), Test loss:0.7710
Epoch [4/70], Passed time:[204.303/817.212]
learning rate: 0.05
Batch [0/704] training loss = 0.6454, training acc = 0.78
Batch [200/704] training loss = 0.4626, training acc = 0.83
Batch [400/704] training loss = 0.8405, training acc = 0.75
Batch [600/704] training loss = 0.8998, training acc = 0.69
Valid Test with nat
Test accuracy: 75.36% (3768/5000), Test loss:0.7493
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance70_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 78.47% (7847/10000), Test loss:0.6466
Epoch [5/70], Passed time:[214.079/1070.397]
learning rate: 0.06000000000000001
Batch [0/704] training loss = 0.4732, training acc = 0.83
Batch [200/704] training loss = 0.7944, training acc = 0.69
Batch [400/704] training loss = 0.6476, training acc = 0.81
Batch [600/704] training loss = 0.6336, training acc = 0.77
Valid Test with nat
Test accuracy: 77.68% (3884/5000), Test loss:0.6640
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance70_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 76.68% (7668/10000), Test loss:0.6933
Epoch [6/70], Passed time:[221.464/1328.785]
learning rate: 0.07
Batch [0/704] training loss = 0.5314, training acc = 0.81
Batch [200/704] training loss = 0.7500, training acc = 0.78
Batch [400/704] training loss = 0.5452, training acc = 0.78
Batch [600/704] training loss = 0.8220, training acc = 0.73
Valid Test with nat
Test accuracy: 74.26% (3713/5000), Test loss:0.7738
Epoch [7/70], Passed time:[225.348/1577.437]
learning rate: 0.08000000000000002
Batch [0/704] training loss = 0.6710, training acc = 0.78
Batch [200/704] training loss = 0.4843, training acc = 0.80
Batch [400/704] training loss = 0.4561, training acc = 0.81
Batch [600/704] training loss = 0.7122, training acc = 0.73
Valid Test with nat
Test accuracy: 75.28% (3764/5000), Test loss:0.7701
Epoch [8/70], Passed time:[228.859/1830.869]
learning rate: 0.09000000000000001
Batch [0/704] training loss = 0.6266, training acc = 0.77
Batch [200/704] training loss = 0.6448, training acc = 0.70
Batch [400/704] training loss = 0.4873, training acc = 0.83
Batch [600/704] training loss = 0.4943, training acc = 0.86
Valid Test with nat
Test accuracy: 81.98% (4099/5000), Test loss:0.5500
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance70_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 82.56% (8256/10000), Test loss:0.5286
Epoch [9/70], Passed time:[231.911/2087.202]
learning rate: 0.1
Batch [0/704] training loss = 0.5025, training acc = 0.84
Batch [200/704] training loss = 0.7062, training acc = 0.78
Batch [400/704] training loss = 0.4981, training acc = 0.81
Batch [600/704] training loss = 0.5368, training acc = 0.84
Valid Test with nat
Test accuracy: 79.12% (3956/5000), Test loss:0.6190
Epoch [10/70], Passed time:[232.750/2327.497]
learning rate: 0.1
Batch [0/704] training loss = 0.3579, training acc = 0.89
Batch [200/704] training loss = 0.5316, training acc = 0.81
Batch [400/704] training loss = 0.6887, training acc = 0.77
Batch [600/704] training loss = 0.6054, training acc = 0.81
Valid Test with nat
Test accuracy: 83.92% (4196/5000), Test loss:0.4905
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance70_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 83.35% (8335/10000), Test loss:0.4907
Epoch [11/70], Passed time:[233.226/2565.490]
learning rate: 0.1
Batch [0/704] training loss = 0.4826, training acc = 0.83
Batch [200/704] training loss = 0.4718, training acc = 0.89
Batch [400/704] training loss = 0.4856, training acc = 0.88
Batch [600/704] training loss = 0.3832, training acc = 0.88
Valid Test with nat
Test accuracy: 80.02% (4001/5000), Test loss:0.6043
Epoch [12/70], Passed time:[233.816/2805.797]
learning rate: 0.1
Batch [0/704] training loss = 0.4057, training acc = 0.83
Batch [200/704] training loss = 0.6980, training acc = 0.78
Batch [400/704] training loss = 0.3988, training acc = 0.86
Batch [600/704] training loss = 0.5192, training acc = 0.83
Valid Test with nat
Test accuracy: 80.10% (4005/5000), Test loss:0.6101
Epoch [13/70], Passed time:[233.835/3039.849]
learning rate: 0.1
Batch [0/704] training loss = 0.4852, training acc = 0.86
Batch [200/704] training loss = 0.4105, training acc = 0.88
Batch [400/704] training loss = 0.5181, training acc = 0.80
Batch [600/704] training loss = 0.4505, training acc = 0.84
Valid Test with nat
Test accuracy: 82.96% (4148/5000), Test loss:0.5053
Epoch [14/70], Passed time:[234.701/3285.818]
learning rate: 0.1
Batch [0/704] training loss = 0.4577, training acc = 0.86
Batch [200/704] training loss = 0.5834, training acc = 0.81
Batch [400/704] training loss = 0.4503, training acc = 0.86
Batch [600/704] training loss = 0.5855, training acc = 0.75
Valid Test with nat
Test accuracy: 82.30% (4115/5000), Test loss:0.5275
Epoch [15/70], Passed time:[236.580/3548.697]
learning rate: 0.1
Batch [0/704] training loss = 0.3862, training acc = 0.84
Batch [200/704] training loss = 0.3518, training acc = 0.86
Batch [400/704] training loss = 0.4178, training acc = 0.88
Batch [600/704] training loss = 0.4302, training acc = 0.86
Valid Test with nat
Test accuracy: 83.28% (4164/5000), Test loss:0.5004
Epoch [16/70], Passed time:[238.477/3815.628]
learning rate: 0.1
Batch [0/704] training loss = 0.5939, training acc = 0.78
Batch [200/704] training loss = 0.6334, training acc = 0.77
Batch [400/704] training loss = 0.3769, training acc = 0.88
Batch [600/704] training loss = 0.5359, training acc = 0.86
Valid Test with nat
Test accuracy: 81.26% (4063/5000), Test loss:0.5749
Epoch [17/70], Passed time:[239.694/4074.799]
learning rate: 0.1
Batch [0/704] training loss = 0.4100, training acc = 0.86
Batch [200/704] training loss = 0.3127, training acc = 0.86
Batch [400/704] training loss = 0.2893, training acc = 0.91
Batch [600/704] training loss = 0.4550, training acc = 0.86
Valid Test with nat
Test accuracy: 82.56% (4128/5000), Test loss:0.5352
Epoch [18/70], Passed time:[240.990/4337.828]
learning rate: 0.1
Batch [0/704] training loss = 0.3641, training acc = 0.91
Batch [200/704] training loss = 0.3992, training acc = 0.84
Batch [400/704] training loss = 0.3084, training acc = 0.92
Batch [600/704] training loss = 0.7831, training acc = 0.77
Valid Test with nat
Test accuracy: 83.30% (4165/5000), Test loss:0.5301
Epoch [19/70], Passed time:[242.345/4604.558]
learning rate: 0.1
Batch [0/704] training loss = 0.3413, training acc = 0.88
Batch [200/704] training loss = 0.5323, training acc = 0.83
Batch [400/704] training loss = 0.3727, training acc = 0.88
Batch [600/704] training loss = 0.4333, training acc = 0.81
Valid Test with nat
Test accuracy: 80.80% (4040/5000), Test loss:0.6264
Epoch [20/70], Passed time:[243.217/4864.334]
learning rate: 0.1
Batch [0/704] training loss = 0.3912, training acc = 0.86
Batch [200/704] training loss = 0.4055, training acc = 0.83
Batch [400/704] training loss = 0.4638, training acc = 0.81
Batch [600/704] training loss = 0.5111, training acc = 0.84
Valid Test with nat
Test accuracy: 83.42% (4171/5000), Test loss:0.5094
Epoch [21/70], Passed time:[244.667/5138.002]
learning rate: 0.1
Batch [0/704] training loss = 0.3097, training acc = 0.91
Batch [200/704] training loss = 0.4768, training acc = 0.81
Batch [400/704] training loss = 0.4835, training acc = 0.89
Batch [600/704] training loss = 0.4177, training acc = 0.84
Valid Test with nat
Test accuracy: 84.54% (4227/5000), Test loss:0.4963
Epoch [22/70], Passed time:[245.512/5401.268]
learning rate: 0.1
Batch [0/704] training loss = 0.3066, training acc = 0.89
Batch [200/704] training loss = 0.4097, training acc = 0.88
Batch [400/704] training loss = 0.3765, training acc = 0.83
Batch [600/704] training loss = 0.3740, training acc = 0.88
Valid Test with nat
Test accuracy: 85.02% (4251/5000), Test loss:0.4714
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance70_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 83.71% (8371/10000), Test loss:0.4832
Epoch [23/70], Passed time:[246.871/5678.025]
learning rate: 0.1
Batch [0/704] training loss = 0.2116, training acc = 0.92
Batch [200/704] training loss = 0.4095, training acc = 0.88
Batch [400/704] training loss = 0.4237, training acc = 0.89
Batch [600/704] training loss = 0.4925, training acc = 0.83
Valid Test with nat
Test accuracy: 84.50% (4225/5000), Test loss:0.4848
Epoch [24/70], Passed time:[248.154/5955.704]
learning rate: 0.1
Batch [0/704] training loss = 0.4120, training acc = 0.86
Batch [200/704] training loss = 0.2535, training acc = 0.89
Batch [400/704] training loss = 0.5191, training acc = 0.84
Batch [600/704] training loss = 0.3935, training acc = 0.84
Valid Test with nat
Test accuracy: 85.98% (4299/5000), Test loss:0.4280
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance70_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 85.87% (8587/10000), Test loss:0.4228
Epoch [25/70], Passed time:[249.444/6236.094]
learning rate: 0.1
Batch [0/704] training loss = 0.3219, training acc = 0.89
Batch [200/704] training loss = 0.3608, training acc = 0.89
Batch [400/704] training loss = 0.4461, training acc = 0.86
Batch [600/704] training loss = 0.3714, training acc = 0.88
Valid Test with nat
Test accuracy: 85.28% (4264/5000), Test loss:0.4440
Epoch [26/70], Passed time:[249.970/6499.212]
learning rate: 0.1
Batch [0/704] training loss = 0.2582, training acc = 0.92
Batch [200/704] training loss = 0.2775, training acc = 0.89
Batch [400/704] training loss = 0.4242, training acc = 0.88
Batch [600/704] training loss = 0.3869, training acc = 0.88
Valid Test with nat
Test accuracy: 85.64% (4282/5000), Test loss:0.4570
Epoch [27/70], Passed time:[250.291/6757.856]
learning rate: 0.1
Batch [0/704] training loss = 0.3898, training acc = 0.86
Batch [200/704] training loss = 0.3064, training acc = 0.86
Batch [400/704] training loss = 0.3789, training acc = 0.91
Batch [600/704] training loss = 0.4540, training acc = 0.88
Valid Test with nat
Test accuracy: 85.12% (4256/5000), Test loss:0.4533
Epoch [28/70], Passed time:[250.516/7014.442]
learning rate: 0.1
Batch [0/704] training loss = 0.4312, training acc = 0.89
Batch [200/704] training loss = 0.3933, training acc = 0.91
Batch [400/704] training loss = 0.3185, training acc = 0.91
Batch [600/704] training loss = 0.4085, training acc = 0.89
Valid Test with nat
Test accuracy: 86.58% (4329/5000), Test loss:0.4276
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance70_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 85.85% (8585/10000), Test loss:0.4268
Epoch [29/70], Passed time:[250.624/7268.088]
learning rate: 0.1
Batch [0/704] training loss = 0.2831, training acc = 0.92
Batch [200/704] training loss = 0.4050, training acc = 0.84
Batch [400/704] training loss = 0.3937, training acc = 0.91
Batch [600/704] training loss = 0.4204, training acc = 0.88
Valid Test with nat
Test accuracy: 84.54% (4227/5000), Test loss:0.5013
Epoch [30/70], Passed time:[249.858/7495.741]
learning rate: 0.1
Batch [0/704] training loss = 0.4248, training acc = 0.86
Batch [200/704] training loss = 0.2963, training acc = 0.88
Batch [400/704] training loss = 0.4718, training acc = 0.86
Batch [600/704] training loss = 0.4631, training acc = 0.86
Valid Test with nat
Test accuracy: 85.90% (4295/5000), Test loss:0.4400
Epoch [31/70], Passed time:[248.905/7716.045]
learning rate: 0.1
Batch [0/704] training loss = 0.4515, training acc = 0.81
Batch [200/704] training loss = 0.6262, training acc = 0.81
Batch [400/704] training loss = 0.3138, training acc = 0.91
Batch [600/704] training loss = 0.4056, training acc = 0.86
Valid Test with nat
Test accuracy: 82.48% (4124/5000), Test loss:0.5592
Epoch [32/70], Passed time:[248.396/7948.671]
learning rate: 0.1
Batch [0/704] training loss = 0.4561, training acc = 0.86
Batch [200/704] training loss = 0.2563, training acc = 0.92
Batch [400/704] training loss = 0.5860, training acc = 0.81
Batch [600/704] training loss = 0.3213, training acc = 0.89
Valid Test with nat
Test accuracy: 83.06% (4153/5000), Test loss:0.5140
Epoch [33/70], Passed time:[247.209/8157.906]
learning rate: 0.1
Batch [0/704] training loss = 0.5465, training acc = 0.80
Batch [200/704] training loss = 0.3536, training acc = 0.88
Batch [400/704] training loss = 0.4397, training acc = 0.88
Batch [600/704] training loss = 0.3883, training acc = 0.83
Valid Test with nat
Test accuracy: 77.74% (3887/5000), Test loss:0.7295
Epoch [34/70], Passed time:[245.977/8363.222]
learning rate: 0.1
Batch [0/704] training loss = 0.5327, training acc = 0.86
Batch [200/704] training loss = 0.3711, training acc = 0.91
Batch [400/704] training loss = 0.3583, training acc = 0.88
Batch [600/704] training loss = 0.3421, training acc = 0.86
Valid Test with nat
Test accuracy: 83.76% (4188/5000), Test loss:0.4980
Epoch [35/70], Passed time:[244.979/8574.277]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.4727, training acc = 0.80
Batch [200/704] training loss = 0.2208, training acc = 0.91
Batch [400/704] training loss = 0.2525, training acc = 0.89
Batch [600/704] training loss = 0.0929, training acc = 0.98
Valid Test with nat
Test accuracy: 90.30% (4515/5000), Test loss:0.3068
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance70_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 89.66% (8966/10000), Test loss:0.3101
Epoch [36/70], Passed time:[244.055/8785.968]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.2108, training acc = 0.92
Batch [200/704] training loss = 0.2154, training acc = 0.91
Batch [400/704] training loss = 0.2987, training acc = 0.91
Batch [600/704] training loss = 0.1695, training acc = 0.94
Valid Test with nat
Test accuracy: 90.66% (4533/5000), Test loss:0.2944
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance70_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 90.13% (9013/10000), Test loss:0.2945
Epoch [37/70], Passed time:[243.124/8995.599]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.2026, training acc = 0.91
Batch [200/704] training loss = 0.2752, training acc = 0.92
Batch [400/704] training loss = 0.2620, training acc = 0.88
Batch [600/704] training loss = 0.3151, training acc = 0.91
Valid Test with nat
Test accuracy: 90.94% (4547/5000), Test loss:0.3001
Epoch [38/70], Passed time:[242.407/9211.468]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.1459, training acc = 0.95
Batch [200/704] training loss = 0.2308, training acc = 0.94
Batch [400/704] training loss = 0.1144, training acc = 0.94
Batch [600/704] training loss = 0.1339, training acc = 0.94
Valid Test with nat
Test accuracy: 91.20% (4560/5000), Test loss:0.2962
Epoch [39/70], Passed time:[241.699/9426.275]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.2008, training acc = 0.94
Batch [200/704] training loss = 0.2138, training acc = 0.94
Batch [400/704] training loss = 0.1450, training acc = 0.97
Batch [600/704] training loss = 0.1568, training acc = 0.94
Valid Test with nat
Test accuracy: 90.78% (4539/5000), Test loss:0.2869
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance70_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 90.56% (9056/10000), Test loss:0.2873
Epoch [40/70], Passed time:[241.169/9646.758]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.0818, training acc = 0.97
Batch [200/704] training loss = 0.1399, training acc = 0.97
Batch [400/704] training loss = 0.1774, training acc = 0.91
Batch [600/704] training loss = 0.2563, training acc = 0.91
Valid Test with nat
Test accuracy: 91.66% (4583/5000), Test loss:0.2883
Epoch [41/70], Passed time:[240.577/9863.642]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.2843, training acc = 0.91
Batch [200/704] training loss = 0.0767, training acc = 0.98
Batch [400/704] training loss = 0.2034, training acc = 0.94
Batch [600/704] training loss = 0.1317, training acc = 0.94
Valid Test with nat
Test accuracy: 91.44% (4572/5000), Test loss:0.2921
Epoch [42/70], Passed time:[239.810/10072.030]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.0851, training acc = 0.98
Batch [200/704] training loss = 0.0655, training acc = 0.97
Batch [400/704] training loss = 0.0985, training acc = 0.97
Batch [600/704] training loss = 0.1507, training acc = 0.97
Valid Test with nat
Test accuracy: 91.48% (4574/5000), Test loss:0.2867
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance70_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 90.66% (9066/10000), Test loss:0.2926
Epoch [43/70], Passed time:[239.277/10288.918]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.0781, training acc = 0.98
Batch [200/704] training loss = 0.1043, training acc = 0.97
Batch [400/704] training loss = 0.2262, training acc = 0.91
Batch [600/704] training loss = 0.0943, training acc = 0.97
Valid Test with nat
Test accuracy: 90.92% (4546/5000), Test loss:0.2989
Epoch [44/70], Passed time:[238.514/10494.625]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.1805, training acc = 0.92
Batch [200/704] training loss = 0.1054, training acc = 0.95
Batch [400/704] training loss = 0.1670, training acc = 0.95
Batch [600/704] training loss = 0.1006, training acc = 0.97
Valid Test with nat
Test accuracy: 91.26% (4563/5000), Test loss:0.2861
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance70_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 90.48% (9048/10000), Test loss:0.2982
Epoch [45/70], Passed time:[238.104/10714.700]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.0848, training acc = 0.97
Batch [200/704] training loss = 0.1500, training acc = 0.95
Batch [400/704] training loss = 0.1333, training acc = 0.95
Batch [600/704] training loss = 0.1821, training acc = 0.94
Valid Test with nat
Test accuracy: 91.66% (4583/5000), Test loss:0.2861
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance70_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 90.83% (9083/10000), Test loss:0.2957
Epoch [46/70], Passed time:[237.612/10930.159]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.0659, training acc = 1.00
Batch [200/704] training loss = 0.1157, training acc = 0.95
Batch [400/704] training loss = 0.3189, training acc = 0.91
Batch [600/704] training loss = 0.1161, training acc = 0.94
Valid Test with nat
Test accuracy: 91.44% (4572/5000), Test loss:0.2853
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance70_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 90.87% (9087/10000), Test loss:0.2968
Epoch [47/70], Passed time:[237.143/11145.725]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.1837, training acc = 0.95
Batch [200/704] training loss = 0.0630, training acc = 0.97
Batch [400/704] training loss = 0.1396, training acc = 0.95
Batch [600/704] training loss = 0.2444, training acc = 0.92
Valid Test with nat
Test accuracy: 91.44% (4572/5000), Test loss:0.3201
Epoch [48/70], Passed time:[236.670/11360.168]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.1734, training acc = 0.97
Batch [200/704] training loss = 0.0701, training acc = 0.97
Batch [400/704] training loss = 0.0414, training acc = 1.00
Batch [600/704] training loss = 0.1453, training acc = 0.94
Valid Test with nat
Test accuracy: 91.46% (4573/5000), Test loss:0.2879
Epoch [49/70], Passed time:[236.077/11567.758]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.0534, training acc = 1.00
Batch [200/704] training loss = 0.1381, training acc = 0.95
Batch [400/704] training loss = 0.1027, training acc = 0.94
Batch [600/704] training loss = 0.1449, training acc = 0.95
Valid Test with nat
Test accuracy: 91.48% (4574/5000), Test loss:0.2975
Epoch [50/70], Passed time:[235.438/11771.890]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.1630, training acc = 0.94
Batch [200/704] training loss = 0.1430, training acc = 0.94
Batch [400/704] training loss = 0.3195, training acc = 0.91
Batch [600/704] training loss = 0.0964, training acc = 0.94
Valid Test with nat
Test accuracy: 91.20% (4560/5000), Test loss:0.2944
Epoch [51/70], Passed time:[234.882/11978.983]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.1220, training acc = 0.95
Batch [200/704] training loss = 0.1158, training acc = 0.97
Batch [400/704] training loss = 0.0802, training acc = 0.98
Batch [600/704] training loss = 0.1301, training acc = 0.95
Valid Test with nat
Test accuracy: 90.92% (4546/5000), Test loss:0.3061
Epoch [52/70], Passed time:[234.213/12179.071]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.2290, training acc = 0.91
Batch [200/704] training loss = 0.0734, training acc = 0.97
Batch [400/704] training loss = 0.0824, training acc = 0.97
Batch [600/704] training loss = 0.1566, training acc = 0.94
Valid Test with nat
Test accuracy: 91.26% (4563/5000), Test loss:0.3167
Epoch [53/70], Passed time:[233.294/12364.556]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.1757, training acc = 0.95
Batch [200/704] training loss = 0.0710, training acc = 0.98
Batch [400/704] training loss = 0.2343, training acc = 0.94
Batch [600/704] training loss = 0.0621, training acc = 0.98
Valid Test with nat
Test accuracy: 91.64% (4582/5000), Test loss:0.2967
Epoch [54/70], Passed time:[232.256/12541.840]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0556, training acc = 0.98
Batch [200/704] training loss = 0.1119, training acc = 0.95
Batch [400/704] training loss = 0.1047, training acc = 0.97
Batch [600/704] training loss = 0.0971, training acc = 0.97
Valid Test with nat
Test accuracy: 91.64% (4582/5000), Test loss:0.2973
Epoch [55/70], Passed time:[231.194/12715.657]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0826, training acc = 0.98
Batch [200/704] training loss = 0.2588, training acc = 0.95
Batch [400/704] training loss = 0.1666, training acc = 0.94
Batch [600/704] training loss = 0.0281, training acc = 0.98
Valid Test with nat
Test accuracy: 91.74% (4587/5000), Test loss:0.2927
Epoch [56/70], Passed time:[230.131/12887.312]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0668, training acc = 0.97
Batch [200/704] training loss = 0.1202, training acc = 0.95
Batch [400/704] training loss = 0.0926, training acc = 0.97
Batch [600/704] training loss = 0.0465, training acc = 0.98
Valid Test with nat
Test accuracy: 91.66% (4583/5000), Test loss:0.2929
Epoch [57/70], Passed time:[229.008/13053.472]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0362, training acc = 1.00
Batch [200/704] training loss = 0.0829, training acc = 0.95
Batch [400/704] training loss = 0.1084, training acc = 0.94
Batch [600/704] training loss = 0.0535, training acc = 1.00
Valid Test with nat
Test accuracy: 91.74% (4587/5000), Test loss:0.3006
Epoch [58/70], Passed time:[227.914/13219.012]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0508, training acc = 0.97
Batch [200/704] training loss = 0.1215, training acc = 0.95
Batch [400/704] training loss = 0.0244, training acc = 1.00
Batch [600/704] training loss = 0.0951, training acc = 0.97
Valid Test with nat
Test accuracy: 91.64% (4582/5000), Test loss:0.2971
Epoch [59/70], Passed time:[226.898/13386.981]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0713, training acc = 0.97
Batch [200/704] training loss = 0.0490, training acc = 1.00
Batch [400/704] training loss = 0.1172, training acc = 0.97
Batch [600/704] training loss = 0.0349, training acc = 1.00
Valid Test with nat
Test accuracy: 91.62% (4581/5000), Test loss:0.3030
Epoch [60/70], Passed time:[225.942/13556.535]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.1403, training acc = 0.97
Batch [200/704] training loss = 0.0316, training acc = 0.98
Batch [400/704] training loss = 0.1364, training acc = 0.95
Batch [600/704] training loss = 0.1161, training acc = 0.94
Valid Test with nat
Test accuracy: 91.80% (4590/5000), Test loss:0.2956
Epoch [61/70], Passed time:[225.021/13726.263]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0632, training acc = 0.97
Batch [200/704] training loss = 0.1028, training acc = 0.95
Batch [400/704] training loss = 0.0606, training acc = 0.97
Batch [600/704] training loss = 0.0802, training acc = 0.97
Valid Test with nat
Test accuracy: 91.80% (4590/5000), Test loss:0.2960
Epoch [62/70], Passed time:[224.061/13891.804]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.1227, training acc = 0.97
Batch [200/704] training loss = 0.2022, training acc = 0.94
Batch [400/704] training loss = 0.0344, training acc = 1.00
Batch [600/704] training loss = 0.1250, training acc = 0.95
Valid Test with nat
Test accuracy: 91.72% (4586/5000), Test loss:0.2978
Epoch [63/70], Passed time:[223.325/14069.457]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0387, training acc = 0.98
Batch [200/704] training loss = 0.0455, training acc = 0.97
Batch [400/704] training loss = 0.0477, training acc = 0.98
Batch [600/704] training loss = 0.1195, training acc = 0.95
Valid Test with nat
Test accuracy: 91.58% (4579/5000), Test loss:0.3088
Epoch [64/70], Passed time:[222.476/14238.480]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0611, training acc = 0.97
Batch [200/704] training loss = 0.0925, training acc = 0.97
Batch [400/704] training loss = 0.0726, training acc = 0.98
Batch [600/704] training loss = 0.0558, training acc = 1.00
Valid Test with nat
Test accuracy: 91.62% (4581/5000), Test loss:0.3064
Epoch [65/70], Passed time:[221.568/14401.948]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.1219, training acc = 0.95
Batch [200/704] training loss = 0.0951, training acc = 0.95
Batch [400/704] training loss = 0.0992, training acc = 0.97
Batch [600/704] training loss = 0.0795, training acc = 0.97
Valid Test with nat
Test accuracy: 91.70% (4585/5000), Test loss:0.2992
Epoch [66/70], Passed time:[220.769/14570.770]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0452, training acc = 1.00
Batch [200/704] training loss = 0.0758, training acc = 0.94
Batch [400/704] training loss = 0.0662, training acc = 0.98
Batch [600/704] training loss = 0.1075, training acc = 0.95
Valid Test with nat
Test accuracy: 91.76% (4588/5000), Test loss:0.2995
Epoch [67/70], Passed time:[219.948/14736.498]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.1081, training acc = 0.94
Batch [200/704] training loss = 0.1015, training acc = 0.97
Batch [400/704] training loss = 0.1199, training acc = 0.92
Batch [600/704] training loss = 0.0789, training acc = 0.97
Valid Test with nat
Test accuracy: 91.38% (4569/5000), Test loss:0.3107
Epoch [68/70], Passed time:[219.143/14901.743]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.1386, training acc = 0.97
Batch [200/704] training loss = 0.0925, training acc = 0.98
Batch [400/704] training loss = 0.1370, training acc = 0.95
Batch [600/704] training loss = 0.1290, training acc = 0.98
Valid Test with nat
Test accuracy: 91.68% (4584/5000), Test loss:0.3193
Epoch [69/70], Passed time:[218.397/15069.388]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.1515, training acc = 0.95
Batch [200/704] training loss = 0.0418, training acc = 0.98
Batch [400/704] training loss = 0.0448, training acc = 0.98
Batch [600/704] training loss = 0.0364, training acc = 1.00
Valid Test with nat
Test accuracy: 91.88% (4594/5000), Test loss:0.2986
Training done, model saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance70_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 91.31% (9131/10000), Test loss:0.3009
