model_type : vgg16
init_type : pure
finetune_method : nat
enhance_method : nat
gpu : 6
model_name : init_enhance20_m0.1_warmup0.1
model_width : 8
n_pruning_steps : 1
max_pruning_ratio : 80
train_epochs : 20
enhance_epochs : 20
prune_method : unstructured
dataset : cifar
noise_sd : 1.0
trades_beta : 6.0
seed : 7
warmup : True
parallel : False
create_init : False
init_step : 1400
train_method : nat
early_stop : 100
norm : True
optm : sgd
batch_size : 64
test_batch_size : 100
learning_rate : 0.1
enhance_learning_rate : 0.1
schedule_length : 10
weight_decay : 0.0001
epsilon : 0.03137254901960784
attack_iter : 10
eps_step : 0.00784313725490196
targeted : False
clip_min : 0
clip_max : 1.0
starting_epsilon : 1e-05
interval_weight : 0.1
ft_interval_weight : 50
verbose : 200
resume : 0
model_path : ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.1_warmup0.1.pth
last_model_path : ./trained_models_new/
mask_path : ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/pruned_lr0.1_mask_r80.npy
mask_name : pruned_lr0.1_mask_r80
log_path : ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.1_warmup0.1.log
init_path : ./trained_models_new/cifar/vgg16/init/pure_vgg16_init.pth
results_path : None
n_classes : 10
eval : False
init : True
transfer : False
CUDA enabled.
Enhance training config:
Enhance training method: nat
model will be saved in: ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.1_warmup0.1.pth
Init model is: ./trained_models_new/cifar/vgg16/init/pure_vgg16_init.pth
Init mask used from: ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/pruned_lr0.1_mask_r80.npy
Log will be saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.1_warmup0.1.log
Random seed is: 7

model loading from ./trained_models_new/cifar/vgg16/init/pure_vgg16_init.pth
Epoch [0/20]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 2.2978, training acc = 0.09
Batch [200/704] training loss = 1.6698, training acc = 0.41
Batch [400/704] training loss = 1.5555, training acc = 0.42
Batch [600/704] training loss = 1.0003, training acc = 0.67
Valid Test with nat
Test accuracy: 56.26% (2813/5000), Test loss:1.2180
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 56.11% (5611/10000), Test loss:1.2367
Epoch [1/20], Passed time:[45.539/45.539]
learning rate: 0.020000000000000004
Batch [0/704] training loss = 1.1749, training acc = 0.55
Batch [200/704] training loss = 1.3442, training acc = 0.52
Batch [400/704] training loss = 0.9667, training acc = 0.67
Batch [600/704] training loss = 1.1859, training acc = 0.62
Valid Test with nat
Test accuracy: 60.02% (3001/5000), Test loss:1.1782
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 57.74% (5774/10000), Test loss:1.2391
Epoch [2/20], Passed time:[45.658/91.315]
learning rate: 0.030000000000000006
Batch [0/704] training loss = 0.9293, training acc = 0.66
Batch [200/704] training loss = 0.8562, training acc = 0.70
Batch [400/704] training loss = 0.8714, training acc = 0.72
Batch [600/704] training loss = 0.8604, training acc = 0.73
Valid Test with nat
Test accuracy: 71.54% (3577/5000), Test loss:0.8299
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 72.44% (7244/10000), Test loss:0.8052
Epoch [3/20], Passed time:[49.752/149.256]
learning rate: 0.04000000000000001
Batch [0/704] training loss = 0.8365, training acc = 0.69
Batch [200/704] training loss = 0.9259, training acc = 0.69
Batch [400/704] training loss = 0.8080, training acc = 0.67
Batch [600/704] training loss = 0.9359, training acc = 0.72
Valid Test with nat
Test accuracy: 69.82% (3491/5000), Test loss:0.9701
Epoch [4/20], Passed time:[50.773/203.092]
learning rate: 0.05
Batch [0/704] training loss = 0.7499, training acc = 0.73
Batch [200/704] training loss = 0.8600, training acc = 0.73
Batch [400/704] training loss = 0.8930, training acc = 0.69
Batch [600/704] training loss = 0.7730, training acc = 0.75
Valid Test with nat
Test accuracy: 75.34% (3767/5000), Test loss:0.7156
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 74.99% (7499/10000), Test loss:0.7482
Epoch [5/20], Passed time:[54.798/273.992]
learning rate: 0.06000000000000001
Batch [0/704] training loss = 0.8335, training acc = 0.72
Batch [200/704] training loss = 0.5031, training acc = 0.83
Batch [400/704] training loss = 0.8083, training acc = 0.70
Batch [600/704] training loss = 0.6013, training acc = 0.78
Valid Test with nat
Test accuracy: 72.10% (3605/5000), Test loss:0.8415
Epoch [6/20], Passed time:[57.894/347.366]
learning rate: 0.07
Batch [0/704] training loss = 0.8324, training acc = 0.75
Batch [200/704] training loss = 0.7135, training acc = 0.75
Batch [400/704] training loss = 0.6377, training acc = 0.78
Batch [600/704] training loss = 0.9163, training acc = 0.70
Valid Test with nat
Test accuracy: 73.58% (3679/5000), Test loss:0.7788
Epoch [7/20], Passed time:[60.692/424.845]
learning rate: 0.08000000000000002
Batch [0/704] training loss = 0.5740, training acc = 0.77
Batch [200/704] training loss = 0.6640, training acc = 0.73
Batch [400/704] training loss = 0.7850, training acc = 0.72
Batch [600/704] training loss = 0.6655, training acc = 0.77
Valid Test with nat
Test accuracy: 77.02% (3851/5000), Test loss:0.6754
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 76.76% (7676/10000), Test loss:0.6958
Epoch [8/20], Passed time:[64.448/515.587]
learning rate: 0.09000000000000001
Batch [0/704] training loss = 0.7818, training acc = 0.73
Batch [200/704] training loss = 0.6399, training acc = 0.81
Batch [400/704] training loss = 0.7031, training acc = 0.73
Batch [600/704] training loss = 0.5722, training acc = 0.84
Valid Test with nat
Test accuracy: 75.12% (3756/5000), Test loss:0.7296
Epoch [9/20], Passed time:[67.635/608.719]
learning rate: 0.1
Batch [0/704] training loss = 0.4151, training acc = 0.84
Batch [200/704] training loss = 0.6375, training acc = 0.75
Batch [400/704] training loss = 0.7044, training acc = 0.78
Batch [600/704] training loss = 0.4182, training acc = 0.89
Valid Test with nat
Test accuracy: 75.38% (3769/5000), Test loss:0.7350
Epoch [10/20], Passed time:[70.251/702.514]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.5341, training acc = 0.80
Batch [200/704] training loss = 0.4611, training acc = 0.81
Batch [400/704] training loss = 0.3072, training acc = 0.89
Batch [600/704] training loss = 0.4174, training acc = 0.83
Valid Test with nat
Test accuracy: 86.52% (4326/5000), Test loss:0.4043
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 86.13% (8613/10000), Test loss:0.4116
Epoch [11/20], Passed time:[72.642/799.058]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.3804, training acc = 0.89
Batch [200/704] training loss = 0.3892, training acc = 0.88
Batch [400/704] training loss = 0.3611, training acc = 0.88
Batch [600/704] training loss = 0.3458, training acc = 0.86
Valid Test with nat
Test accuracy: 86.64% (4332/5000), Test loss:0.3920
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 86.77% (8677/10000), Test loss:0.3881
Epoch [12/20], Passed time:[74.442/893.300]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.4330, training acc = 0.83
Batch [200/704] training loss = 0.4529, training acc = 0.84
Batch [400/704] training loss = 0.3318, training acc = 0.88
Batch [600/704] training loss = 0.4692, training acc = 0.84
Valid Test with nat
Test accuracy: 87.26% (4363/5000), Test loss:0.3888
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 86.82% (8682/10000), Test loss:0.3894
Epoch [13/20], Passed time:[75.572/982.430]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.2911, training acc = 0.89
Batch [200/704] training loss = 0.2539, training acc = 0.91
Batch [400/704] training loss = 0.2856, training acc = 0.89
Batch [600/704] training loss = 0.2399, training acc = 0.94
Valid Test with nat
Test accuracy: 87.34% (4367/5000), Test loss:0.3775
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 87.49% (8749/10000), Test loss:0.3725
Epoch [14/20], Passed time:[76.738/1074.328]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.2454, training acc = 0.91
Batch [200/704] training loss = 0.5729, training acc = 0.80
Batch [400/704] training loss = 0.2765, training acc = 0.89
Batch [600/704] training loss = 0.1887, training acc = 0.97
Valid Test with nat
Test accuracy: 88.16% (4408/5000), Test loss:0.3628
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 87.68% (8768/10000), Test loss:0.3717
Epoch [15/20], Passed time:[77.608/1164.118]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.3499, training acc = 0.88
Batch [200/704] training loss = 0.3814, training acc = 0.84
Batch [400/704] training loss = 0.2427, training acc = 0.92
Batch [600/704] training loss = 0.2262, training acc = 0.89
Valid Test with nat
Test accuracy: 88.18% (4409/5000), Test loss:0.3506
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 87.68% (8768/10000), Test loss:0.3638
Epoch [16/20], Passed time:[79.001/1264.012]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.3813, training acc = 0.84
Batch [200/704] training loss = 0.3105, training acc = 0.89
Batch [400/704] training loss = 0.1768, training acc = 0.97
Batch [600/704] training loss = 0.2982, training acc = 0.88
Valid Test with nat
Test accuracy: 88.50% (4425/5000), Test loss:0.3470
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 88.01% (8801/10000), Test loss:0.3616
Epoch [17/20], Passed time:[79.510/1351.663]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.3548, training acc = 0.86
Batch [200/704] training loss = 0.4221, training acc = 0.84
Batch [400/704] training loss = 0.2315, training acc = 0.92
Batch [600/704] training loss = 0.4028, training acc = 0.88
Valid Test with nat
Test accuracy: 88.50% (4425/5000), Test loss:0.3442
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 88.13% (8813/10000), Test loss:0.3541
Epoch [18/20], Passed time:[79.926/1438.663]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.3855, training acc = 0.86
Batch [200/704] training loss = 0.3689, training acc = 0.89
Batch [400/704] training loss = 0.1932, training acc = 0.91
Batch [600/704] training loss = 0.2452, training acc = 0.92
Valid Test with nat
Test accuracy: 88.68% (4434/5000), Test loss:0.3480
Epoch [19/20], Passed time:[79.925/1518.576]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.3467, training acc = 0.86
Batch [200/704] training loss = 0.2677, training acc = 0.88
Batch [400/704] training loss = 0.2507, training acc = 0.91
Batch [600/704] training loss = 0.1952, training acc = 0.94
Valid Test with nat
Test accuracy: 88.46% (4423/5000), Test loss:0.3417
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 88.10% (8810/10000), Test loss:0.3585
Training done, model saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 88.10% (8810/10000), Test loss:0.3585
