clip_min : 0
parallel : False
last_model_path : ./trained_models_new/
init_path : ./trained_models_new/cifar/vgg16/init/pure_vgg16_init.pth
attack_iter : 10
n_pruning_steps : 1
noise_sd : 1.0
weight_decay : 0.0001
transfer : False
dataset : cifar
early_stop : 100
gpu : 0
mask_path : ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/pruned_lr0.1_mask_r80.npy
train_method : nat
learning_rate : 0.1
norm : True
seed : 7
train_epochs : 90
verbose : 200
init_type : pure
model_path : ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance90_m0.1_warmup0.1.pth
eps_step : 0.00784313725490196
model_name : init_enhance90_m0.1_warmup0.1
ft_interval_weight : 50
schedule_length : 10
enhance_method : nat
results_path : None
prune_method : unstructured
test_batch_size : 100
resume : 0
trades_beta : 6.0
init : True
epsilon : 0.03137254901960784
batch_size : 64
n_classes : 10
mask_name : pruned_lr0.1_mask_r80
create_init : False
init_step : 1400
model_width : 8
log_path : ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance90_m0.1_warmup0.1.log
starting_epsilon : 1e-05
eval : False
model_type : vgg16
warmup : True
optm : sgd
finetune_method : nat
enhance_epochs : 90
interval_weight : 0.1
max_pruning_ratio : 80
enhance_learning_rate : 0.1
clip_max : 1.0
targeted : False
CUDA enabled.
Enhance training config:
Enhance training method: nat
model will be saved in: ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance90_m0.1_warmup0.1.pth
Init model is: ./trained_models_new/cifar/vgg16/init/pure_vgg16_init.pth
Init mask used from: ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/pruned_lr0.1_mask_r80.npy
Log will be saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance90_m0.1_warmup0.1.log
Random seed is: 7

model loading from ./trained_models_new/cifar/vgg16/init/pure_vgg16_init.pth
Epoch [0/90]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 2.2978, training acc = 0.09
Batch [200/704] training loss = 1.6484, training acc = 0.34
Batch [400/704] training loss = 1.4623, training acc = 0.53
Batch [600/704] training loss = 1.0043, training acc = 0.67
Valid Test with nat
Test accuracy: 55.72% (2786/5000), Test loss:1.2408
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance90_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 55.90% (5590/10000), Test loss:1.2291
Epoch [1/90], Passed time:[270.772/270.772]
learning rate: 0.020000000000000004
Batch [0/704] training loss = 1.1007, training acc = 0.59
Batch [200/704] training loss = 1.2294, training acc = 0.55
Batch [400/704] training loss = 0.9066, training acc = 0.72
Batch [600/704] training loss = 1.1257, training acc = 0.67
Valid Test with nat
Test accuracy: 63.08% (3154/5000), Test loss:1.1440
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance90_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 63.04% (6304/10000), Test loss:1.1348
Epoch [2/90], Passed time:[269.505/539.010]
learning rate: 0.030000000000000006
Batch [0/704] training loss = 0.8867, training acc = 0.62
Batch [200/704] training loss = 0.9487, training acc = 0.67
Batch [400/704] training loss = 0.8881, training acc = 0.73
Batch [600/704] training loss = 0.8527, training acc = 0.72
Valid Test with nat
Test accuracy: 72.50% (3625/5000), Test loss:0.8140
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance90_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 71.57% (7157/10000), Test loss:0.8313
Epoch [3/90], Passed time:[267.605/802.815]
learning rate: 0.04000000000000001
Batch [0/704] training loss = 0.8843, training acc = 0.66
Batch [200/704] training loss = 0.8547, training acc = 0.70
Batch [400/704] training loss = 0.7984, training acc = 0.72
Batch [600/704] training loss = 0.8842, training acc = 0.69
Valid Test with nat
Test accuracy: 70.58% (3529/5000), Test loss:0.9577
Epoch [4/90], Passed time:[263.786/1055.146]
learning rate: 0.05
Batch [0/704] training loss = 0.6439, training acc = 0.83
Batch [200/704] training loss = 0.8201, training acc = 0.69
Batch [400/704] training loss = 0.9284, training acc = 0.64
Batch [600/704] training loss = 0.6786, training acc = 0.78
Valid Test with nat
Test accuracy: 76.96% (3848/5000), Test loss:0.6610
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance90_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 76.36% (7636/10000), Test loss:0.6897
Epoch [5/90], Passed time:[263.915/1319.576]
learning rate: 0.06000000000000001
Batch [0/704] training loss = 0.8057, training acc = 0.70
Batch [200/704] training loss = 0.5350, training acc = 0.80
Batch [400/704] training loss = 0.7132, training acc = 0.72
Batch [600/704] training loss = 0.7797, training acc = 0.77
Valid Test with nat
Test accuracy: 69.24% (3462/5000), Test loss:0.9595
Epoch [6/90], Passed time:[262.542/1575.252]
learning rate: 0.07
Batch [0/704] training loss = 0.8306, training acc = 0.72
Batch [200/704] training loss = 0.6262, training acc = 0.81
Batch [400/704] training loss = 0.5665, training acc = 0.80
Batch [600/704] training loss = 0.7080, training acc = 0.73
Valid Test with nat
Test accuracy: 76.86% (3843/5000), Test loss:0.7037
Epoch [7/90], Passed time:[261.654/1831.576]
learning rate: 0.08000000000000002
Batch [0/704] training loss = 0.5062, training acc = 0.83
Batch [200/704] training loss = 0.5373, training acc = 0.83
Batch [400/704] training loss = 0.9565, training acc = 0.70
Batch [600/704] training loss = 0.5513, training acc = 0.78
Valid Test with nat
Test accuracy: 76.62% (3831/5000), Test loss:0.6972
Epoch [8/90], Passed time:[260.611/2084.888]
learning rate: 0.09000000000000001
Batch [0/704] training loss = 0.6052, training acc = 0.84
Batch [200/704] training loss = 0.7815, training acc = 0.78
Batch [400/704] training loss = 0.6264, training acc = 0.77
Batch [600/704] training loss = 0.5291, training acc = 0.81
Valid Test with nat
Test accuracy: 78.40% (3920/5000), Test loss:0.6425
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance90_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 77.35% (7735/10000), Test loss:0.6880
Epoch [9/90], Passed time:[259.625/2336.622]
learning rate: 0.1
Batch [0/704] training loss = 0.4960, training acc = 0.83
Batch [200/704] training loss = 0.5332, training acc = 0.75
Batch [400/704] training loss = 0.5075, training acc = 0.80
Batch [600/704] training loss = 0.4382, training acc = 0.81
Valid Test with nat
Test accuracy: 77.50% (3875/5000), Test loss:0.6734
Epoch [10/90], Passed time:[257.952/2579.520]
learning rate: 0.1
Batch [0/704] training loss = 0.5219, training acc = 0.81
Batch [200/704] training loss = 0.5834, training acc = 0.83
Batch [400/704] training loss = 0.3040, training acc = 0.94
Batch [600/704] training loss = 0.5662, training acc = 0.83
Valid Test with nat
Test accuracy: 76.84% (3842/5000), Test loss:0.7345
Epoch [11/90], Passed time:[258.800/2846.796]
learning rate: 0.1
Batch [0/704] training loss = 0.7324, training acc = 0.69
Batch [200/704] training loss = 0.4158, training acc = 0.84
Batch [400/704] training loss = 0.4137, training acc = 0.88
Batch [600/704] training loss = 0.3588, training acc = 0.86
Valid Test with nat
Test accuracy: 78.82% (3941/5000), Test loss:0.6616
Epoch [12/90], Passed time:[260.192/3122.307]
learning rate: 0.1
Batch [0/704] training loss = 0.7419, training acc = 0.67
Batch [200/704] training loss = 0.5800, training acc = 0.83
Batch [400/704] training loss = 0.6604, training acc = 0.80
Batch [600/704] training loss = 0.5745, training acc = 0.83
Valid Test with nat
Test accuracy: 77.06% (3853/5000), Test loss:0.7411
Epoch [13/90], Passed time:[261.978/3405.714]
learning rate: 0.1
Batch [0/704] training loss = 0.5434, training acc = 0.78
Batch [200/704] training loss = 0.4596, training acc = 0.84
Batch [400/704] training loss = 0.5821, training acc = 0.81
Batch [600/704] training loss = 0.4255, training acc = 0.89
Valid Test with nat
Test accuracy: 82.42% (4121/5000), Test loss:0.5263
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance90_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 82.46% (8246/10000), Test loss:0.5373
Epoch [14/90], Passed time:[263.833/3693.656]
learning rate: 0.1
Batch [0/704] training loss = 0.3724, training acc = 0.86
Batch [200/704] training loss = 0.7039, training acc = 0.75
Batch [400/704] training loss = 0.6187, training acc = 0.78
Batch [600/704] training loss = 0.5559, training acc = 0.77
Valid Test with nat
Test accuracy: 82.32% (4116/5000), Test loss:0.5412
Epoch [15/90], Passed time:[265.654/3984.814]
learning rate: 0.1
Batch [0/704] training loss = 0.4527, training acc = 0.83
Batch [200/704] training loss = 0.3428, training acc = 0.89
Batch [400/704] training loss = 0.6006, training acc = 0.80
Batch [600/704] training loss = 0.3534, training acc = 0.88
Valid Test with nat
Test accuracy: 81.68% (4084/5000), Test loss:0.5547
Epoch [16/90], Passed time:[267.173/4274.773]
learning rate: 0.1
Batch [0/704] training loss = 0.2943, training acc = 0.88
Batch [200/704] training loss = 0.3429, training acc = 0.91
Batch [400/704] training loss = 0.8381, training acc = 0.75
Batch [600/704] training loss = 0.5796, training acc = 0.83
Valid Test with nat
Test accuracy: 84.24% (4212/5000), Test loss:0.4718
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance90_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 84.12% (8412/10000), Test loss:0.4859
Epoch [17/90], Passed time:[268.779/4569.236]
learning rate: 0.1
Batch [0/704] training loss = 0.4453, training acc = 0.88
Batch [200/704] training loss = 0.4134, training acc = 0.86
Batch [400/704] training loss = 0.3765, training acc = 0.91
Batch [600/704] training loss = 0.5724, training acc = 0.80
Valid Test with nat
Test accuracy: 81.36% (4068/5000), Test loss:0.5677
Epoch [18/90], Passed time:[269.831/4856.956]
learning rate: 0.1
Batch [0/704] training loss = 0.3256, training acc = 0.94
Batch [200/704] training loss = 0.4738, training acc = 0.84
Batch [400/704] training loss = 0.4594, training acc = 0.80
Batch [600/704] training loss = 0.3670, training acc = 0.89
Valid Test with nat
Test accuracy: 84.36% (4218/5000), Test loss:0.4950
Epoch [19/90], Passed time:[270.309/5135.878]
learning rate: 0.1
Batch [0/704] training loss = 0.3725, training acc = 0.88
Batch [200/704] training loss = 0.3295, training acc = 0.88
Batch [400/704] training loss = 0.3463, training acc = 0.91
Batch [600/704] training loss = 0.4888, training acc = 0.84
Valid Test with nat
Test accuracy: 81.48% (4074/5000), Test loss:0.5414
Epoch [20/90], Passed time:[271.130/5422.596]
learning rate: 0.1
Batch [0/704] training loss = 0.3791, training acc = 0.88
Batch [200/704] training loss = 0.7355, training acc = 0.80
Batch [400/704] training loss = 0.7259, training acc = 0.78
Batch [600/704] training loss = 0.4554, training acc = 0.88
Valid Test with nat
Test accuracy: 78.76% (3938/5000), Test loss:0.6714
Epoch [21/90], Passed time:[271.745/5706.637]
learning rate: 0.1
Batch [0/704] training loss = 0.4560, training acc = 0.88
Batch [200/704] training loss = 0.2829, training acc = 0.92
Batch [400/704] training loss = 0.3660, training acc = 0.88
Batch [600/704] training loss = 0.4559, training acc = 0.86
Valid Test with nat
Test accuracy: 82.32% (4116/5000), Test loss:0.5340
Epoch [22/90], Passed time:[272.260/5989.715]
learning rate: 0.1
Batch [0/704] training loss = 0.3355, training acc = 0.89
Batch [200/704] training loss = 0.4333, training acc = 0.89
Batch [400/704] training loss = 0.5455, training acc = 0.83
Batch [600/704] training loss = 0.4158, training acc = 0.88
Valid Test with nat
Test accuracy: 84.28% (4214/5000), Test loss:0.4731
Epoch [23/90], Passed time:[272.226/6261.196]
learning rate: 0.1
Batch [0/704] training loss = 0.2824, training acc = 0.92
Batch [200/704] training loss = 0.4042, training acc = 0.84
Batch [400/704] training loss = 0.4363, training acc = 0.86
Batch [600/704] training loss = 0.2984, training acc = 0.92
Valid Test with nat
Test accuracy: 83.20% (4160/5000), Test loss:0.5142
Epoch [24/90], Passed time:[271.785/6522.833]
learning rate: 0.1
Batch [0/704] training loss = 0.3168, training acc = 0.88
Batch [200/704] training loss = 0.2333, training acc = 0.94
Batch [400/704] training loss = 0.4323, training acc = 0.83
Batch [600/704] training loss = 0.3757, training acc = 0.88
Valid Test with nat
Test accuracy: 83.24% (4162/5000), Test loss:0.5512
Epoch [25/90], Passed time:[271.440/6785.997]
learning rate: 0.1
Batch [0/704] training loss = 0.2892, training acc = 0.86
Batch [200/704] training loss = 0.3562, training acc = 0.91
Batch [400/704] training loss = 0.5927, training acc = 0.80
Batch [600/704] training loss = 0.2307, training acc = 0.94
Valid Test with nat
Test accuracy: 84.82% (4241/5000), Test loss:0.4765
Epoch [26/90], Passed time:[270.422/7030.979]
learning rate: 0.1
Batch [0/704] training loss = 0.2969, training acc = 0.92
Batch [200/704] training loss = 0.5007, training acc = 0.83
Batch [400/704] training loss = 0.3249, training acc = 0.91
Batch [600/704] training loss = 0.4444, training acc = 0.83
Valid Test with nat
Test accuracy: 83.64% (4182/5000), Test loss:0.4934
Epoch [27/90], Passed time:[269.715/7282.306]
learning rate: 0.1
Batch [0/704] training loss = 0.6138, training acc = 0.81
Batch [200/704] training loss = 0.3067, training acc = 0.89
Batch [400/704] training loss = 0.4717, training acc = 0.83
Batch [600/704] training loss = 0.5587, training acc = 0.81
Valid Test with nat
Test accuracy: 81.16% (4058/5000), Test loss:0.5906
Epoch [28/90], Passed time:[269.241/7538.751]
learning rate: 0.1
Batch [0/704] training loss = 0.4303, training acc = 0.86
Batch [200/704] training loss = 0.4766, training acc = 0.89
Batch [400/704] training loss = 0.3719, training acc = 0.86
Batch [600/704] training loss = 0.1782, training acc = 0.95
Valid Test with nat
Test accuracy: 78.40% (3920/5000), Test loss:0.7407
Epoch [29/90], Passed time:[267.967/7771.043]
learning rate: 0.1
Batch [0/704] training loss = 0.4362, training acc = 0.86
Batch [200/704] training loss = 0.4824, training acc = 0.84
Batch [400/704] training loss = 0.3047, training acc = 0.89
Batch [600/704] training loss = 0.7353, training acc = 0.77
Valid Test with nat
Test accuracy: 83.90% (4195/5000), Test loss:0.4725
Epoch [30/90], Passed time:[266.093/7982.777]
learning rate: 0.1
Batch [0/704] training loss = 0.1934, training acc = 0.95
Batch [200/704] training loss = 0.3117, training acc = 0.95
Batch [400/704] training loss = 0.2504, training acc = 0.91
Batch [600/704] training loss = 0.5638, training acc = 0.81
Valid Test with nat
Test accuracy: 84.80% (4240/5000), Test loss:0.4504
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance90_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 84.36% (8436/10000), Test loss:0.4736
Epoch [31/90], Passed time:[265.145/8219.489]
learning rate: 0.1
Batch [0/704] training loss = 0.5523, training acc = 0.84
Batch [200/704] training loss = 0.3545, training acc = 0.89
Batch [400/704] training loss = 0.3447, training acc = 0.88
Batch [600/704] training loss = 0.5419, training acc = 0.80
Valid Test with nat
Test accuracy: 85.86% (4293/5000), Test loss:0.4367
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance90_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 86.02% (8602/10000), Test loss:0.4301
Epoch [32/90], Passed time:[263.931/8445.784]
learning rate: 0.1
Batch [0/704] training loss = 0.4447, training acc = 0.88
Batch [200/704] training loss = 0.3155, training acc = 0.91
Batch [400/704] training loss = 0.5799, training acc = 0.77
Batch [600/704] training loss = 0.4815, training acc = 0.83
Valid Test with nat
Test accuracy: 83.50% (4175/5000), Test loss:0.5200
Epoch [33/90], Passed time:[262.609/8666.108]
learning rate: 0.1
Batch [0/704] training loss = 0.3566, training acc = 0.89
Batch [200/704] training loss = 0.3932, training acc = 0.88
Batch [400/704] training loss = 0.3013, training acc = 0.91
Batch [600/704] training loss = 0.5060, training acc = 0.81
Valid Test with nat
Test accuracy: 85.80% (4290/5000), Test loss:0.4622
Epoch [34/90], Passed time:[260.992/8873.741]
learning rate: 0.1
Batch [0/704] training loss = 0.4060, training acc = 0.88
Batch [200/704] training loss = 0.5186, training acc = 0.84
Batch [400/704] training loss = 0.3797, training acc = 0.86
Batch [600/704] training loss = 0.3984, training acc = 0.84
Valid Test with nat
Test accuracy: 83.78% (4189/5000), Test loss:0.4924
Epoch [35/90], Passed time:[259.682/9088.859]
learning rate: 0.1
Batch [0/704] training loss = 0.5505, training acc = 0.80
Batch [200/704] training loss = 0.5953, training acc = 0.81
Batch [400/704] training loss = 0.2819, training acc = 0.88
Batch [600/704] training loss = 0.3876, training acc = 0.86
Valid Test with nat
Test accuracy: 81.32% (4066/5000), Test loss:0.5466
Epoch [36/90], Passed time:[258.447/9304.095]
learning rate: 0.1
Batch [0/704] training loss = 0.2375, training acc = 0.92
Batch [200/704] training loss = 0.4489, training acc = 0.89
Batch [400/704] training loss = 0.4142, training acc = 0.88
Batch [600/704] training loss = 0.3540, training acc = 0.92
Valid Test with nat
Test accuracy: 82.92% (4146/5000), Test loss:0.5376
Epoch [37/90], Passed time:[257.404/9523.964]
learning rate: 0.1
Batch [0/704] training loss = 0.6210, training acc = 0.84
Batch [200/704] training loss = 0.3359, training acc = 0.88
Batch [400/704] training loss = 0.3123, training acc = 0.88
Batch [600/704] training loss = 0.2749, training acc = 0.94
Valid Test with nat
Test accuracy: 85.12% (4256/5000), Test loss:0.4654
Epoch [38/90], Passed time:[256.098/9731.720]
learning rate: 0.1
Batch [0/704] training loss = 0.2588, training acc = 0.88
Batch [200/704] training loss = 0.3647, training acc = 0.88
Batch [400/704] training loss = 0.1888, training acc = 0.94
Batch [600/704] training loss = 0.2445, training acc = 0.94
Valid Test with nat
Test accuracy: 85.84% (4292/5000), Test loss:0.4574
Epoch [39/90], Passed time:[254.831/9938.405]
learning rate: 0.1
Batch [0/704] training loss = 0.4465, training acc = 0.80
Batch [200/704] training loss = 0.4103, training acc = 0.84
Batch [400/704] training loss = 0.3113, training acc = 0.91
Batch [600/704] training loss = 0.4671, training acc = 0.80
Valid Test with nat
Test accuracy: 84.28% (4214/5000), Test loss:0.4914
Epoch [40/90], Passed time:[253.699/10147.952]
learning rate: 0.1
Batch [0/704] training loss = 0.2230, training acc = 0.92
Batch [200/704] training loss = 0.2600, training acc = 0.91
Batch [400/704] training loss = 0.4649, training acc = 0.78
Batch [600/704] training loss = 0.2574, training acc = 0.92
Valid Test with nat
Test accuracy: 84.84% (4242/5000), Test loss:0.4808
Epoch [41/90], Passed time:[252.619/10357.391]
learning rate: 0.1
Batch [0/704] training loss = 0.2379, training acc = 0.92
Batch [200/704] training loss = 0.2795, training acc = 0.91
Batch [400/704] training loss = 0.2552, training acc = 0.91
Batch [600/704] training loss = 0.4274, training acc = 0.86
Valid Test with nat
Test accuracy: 84.78% (4239/5000), Test loss:0.4933
Epoch [42/90], Passed time:[251.548/10565.033]
learning rate: 0.1
Batch [0/704] training loss = 0.2361, training acc = 0.94
Batch [200/704] training loss = 0.1909, training acc = 0.92
Batch [400/704] training loss = 0.4920, training acc = 0.84
Batch [600/704] training loss = 0.4285, training acc = 0.86
Valid Test with nat
Test accuracy: 84.88% (4244/5000), Test loss:0.4843
Epoch [43/90], Passed time:[250.652/10778.046]
learning rate: 0.1
Batch [0/704] training loss = 0.4552, training acc = 0.84
Batch [200/704] training loss = 0.3245, training acc = 0.91
Batch [400/704] training loss = 0.1897, training acc = 0.95
Batch [600/704] training loss = 0.2616, training acc = 0.91
Valid Test with nat
Test accuracy: 85.20% (4260/5000), Test loss:0.4556
Epoch [44/90], Passed time:[249.899/10995.553]
learning rate: 0.1
Batch [0/704] training loss = 0.3144, training acc = 0.88
Batch [200/704] training loss = 0.2437, training acc = 0.92
Batch [400/704] training loss = 0.5713, training acc = 0.80
Batch [600/704] training loss = 0.5555, training acc = 0.77
Valid Test with nat
Test accuracy: 82.68% (4134/5000), Test loss:0.5411
Epoch [45/90], Passed time:[249.043/11206.915]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.1751, training acc = 0.95
Batch [200/704] training loss = 0.2710, training acc = 0.92
Batch [400/704] training loss = 0.1975, training acc = 0.94
Batch [600/704] training loss = 0.3681, training acc = 0.89
Valid Test with nat
Test accuracy: 90.74% (4537/5000), Test loss:0.3001
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance90_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 89.90% (8990/10000), Test loss:0.3129
Epoch [46/90], Passed time:[248.361/11424.592]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.2911, training acc = 0.91
Batch [200/704] training loss = 0.1650, training acc = 0.94
Batch [400/704] training loss = 0.3936, training acc = 0.89
Batch [600/704] training loss = 0.1979, training acc = 0.91
Valid Test with nat
Test accuracy: 91.06% (4553/5000), Test loss:0.2984
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance90_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 89.99% (8999/10000), Test loss:0.3105
Epoch [47/90], Passed time:[247.726/11643.120]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.2225, training acc = 0.92
Batch [200/704] training loss = 0.1665, training acc = 0.95
Batch [400/704] training loss = 0.2241, training acc = 0.92
Batch [600/704] training loss = 0.1900, training acc = 0.94
Valid Test with nat
Test accuracy: 90.92% (4546/5000), Test loss:0.3050
Epoch [48/90], Passed time:[247.004/11856.193]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.1925, training acc = 0.94
Batch [200/704] training loss = 0.3368, training acc = 0.88
Batch [400/704] training loss = 0.3019, training acc = 0.91
Batch [600/704] training loss = 0.2723, training acc = 0.92
Valid Test with nat
Test accuracy: 91.24% (4562/5000), Test loss:0.3013
Epoch [49/90], Passed time:[245.585/12033.653]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.1476, training acc = 0.97
Batch [200/704] training loss = 0.1752, training acc = 0.97
Batch [400/704] training loss = 0.2516, training acc = 0.92
Batch [600/704] training loss = 0.1268, training acc = 0.95
Valid Test with nat
Test accuracy: 90.80% (4540/5000), Test loss:0.2937
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance90_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 90.65% (9065/10000), Test loss:0.2959
Epoch [50/90], Passed time:[244.253/12212.629]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.1926, training acc = 0.95
Batch [200/704] training loss = 0.0978, training acc = 0.97
Batch [400/704] training loss = 0.0776, training acc = 0.97
Batch [600/704] training loss = 0.1001, training acc = 0.97
Valid Test with nat
Test accuracy: 90.88% (4544/5000), Test loss:0.2965
Epoch [51/90], Passed time:[242.884/12387.094]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.1046, training acc = 0.95
Batch [200/704] training loss = 0.2057, training acc = 0.94
Batch [400/704] training loss = 0.2043, training acc = 0.92
Batch [600/704] training loss = 0.1987, training acc = 0.91
Valid Test with nat
Test accuracy: 91.36% (4568/5000), Test loss:0.2845
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance90_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 91.17% (9117/10000), Test loss:0.2875
Epoch [52/90], Passed time:[241.493/12557.630]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.1764, training acc = 0.92
Batch [200/704] training loss = 0.1296, training acc = 0.95
Batch [400/704] training loss = 0.1053, training acc = 0.98
Batch [600/704] training loss = 0.0630, training acc = 0.97
Valid Test with nat
Test accuracy: 90.88% (4544/5000), Test loss:0.3014
Epoch [53/90], Passed time:[240.097/12725.130]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.1760, training acc = 0.92
Batch [200/704] training loss = 0.0850, training acc = 0.97
Batch [400/704] training loss = 0.1563, training acc = 0.95
Batch [600/704] training loss = 0.1151, training acc = 0.95
Valid Test with nat
Test accuracy: 90.94% (4547/5000), Test loss:0.2832
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance90_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 91.09% (9109/10000), Test loss:0.2879
Epoch [54/90], Passed time:[238.838/12897.278]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.0784, training acc = 0.95
Batch [200/704] training loss = 0.0754, training acc = 0.97
Batch [400/704] training loss = 0.1390, training acc = 0.94
Batch [600/704] training loss = 0.0611, training acc = 0.98
Valid Test with nat
Test accuracy: 91.38% (4569/5000), Test loss:0.2889
Epoch [55/90], Passed time:[237.586/13067.242]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.0853, training acc = 0.97
Batch [200/704] training loss = 0.0847, training acc = 0.97
Batch [400/704] training loss = 0.1920, training acc = 0.94
Batch [600/704] training loss = 0.0911, training acc = 0.97
Valid Test with nat
Test accuracy: 91.12% (4556/5000), Test loss:0.2911
Epoch [56/90], Passed time:[236.271/13231.160]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.2221, training acc = 0.94
Batch [200/704] training loss = 0.0836, training acc = 0.97
Batch [400/704] training loss = 0.1402, training acc = 0.95
Batch [600/704] training loss = 0.1476, training acc = 0.95
Valid Test with nat
Test accuracy: 90.92% (4546/5000), Test loss:0.2956
Epoch [57/90], Passed time:[234.963/13392.885]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.2572, training acc = 0.91
Batch [200/704] training loss = 0.1572, training acc = 0.95
Batch [400/704] training loss = 0.1384, training acc = 0.92
Batch [600/704] training loss = 0.1224, training acc = 0.97
Valid Test with nat
Test accuracy: 91.08% (4554/5000), Test loss:0.2982
Epoch [58/90], Passed time:[233.814/13561.233]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.0839, training acc = 0.95
Batch [200/704] training loss = 0.1477, training acc = 0.95
Batch [400/704] training loss = 0.1006, training acc = 0.94
Batch [600/704] training loss = 0.1902, training acc = 0.94
Valid Test with nat
Test accuracy: 91.62% (4581/5000), Test loss:0.2964
Epoch [59/90], Passed time:[232.702/13729.407]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.1143, training acc = 0.95
Batch [200/704] training loss = 0.0657, training acc = 0.97
Batch [400/704] training loss = 0.1429, training acc = 0.94
Batch [600/704] training loss = 0.0714, training acc = 0.97
Valid Test with nat
Test accuracy: 91.02% (4551/5000), Test loss:0.2989
Epoch [60/90], Passed time:[231.597/13895.840]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.0691, training acc = 0.98
Batch [200/704] training loss = 0.0855, training acc = 0.97
Batch [400/704] training loss = 0.0607, training acc = 0.97
Batch [600/704] training loss = 0.1363, training acc = 0.95
Valid Test with nat
Test accuracy: 91.14% (4557/5000), Test loss:0.3066
Epoch [61/90], Passed time:[230.519/14061.640]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.0393, training acc = 0.98
Batch [200/704] training loss = 0.1291, training acc = 0.97
Batch [400/704] training loss = 0.1521, training acc = 0.95
Batch [600/704] training loss = 0.1375, training acc = 0.95
Valid Test with nat
Test accuracy: 91.18% (4559/5000), Test loss:0.3044
Epoch [62/90], Passed time:[229.394/14222.417]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.1155, training acc = 0.97
Batch [200/704] training loss = 0.1228, training acc = 0.95
Batch [400/704] training loss = 0.1896, training acc = 0.92
Batch [600/704] training loss = 0.1226, training acc = 0.92
Valid Test with nat
Test accuracy: 91.18% (4559/5000), Test loss:0.2972
Epoch [63/90], Passed time:[228.385/14388.256]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.0487, training acc = 0.98
Batch [200/704] training loss = 0.1074, training acc = 0.95
Batch [400/704] training loss = 0.2123, training acc = 0.89
Batch [600/704] training loss = 0.1093, training acc = 0.95
Valid Test with nat
Test accuracy: 91.64% (4582/5000), Test loss:0.2998
Epoch [64/90], Passed time:[227.418/14554.778]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.0961, training acc = 0.92
Batch [200/704] training loss = 0.1255, training acc = 0.97
Batch [400/704] training loss = 0.0903, training acc = 0.95
Batch [600/704] training loss = 0.1967, training acc = 0.92
Valid Test with nat
Test accuracy: 91.52% (4576/5000), Test loss:0.3108
Epoch [65/90], Passed time:[226.511/14723.223]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.1204, training acc = 0.95
Batch [200/704] training loss = 0.0583, training acc = 0.98
Batch [400/704] training loss = 0.0482, training acc = 0.98
Batch [600/704] training loss = 0.1103, training acc = 0.95
Valid Test with nat
Test accuracy: 90.92% (4546/5000), Test loss:0.3097
Epoch [66/90], Passed time:[225.470/14880.991]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.1137, training acc = 0.97
Batch [200/704] training loss = 0.1702, training acc = 0.94
Batch [400/704] training loss = 0.1580, training acc = 0.95
Batch [600/704] training loss = 0.0427, training acc = 0.98
Valid Test with nat
Test accuracy: 91.32% (4566/5000), Test loss:0.3069
Epoch [67/90], Passed time:[224.081/15013.433]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.0174, training acc = 1.00
Batch [200/704] training loss = 0.0341, training acc = 1.00
Batch [400/704] training loss = 0.2347, training acc = 0.92
Batch [600/704] training loss = 0.0903, training acc = 0.97
Valid Test with nat
Test accuracy: 90.82% (4541/5000), Test loss:0.3239
Epoch [68/90], Passed time:[222.845/15153.444]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.1726, training acc = 0.92
Batch [200/704] training loss = 0.0535, training acc = 0.97
Batch [400/704] training loss = 0.0697, training acc = 0.97
Batch [600/704] training loss = 0.0743, training acc = 0.97
Valid Test with nat
Test accuracy: 91.78% (4589/5000), Test loss:0.3022
Epoch [69/90], Passed time:[221.547/15286.736]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0545, training acc = 0.98
Batch [200/704] training loss = 0.1415, training acc = 0.95
Batch [400/704] training loss = 0.0601, training acc = 0.95
Batch [600/704] training loss = 0.1528, training acc = 0.95
Valid Test with nat
Test accuracy: 91.66% (4583/5000), Test loss:0.3003
Epoch [70/90], Passed time:[220.073/15405.094]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0159, training acc = 1.00
Batch [200/704] training loss = 0.0186, training acc = 1.00
Batch [400/704] training loss = 0.0559, training acc = 0.98
Batch [600/704] training loss = 0.0257, training acc = 1.00
Valid Test with nat
Test accuracy: 91.72% (4586/5000), Test loss:0.2985
Epoch [71/90], Passed time:[218.354/15503.121]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0376, training acc = 0.98
Batch [200/704] training loss = 0.0474, training acc = 0.98
Batch [400/704] training loss = 0.1297, training acc = 0.95
Batch [600/704] training loss = 0.0902, training acc = 0.95
Valid Test with nat
Test accuracy: 91.72% (4586/5000), Test loss:0.3103
Epoch [72/90], Passed time:[216.750/15605.974]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0606, training acc = 0.98
Batch [200/704] training loss = 0.1023, training acc = 0.95
Batch [400/704] training loss = 0.1099, training acc = 0.97
Batch [600/704] training loss = 0.0826, training acc = 0.95
Valid Test with nat
Test accuracy: 91.96% (4598/5000), Test loss:0.3002
Epoch [73/90], Passed time:[215.129/15704.402]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0974, training acc = 0.97
Batch [200/704] training loss = 0.0817, training acc = 0.95
Batch [400/704] training loss = 0.0240, training acc = 1.00
Batch [600/704] training loss = 0.0714, training acc = 0.98
Valid Test with nat
Test accuracy: 91.66% (4583/5000), Test loss:0.3151
Epoch [74/90], Passed time:[213.524/15800.783]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0460, training acc = 0.98
Batch [200/704] training loss = 0.0343, training acc = 0.98
Batch [400/704] training loss = 0.0690, training acc = 0.95
Batch [600/704] training loss = 0.0736, training acc = 0.98
Valid Test with nat
Test accuracy: 91.80% (4590/5000), Test loss:0.2987
Epoch [75/90], Passed time:[211.999/15899.911]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.1431, training acc = 0.97
Batch [200/704] training loss = 0.1181, training acc = 0.95
Batch [400/704] training loss = 0.1159, training acc = 0.97
Batch [600/704] training loss = 0.0659, training acc = 0.97
Valid Test with nat
Test accuracy: 91.80% (4590/5000), Test loss:0.3003
Epoch [76/90], Passed time:[210.503/15998.265]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0274, training acc = 1.00
Batch [200/704] training loss = 0.0418, training acc = 0.98
Batch [400/704] training loss = 0.0156, training acc = 1.00
Batch [600/704] training loss = 0.0948, training acc = 0.94
Valid Test with nat
Test accuracy: 91.80% (4590/5000), Test loss:0.3001
Epoch [77/90], Passed time:[209.015/16094.143]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0536, training acc = 0.97
Batch [200/704] training loss = 0.0779, training acc = 0.95
Batch [400/704] training loss = 0.1237, training acc = 0.95
Batch [600/704] training loss = 0.0869, training acc = 0.98
Valid Test with nat
Test accuracy: 91.72% (4586/5000), Test loss:0.3116
Epoch [78/90], Passed time:[207.582/16191.401]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0755, training acc = 0.98
Batch [200/704] training loss = 0.1051, training acc = 0.97
Batch [400/704] training loss = 0.0338, training acc = 0.98
Batch [600/704] training loss = 0.0905, training acc = 0.97
Valid Test with nat
Test accuracy: 91.66% (4583/5000), Test loss:0.3022
Epoch [79/90], Passed time:[206.202/16289.964]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0895, training acc = 0.97
Batch [200/704] training loss = 0.0443, training acc = 0.98
Batch [400/704] training loss = 0.0162, training acc = 1.00
Batch [600/704] training loss = 0.0162, training acc = 1.00
Valid Test with nat
Test accuracy: 91.98% (4599/5000), Test loss:0.3056
Epoch [80/90], Passed time:[204.812/16384.984]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.1214, training acc = 0.98
Batch [200/704] training loss = 0.0436, training acc = 0.98
Batch [400/704] training loss = 0.0147, training acc = 1.00
Batch [600/704] training loss = 0.0856, training acc = 0.98
Valid Test with nat
Test accuracy: 91.80% (4590/5000), Test loss:0.3172
Epoch [81/90], Passed time:[203.500/16483.488]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.1043, training acc = 0.97
Batch [200/704] training loss = 0.1022, training acc = 0.95
Batch [400/704] training loss = 0.0811, training acc = 0.97
Batch [600/704] training loss = 0.0937, training acc = 0.97
Valid Test with nat
Test accuracy: 91.96% (4598/5000), Test loss:0.3045
Epoch [82/90], Passed time:[202.229/16582.810]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.1014, training acc = 0.98
Batch [200/704] training loss = 0.0737, training acc = 0.98
Batch [400/704] training loss = 0.0888, training acc = 0.97
Batch [600/704] training loss = 0.0379, training acc = 0.98
Valid Test with nat
Test accuracy: 91.70% (4585/5000), Test loss:0.3048
Epoch [83/90], Passed time:[200.861/16671.503]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0817, training acc = 0.97
Batch [200/704] training loss = 0.0714, training acc = 0.98
Batch [400/704] training loss = 0.0358, training acc = 0.98
Batch [600/704] training loss = 0.0325, training acc = 0.98
Valid Test with nat
Test accuracy: 91.72% (4586/5000), Test loss:0.3030
Epoch [84/90], Passed time:[199.356/16745.915]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0290, training acc = 1.00
Batch [200/704] training loss = 0.1536, training acc = 0.92
Batch [400/704] training loss = 0.0433, training acc = 0.98
Batch [600/704] training loss = 0.0341, training acc = 0.98
Valid Test with nat
Test accuracy: 91.84% (4592/5000), Test loss:0.3053
Epoch [85/90], Passed time:[197.755/16809.212]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0638, training acc = 0.97
Batch [200/704] training loss = 0.1327, training acc = 0.95
Batch [400/704] training loss = 0.0937, training acc = 0.97
Batch [600/704] training loss = 0.0882, training acc = 0.97
Valid Test with nat
Test accuracy: 91.76% (4588/5000), Test loss:0.3055
Epoch [86/90], Passed time:[196.185/16871.902]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0679, training acc = 0.98
Batch [200/704] training loss = 0.0956, training acc = 0.95
Batch [400/704] training loss = 0.0393, training acc = 0.98
Batch [600/704] training loss = 0.0208, training acc = 0.98
Valid Test with nat
Test accuracy: 91.88% (4594/5000), Test loss:0.3069
Epoch [87/90], Passed time:[194.662/16935.572]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0053, training acc = 1.00
Batch [200/704] training loss = 0.1243, training acc = 0.94
Batch [400/704] training loss = 0.0958, training acc = 0.98
Batch [600/704] training loss = 0.0937, training acc = 0.97
Valid Test with nat
Test accuracy: 91.98% (4599/5000), Test loss:0.3047
Epoch [88/90], Passed time:[193.181/16999.885]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0478, training acc = 0.98
Batch [200/704] training loss = 0.0346, training acc = 0.98
Batch [400/704] training loss = 0.0991, training acc = 0.94
Batch [600/704] training loss = 0.1134, training acc = 0.97
Valid Test with nat
Test accuracy: 91.96% (4598/5000), Test loss:0.3098
Epoch [89/90], Passed time:[191.621/17054.233]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0134, training acc = 1.00
Batch [200/704] training loss = 0.0531, training acc = 0.98
Batch [400/704] training loss = 0.0287, training acc = 1.00
Batch [600/704] training loss = 0.0879, training acc = 0.98
Valid Test with nat
Test accuracy: 91.84% (4592/5000), Test loss:0.3145
Training done, model saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/init_enhance90_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 91.39% (9139/10000), Test loss:0.3188
