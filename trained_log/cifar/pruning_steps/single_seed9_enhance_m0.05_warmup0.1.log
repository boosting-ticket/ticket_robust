model_type : resnet18
init_type : pure
finetune_method : nat
enhance_method : nat
gpu : 4
model_name : seed9_enhance_m0.05_warmup0.1
model_width : 8
n_pruning_steps : 1
max_pruning_ratio : 80
train_epochs : 100
enhance_epochs : None
prune_method : unstructured
dataset : cifar
noise_sd : 1.0
trades_beta : 6.0
seed : 9
warmup : True
parallel : False
create_init : False
init_step : 1400
train_method : nat
early_stop : 1000
norm : True
optm : sgd
batch_size : 128
test_batch_size : 100
learning_rate : 0.1
enhance_learning_rate : 0.1
schedule_length : 10
weight_decay : 0.0001
epsilon : 0.03137254901960784
attack_iter : 10
eps_step : 0.00784313725490196
targeted : False
clip_min : 0
clip_max : 1.0
starting_epsilon : 1e-05
interval_weight : 0.1
ft_interval_weight : 50
verbose : 200
resume : 0
model_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/seed9_enhance_m0.05_warmup0.1.pth
last_model_path : ./trained_models_new/
mask_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/pruned_lr0.05_mask_r80.npy
mask_name : pruned_lr0.05_mask_r80
log_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/seed9_enhance_m0.05_warmup0.1.log
init_path : ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
results_path : None
n_classes : 10
eval : False
init : False
transfer : False
CUDA enabled.
Enhance training config:
Enhance training method: nat
model will be saved in: ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/seed9_enhance_m0.05_warmup0.1.pth
Init model is: ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
Init mask used from: ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/pruned_lr0.05_mask_r80.npy
Log will be saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/seed9_enhance_m0.05_warmup0.1.log
Random seed is: 9

Epoch [0/100]
learning rate: 0.05
Batch [0/352] training loss = 2.3323, training acc = 0.08
Batch [200/352] training loss = 1.5036, training acc = 0.40
Valid Test with nat
Test accuracy: 52.20% (2610/5000), Test loss:1.4731
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/seed9_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 52.58% (5258/10000), Test loss:1.3787
Epoch [1/100], Passed time:[84.434/84.434]
learning rate: 0.055
Batch [0/352] training loss = 1.2742, training acc = 0.54
Batch [200/352] training loss = 0.8140, training acc = 0.70
Valid Test with nat
Test accuracy: 59.66% (2983/5000), Test loss:1.2298
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/seed9_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 56.46% (5646/10000), Test loss:1.3184
Epoch [2/100], Passed time:[84.596/169.192]
learning rate: 0.060000000000000005
Batch [0/352] training loss = 0.9648, training acc = 0.65
Batch [200/352] training loss = 0.6302, training acc = 0.77
Valid Test with nat
Test accuracy: 69.92% (3496/5000), Test loss:0.9225
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/seed9_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 69.77% (6977/10000), Test loss:0.9024
Epoch [3/100], Passed time:[86.507/259.521]
learning rate: 0.065
Batch [0/352] training loss = 0.7930, training acc = 0.73
Batch [200/352] training loss = 0.9475, training acc = 0.70
Valid Test with nat
Test accuracy: 72.24% (3612/5000), Test loss:0.8862
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/seed9_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 74.65% (7465/10000), Test loss:0.7870
Epoch [4/100], Passed time:[88.834/355.338]
learning rate: 0.07
Batch [0/352] training loss = 0.6027, training acc = 0.75
Batch [200/352] training loss = 0.6158, training acc = 0.79
Valid Test with nat
Test accuracy: 75.38% (3769/5000), Test loss:0.7904
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/seed9_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 75.54% (7554/10000), Test loss:0.7592
Epoch [5/100], Passed time:[89.550/447.750]
learning rate: 0.07500000000000001
Batch [0/352] training loss = 0.5971, training acc = 0.83
Batch [200/352] training loss = 0.5924, training acc = 0.79
Valid Test with nat
Test accuracy: 73.98% (3699/5000), Test loss:0.8425
Epoch [6/100], Passed time:[89.817/538.900]
learning rate: 0.08000000000000002
Batch [0/352] training loss = 0.5897, training acc = 0.77
Batch [200/352] training loss = 0.5333, training acc = 0.83
Valid Test with nat
Test accuracy: 80.48% (4024/5000), Test loss:0.6015
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/seed9_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 81.08% (8108/10000), Test loss:0.5640
Epoch [7/100], Passed time:[90.011/630.075]
learning rate: 0.085
Batch [0/352] training loss = 0.3966, training acc = 0.85
Batch [200/352] training loss = 0.5404, training acc = 0.84
Valid Test with nat
Test accuracy: 79.94% (3997/5000), Test loss:0.6019
Epoch [8/100], Passed time:[90.085/720.679]
learning rate: 0.09
Batch [0/352] training loss = 0.5274, training acc = 0.81
Batch [200/352] training loss = 0.5415, training acc = 0.80
Valid Test with nat
Test accuracy: 79.86% (3993/5000), Test loss:0.6305
Epoch [9/100], Passed time:[89.947/809.523]
learning rate: 0.095
Batch [0/352] training loss = 0.3435, training acc = 0.89
Batch [200/352] training loss = 0.4825, training acc = 0.83
Valid Test with nat
Test accuracy: 81.84% (4092/5000), Test loss:0.5526
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/seed9_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 81.97% (8197/10000), Test loss:0.5552
Epoch [10/100], Passed time:[90.715/907.150]
learning rate: 0.1
Batch [0/352] training loss = 0.4396, training acc = 0.84
Batch [200/352] training loss = 0.3683, training acc = 0.85
Valid Test with nat
Test accuracy: 83.08% (4154/5000), Test loss:0.5449
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/seed9_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 83.15% (8315/10000), Test loss:0.5368
Epoch [11/100], Passed time:[91.488/1006.366]
learning rate: 0.1
Batch [0/352] training loss = 0.2980, training acc = 0.89
Batch [200/352] training loss = 0.3153, training acc = 0.91
Valid Test with nat
Test accuracy: 82.72% (4136/5000), Test loss:0.5425
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/seed9_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 82.05% (8205/10000), Test loss:0.5665
Epoch [12/100], Passed time:[92.062/1104.750]
learning rate: 0.1
Batch [0/352] training loss = 0.3858, training acc = 0.86
Batch [200/352] training loss = 0.4911, training acc = 0.84
Valid Test with nat
Test accuracy: 83.14% (4157/5000), Test loss:0.5155
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/seed9_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 81.75% (8175/10000), Test loss:0.5630
Epoch [13/100], Passed time:[92.331/1200.301]
learning rate: 0.1
Batch [0/352] training loss = 0.3725, training acc = 0.88
Batch [200/352] training loss = 0.4376, training acc = 0.88
Valid Test with nat
Test accuracy: 83.46% (4173/5000), Test loss:0.5576
Epoch [14/100], Passed time:[92.097/1289.360]
learning rate: 0.1
Batch [0/352] training loss = 0.3705, training acc = 0.88
Batch [200/352] training loss = 0.3117, training acc = 0.89
Valid Test with nat
Test accuracy: 85.26% (4263/5000), Test loss:0.4763
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/seed9_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 85.24% (8524/10000), Test loss:0.4581
Epoch [15/100], Passed time:[92.376/1385.643]
learning rate: 0.1
Batch [0/352] training loss = 0.2521, training acc = 0.91
Batch [200/352] training loss = 0.4051, training acc = 0.83
Valid Test with nat
Test accuracy: 83.66% (4183/5000), Test loss:0.5019
Epoch [16/100], Passed time:[92.334/1477.340]
learning rate: 0.1
Batch [0/352] training loss = 0.2849, training acc = 0.92
Batch [200/352] training loss = 0.3259, training acc = 0.90
Valid Test with nat
Test accuracy: 85.12% (4256/5000), Test loss:0.4936
Epoch [17/100], Passed time:[92.246/1568.181]
learning rate: 0.1
Batch [0/352] training loss = 0.2265, training acc = 0.91
Batch [200/352] training loss = 0.3169, training acc = 0.88
Valid Test with nat
Test accuracy: 85.32% (4266/5000), Test loss:0.4427
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/seed9_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 86.27% (8627/10000), Test loss:0.4162
Epoch [18/100], Passed time:[92.286/1661.142]
learning rate: 0.1
Batch [0/352] training loss = 0.2514, training acc = 0.89
Batch [200/352] training loss = 0.3830, training acc = 0.87
Valid Test with nat
Test accuracy: 87.20% (4360/5000), Test loss:0.4005
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/seed9_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 87.00% (8700/10000), Test loss:0.4082
Epoch [19/100], Passed time:[92.462/1756.778]
learning rate: 0.1
Batch [0/352] training loss = 0.3231, training acc = 0.87
Batch [200/352] training loss = 0.2220, training acc = 0.94
Valid Test with nat
Test accuracy: 85.18% (4259/5000), Test loss:0.4853
Epoch [20/100], Passed time:[92.174/1843.484]
learning rate: 0.1
Batch [0/352] training loss = 0.2249, training acc = 0.94
Batch [200/352] training loss = 0.3000, training acc = 0.90
Valid Test with nat
Test accuracy: 86.78% (4339/5000), Test loss:0.4207
Epoch [21/100], Passed time:[91.959/1931.136]
learning rate: 0.1
Batch [0/352] training loss = 0.2800, training acc = 0.92
Batch [200/352] training loss = 0.3216, training acc = 0.85
Valid Test with nat
Test accuracy: 87.88% (4394/5000), Test loss:0.3972
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/seed9_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 88.01% (8801/10000), Test loss:0.3731
Epoch [22/100], Passed time:[92.081/2025.785]
learning rate: 0.1
Batch [0/352] training loss = 0.2957, training acc = 0.90
Batch [200/352] training loss = 0.1962, training acc = 0.95
Valid Test with nat
Test accuracy: 86.14% (4307/5000), Test loss:0.4311
Epoch [23/100], Passed time:[91.937/2114.551]
learning rate: 0.1
Batch [0/352] training loss = 0.3150, training acc = 0.91
Batch [200/352] training loss = 0.3549, training acc = 0.86
Valid Test with nat
Test accuracy: 84.12% (4206/5000), Test loss:0.5269
Epoch [24/100], Passed time:[91.636/2199.256]
learning rate: 0.1
Batch [0/352] training loss = 0.2577, training acc = 0.91
Batch [200/352] training loss = 0.3336, training acc = 0.86
Valid Test with nat
Test accuracy: 86.10% (4305/5000), Test loss:0.4545
Epoch [25/100], Passed time:[91.569/2289.219]
learning rate: 0.1
Batch [0/352] training loss = 0.2334, training acc = 0.92
Batch [200/352] training loss = 0.2076, training acc = 0.93
Valid Test with nat
Test accuracy: 84.84% (4242/5000), Test loss:0.4817
Epoch [26/100], Passed time:[91.493/2378.817]
learning rate: 0.1
Batch [0/352] training loss = 0.2026, training acc = 0.93
Batch [200/352] training loss = 0.2617, training acc = 0.91
Valid Test with nat
Test accuracy: 84.22% (4211/5000), Test loss:0.5279
Epoch [27/100], Passed time:[91.384/2467.363]
learning rate: 0.1
Batch [0/352] training loss = 0.1694, training acc = 0.95
Batch [200/352] training loss = 0.2734, training acc = 0.89
Valid Test with nat
Test accuracy: 87.24% (4362/5000), Test loss:0.3979
Epoch [28/100], Passed time:[91.397/2559.116]
learning rate: 0.1
Batch [0/352] training loss = 0.2164, training acc = 0.94
Batch [200/352] training loss = 0.2488, training acc = 0.90
Valid Test with nat
Test accuracy: 87.34% (4367/5000), Test loss:0.4260
Epoch [29/100], Passed time:[91.386/2650.201]
learning rate: 0.1
Batch [0/352] training loss = 0.2488, training acc = 0.91
Batch [200/352] training loss = 0.4415, training acc = 0.85
Valid Test with nat
Test accuracy: 82.72% (4136/5000), Test loss:0.6075
Epoch [30/100], Passed time:[91.370/2741.105]
learning rate: 0.1
Batch [0/352] training loss = 0.2259, training acc = 0.92
Batch [200/352] training loss = 0.2888, training acc = 0.90
Valid Test with nat
Test accuracy: 88.56% (4428/5000), Test loss:0.3613
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/seed9_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 88.31% (8831/10000), Test loss:0.3639
Epoch [31/100], Passed time:[91.550/2838.058]
learning rate: 0.1
Batch [0/352] training loss = 0.1839, training acc = 0.93
Batch [200/352] training loss = 0.2581, training acc = 0.89
Valid Test with nat
Test accuracy: 83.68% (4184/5000), Test loss:0.5317
Epoch [32/100], Passed time:[91.527/2928.872]
learning rate: 0.1
Batch [0/352] training loss = 0.2313, training acc = 0.90
Batch [200/352] training loss = 0.2361, training acc = 0.91
Valid Test with nat
Test accuracy: 85.86% (4293/5000), Test loss:0.5038
Epoch [33/100], Passed time:[91.451/3017.896]
learning rate: 0.1
Batch [0/352] training loss = 0.2322, training acc = 0.94
Batch [200/352] training loss = 0.3055, training acc = 0.90
Valid Test with nat
Test accuracy: 83.50% (4175/5000), Test loss:0.6065
Epoch [34/100], Passed time:[91.415/3108.118]
learning rate: 0.1
Batch [0/352] training loss = 0.1567, training acc = 0.94
Batch [200/352] training loss = 0.2613, training acc = 0.90
Valid Test with nat
Test accuracy: 86.04% (4302/5000), Test loss:0.4396
Epoch [35/100], Passed time:[91.339/3196.871]
learning rate: 0.1
Batch [0/352] training loss = 0.2664, training acc = 0.89
Batch [200/352] training loss = 0.2188, training acc = 0.92
Valid Test with nat
Test accuracy: 87.38% (4369/5000), Test loss:0.4126
Epoch [36/100], Passed time:[91.290/3286.426]
learning rate: 0.1
Batch [0/352] training loss = 0.1775, training acc = 0.95
Batch [200/352] training loss = 0.2105, training acc = 0.89
Valid Test with nat
Test accuracy: 87.82% (4391/5000), Test loss:0.4148
Epoch [37/100], Passed time:[91.211/3374.800]
learning rate: 0.1
Batch [0/352] training loss = 0.1208, training acc = 0.97
Batch [200/352] training loss = 0.4311, training acc = 0.83
Valid Test with nat
Test accuracy: 87.28% (4364/5000), Test loss:0.4052
Epoch [38/100], Passed time:[91.114/3462.321]
learning rate: 0.1
Batch [0/352] training loss = 0.2460, training acc = 0.93
Batch [200/352] training loss = 0.1809, training acc = 0.91
Valid Test with nat
Test accuracy: 87.28% (4364/5000), Test loss:0.4309
Epoch [39/100], Passed time:[90.988/3548.522]
learning rate: 0.1
Batch [0/352] training loss = 0.2025, training acc = 0.91
Batch [200/352] training loss = 0.2302, training acc = 0.89
Valid Test with nat
Test accuracy: 84.12% (4206/5000), Test loss:0.5305
Epoch [40/100], Passed time:[90.911/3636.430]
learning rate: 0.1
Batch [0/352] training loss = 0.1694, training acc = 0.95
Batch [200/352] training loss = 0.2104, training acc = 0.91
Valid Test with nat
Test accuracy: 86.80% (4340/5000), Test loss:0.4442
Epoch [41/100], Passed time:[90.891/3726.549]
learning rate: 0.1
Batch [0/352] training loss = 0.2889, training acc = 0.88
Batch [200/352] training loss = 0.2712, training acc = 0.92
Valid Test with nat
Test accuracy: 88.00% (4400/5000), Test loss:0.4159
Epoch [42/100], Passed time:[90.841/3815.335]
learning rate: 0.1
Batch [0/352] training loss = 0.1220, training acc = 0.94
Batch [200/352] training loss = 0.2794, training acc = 0.88
Valid Test with nat
Test accuracy: 89.22% (4461/5000), Test loss:0.3613
Epoch [43/100], Passed time:[90.786/3903.799]
learning rate: 0.1
Batch [0/352] training loss = 0.2045, training acc = 0.93
Batch [200/352] training loss = 0.1842, training acc = 0.95
Valid Test with nat
Test accuracy: 87.78% (4389/5000), Test loss:0.4012
Epoch [44/100], Passed time:[90.716/3991.483]
learning rate: 0.1
Batch [0/352] training loss = 0.1545, training acc = 0.93
Batch [200/352] training loss = 0.2174, training acc = 0.92
Valid Test with nat
Test accuracy: 89.02% (4451/5000), Test loss:0.3762
Epoch [45/100], Passed time:[90.710/4081.966]
learning rate: 0.1
Batch [0/352] training loss = 0.2420, training acc = 0.91
Batch [200/352] training loss = 0.2377, training acc = 0.89
Valid Test with nat
Test accuracy: 86.58% (4329/5000), Test loss:0.4323
Epoch [46/100], Passed time:[90.762/4175.069]
learning rate: 0.1
Batch [0/352] training loss = 0.2632, training acc = 0.90
Batch [200/352] training loss = 0.3075, training acc = 0.91
Valid Test with nat
Test accuracy: 89.02% (4451/5000), Test loss:0.4157
Epoch [47/100], Passed time:[90.767/4266.043]
learning rate: 0.1
Batch [0/352] training loss = 0.1854, training acc = 0.95
Batch [200/352] training loss = 0.2201, training acc = 0.90
Valid Test with nat
Test accuracy: 86.74% (4337/5000), Test loss:0.4449
Epoch [48/100], Passed time:[90.755/4356.224]
learning rate: 0.1
Batch [0/352] training loss = 0.1389, training acc = 0.94
Batch [200/352] training loss = 0.1770, training acc = 0.94
Valid Test with nat
Test accuracy: 88.04% (4402/5000), Test loss:0.4208
Epoch [49/100], Passed time:[90.719/4445.227]
learning rate: 0.1
Batch [0/352] training loss = 0.3147, training acc = 0.88
Batch [200/352] training loss = 0.1507, training acc = 0.95
Valid Test with nat
Test accuracy: 87.30% (4365/5000), Test loss:0.4258
Epoch [50/100], Passed time:[90.631/4531.558]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.2266, training acc = 0.91
Batch [200/352] training loss = 0.1350, training acc = 0.95
Valid Test with nat
Test accuracy: 92.30% (4615/5000), Test loss:0.2536
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/seed9_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 91.53% (9153/10000), Test loss:0.2653
Epoch [51/100], Passed time:[90.696/4625.514]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.1007, training acc = 0.95
Batch [200/352] training loss = 0.0655, training acc = 0.99
Valid Test with nat
Test accuracy: 92.26% (4613/5000), Test loss:0.2675
Epoch [52/100], Passed time:[90.667/4714.696]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.1194, training acc = 0.95
Batch [200/352] training loss = 0.0510, training acc = 0.98
Valid Test with nat
Test accuracy: 92.12% (4606/5000), Test loss:0.2549
Epoch [53/100], Passed time:[90.610/4802.336]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0902, training acc = 0.96
Batch [200/352] training loss = 0.2025, training acc = 0.91
Valid Test with nat
Test accuracy: 92.50% (4625/5000), Test loss:0.2567
Epoch [54/100], Passed time:[90.544/4889.399]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.1193, training acc = 0.95
Batch [200/352] training loss = 0.1070, training acc = 0.97
Valid Test with nat
Test accuracy: 92.54% (4627/5000), Test loss:0.2531
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/seed9_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 91.82% (9182/10000), Test loss:0.2680
Epoch [55/100], Passed time:[90.656/4986.083]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0597, training acc = 0.98
Batch [200/352] training loss = 0.1028, training acc = 0.96
Valid Test with nat
Test accuracy: 92.52% (4626/5000), Test loss:0.2575
Epoch [56/100], Passed time:[90.612/5074.287]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0187, training acc = 1.00
Batch [200/352] training loss = 0.0672, training acc = 0.97
Valid Test with nat
Test accuracy: 92.74% (4637/5000), Test loss:0.2539
Epoch [57/100], Passed time:[90.582/5163.188]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0433, training acc = 0.99
Batch [200/352] training loss = 0.0412, training acc = 0.98
Valid Test with nat
Test accuracy: 92.70% (4635/5000), Test loss:0.2628
Epoch [58/100], Passed time:[90.618/5255.860]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0754, training acc = 0.98
Batch [200/352] training loss = 0.0836, training acc = 0.97
Valid Test with nat
Test accuracy: 92.74% (4637/5000), Test loss:0.2557
Epoch [59/100], Passed time:[90.681/5350.159]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0395, training acc = 0.98
Batch [200/352] training loss = 0.0625, training acc = 0.98
Valid Test with nat
Test accuracy: 92.90% (4645/5000), Test loss:0.2672
Epoch [60/100], Passed time:[90.657/5439.404]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.1165, training acc = 0.96
Batch [200/352] training loss = 0.0813, training acc = 0.96
Valid Test with nat
Test accuracy: 92.70% (4635/5000), Test loss:0.2718
Epoch [61/100], Passed time:[90.702/5532.798]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0323, training acc = 0.99
Batch [200/352] training loss = 0.0448, training acc = 0.98
Valid Test with nat
Test accuracy: 92.60% (4630/5000), Test loss:0.2722
Epoch [62/100], Passed time:[90.655/5620.641]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.1612, training acc = 0.94
Batch [200/352] training loss = 0.0759, training acc = 0.97
Valid Test with nat
Test accuracy: 92.80% (4640/5000), Test loss:0.2845
Epoch [63/100], Passed time:[90.680/5712.856]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0442, training acc = 0.98
Batch [200/352] training loss = 0.0941, training acc = 0.96
Valid Test with nat
Test accuracy: 92.50% (4625/5000), Test loss:0.2910
Epoch [64/100], Passed time:[90.714/5805.699]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0546, training acc = 0.98
Batch [200/352] training loss = 0.0643, training acc = 0.98
Valid Test with nat
Test accuracy: 92.46% (4623/5000), Test loss:0.2767
Epoch [65/100], Passed time:[90.680/5894.212]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0372, training acc = 0.98
Batch [200/352] training loss = 0.0882, training acc = 0.98
Valid Test with nat
Test accuracy: 92.42% (4621/5000), Test loss:0.3198
Epoch [66/100], Passed time:[90.639/5982.183]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0157, training acc = 0.99
Batch [200/352] training loss = 0.0529, training acc = 0.98
Valid Test with nat
Test accuracy: 92.86% (4643/5000), Test loss:0.2894
Epoch [67/100], Passed time:[90.630/6072.223]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0083, training acc = 1.00
Batch [200/352] training loss = 0.0611, training acc = 0.98
Valid Test with nat
Test accuracy: 92.58% (4629/5000), Test loss:0.2812
Epoch [68/100], Passed time:[90.601/6160.842]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0308, training acc = 0.99
Batch [200/352] training loss = 0.0090, training acc = 1.00
Valid Test with nat
Test accuracy: 92.66% (4633/5000), Test loss:0.3039
Epoch [69/100], Passed time:[90.596/6251.153]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0087, training acc = 1.00
Batch [200/352] training loss = 0.0417, training acc = 0.98
Valid Test with nat
Test accuracy: 92.90% (4645/5000), Test loss:0.2920
Epoch [70/100], Passed time:[90.538/6337.635]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0705, training acc = 0.97
Batch [200/352] training loss = 0.0427, training acc = 0.99
Valid Test with nat
Test accuracy: 92.66% (4633/5000), Test loss:0.2966
Epoch [71/100], Passed time:[90.496/6425.198]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0361, training acc = 0.99
Batch [200/352] training loss = 0.0228, training acc = 0.99
Valid Test with nat
Test accuracy: 92.66% (4633/5000), Test loss:0.2967
Epoch [72/100], Passed time:[90.504/6516.315]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0352, training acc = 0.98
Batch [200/352] training loss = 0.0861, training acc = 0.97
Valid Test with nat
Test accuracy: 92.68% (4634/5000), Test loss:0.2944
Epoch [73/100], Passed time:[90.470/6604.343]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0358, training acc = 0.98
Batch [200/352] training loss = 0.0198, training acc = 1.00
Valid Test with nat
Test accuracy: 92.88% (4644/5000), Test loss:0.3060
Epoch [74/100], Passed time:[90.429/6691.716]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0468, training acc = 0.98
Batch [200/352] training loss = 0.0130, training acc = 1.00
Valid Test with nat
Test accuracy: 92.96% (4648/5000), Test loss:0.2979
Epoch [75/100], Passed time:[90.387/6779.061]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0356, training acc = 0.98
Batch [200/352] training loss = 0.0241, training acc = 0.99
Valid Test with nat
Test accuracy: 92.98% (4649/5000), Test loss:0.3016
Epoch [76/100], Passed time:[90.390/6869.610]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0319, training acc = 0.98
Batch [200/352] training loss = 0.0331, training acc = 0.99
Valid Test with nat
Test accuracy: 92.96% (4648/5000), Test loss:0.2904
Epoch [77/100], Passed time:[90.368/6958.373]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0246, training acc = 0.99
Batch [200/352] training loss = 0.0068, training acc = 1.00
Valid Test with nat
Test accuracy: 92.68% (4634/5000), Test loss:0.2908
Epoch [78/100], Passed time:[90.412/7052.149]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0297, training acc = 0.98
Batch [200/352] training loss = 0.0474, training acc = 0.98
Valid Test with nat
Test accuracy: 93.06% (4653/5000), Test loss:0.2855
Epoch [79/100], Passed time:[90.431/7144.021]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0177, training acc = 0.99
Batch [200/352] training loss = 0.0240, training acc = 0.99
Valid Test with nat
Test accuracy: 93.02% (4651/5000), Test loss:0.3150
Epoch [80/100], Passed time:[90.431/7234.487]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0469, training acc = 0.98
Batch [200/352] training loss = 0.0370, training acc = 0.98
Valid Test with nat
Test accuracy: 92.94% (4647/5000), Test loss:0.2862
Epoch [81/100], Passed time:[90.442/7325.835]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0446, training acc = 0.98
Batch [200/352] training loss = 0.0289, training acc = 0.99
Valid Test with nat
Test accuracy: 93.22% (4661/5000), Test loss:0.2878
Epoch [82/100], Passed time:[90.445/7416.521]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0377, training acc = 0.98
Batch [200/352] training loss = 0.0186, training acc = 1.00
Valid Test with nat
Test accuracy: 92.90% (4645/5000), Test loss:0.2870
Epoch [83/100], Passed time:[90.436/7506.210]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0058, training acc = 1.00
Batch [200/352] training loss = 0.0078, training acc = 1.00
Valid Test with nat
Test accuracy: 93.00% (4650/5000), Test loss:0.3072
Epoch [84/100], Passed time:[90.436/7596.628]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0488, training acc = 0.98
Batch [200/352] training loss = 0.0264, training acc = 0.99
Valid Test with nat
Test accuracy: 93.06% (4653/5000), Test loss:0.2847
Epoch [85/100], Passed time:[90.433/7686.770]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0141, training acc = 0.99
Batch [200/352] training loss = 0.0177, training acc = 0.99
Valid Test with nat
Test accuracy: 92.88% (4644/5000), Test loss:0.3048
Epoch [86/100], Passed time:[90.429/7776.902]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0389, training acc = 0.98
Batch [200/352] training loss = 0.0177, training acc = 1.00
Valid Test with nat
Test accuracy: 93.04% (4652/5000), Test loss:0.2890
Epoch [87/100], Passed time:[90.408/7865.519]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0551, training acc = 0.98
Batch [200/352] training loss = 0.0475, training acc = 0.99
Valid Test with nat
Test accuracy: 93.04% (4652/5000), Test loss:0.2913
Epoch [88/100], Passed time:[90.375/7953.003]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0214, training acc = 0.99
Batch [200/352] training loss = 0.0469, training acc = 0.98
Valid Test with nat
Test accuracy: 93.08% (4654/5000), Test loss:0.2841
Epoch [89/100], Passed time:[90.351/8041.219]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0459, training acc = 0.98
Batch [200/352] training loss = 0.0460, training acc = 0.98
Valid Test with nat
Test accuracy: 93.00% (4650/5000), Test loss:0.2859
Epoch [90/100], Passed time:[90.343/8130.854]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0165, training acc = 1.00
Batch [200/352] training loss = 0.0129, training acc = 1.00
Valid Test with nat
Test accuracy: 92.86% (4643/5000), Test loss:0.2854
Epoch [91/100], Passed time:[90.334/8220.356]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0218, training acc = 0.99
Batch [200/352] training loss = 0.0345, training acc = 0.98
Valid Test with nat
Test accuracy: 92.96% (4648/5000), Test loss:0.2855
Epoch [92/100], Passed time:[90.371/8314.122]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0270, training acc = 0.98
Batch [200/352] training loss = 0.0276, training acc = 0.98
Valid Test with nat
Test accuracy: 92.78% (4639/5000), Test loss:0.2929
Epoch [93/100], Passed time:[90.393/8406.579]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0184, training acc = 0.99
Batch [200/352] training loss = 0.0223, training acc = 0.99
Valid Test with nat
Test accuracy: 92.92% (4646/5000), Test loss:0.2899
Epoch [94/100], Passed time:[90.374/8495.198]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0382, training acc = 0.99
Batch [200/352] training loss = 0.0131, training acc = 0.99
Valid Test with nat
Test accuracy: 92.96% (4648/5000), Test loss:0.2911
Epoch [95/100], Passed time:[90.344/8582.689]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0059, training acc = 1.00
Batch [200/352] training loss = 0.0202, training acc = 0.98
Valid Test with nat
Test accuracy: 92.96% (4648/5000), Test loss:0.2955
Epoch [96/100], Passed time:[90.331/8671.811]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0156, training acc = 1.00
Batch [200/352] training loss = 0.0371, training acc = 0.98
Valid Test with nat
Test accuracy: 92.98% (4649/5000), Test loss:0.2880
Epoch [97/100], Passed time:[90.300/8759.114]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0087, training acc = 1.00
Batch [200/352] training loss = 0.0115, training acc = 0.99
Valid Test with nat
Test accuracy: 93.02% (4651/5000), Test loss:0.2885
Epoch [98/100], Passed time:[90.262/8845.652]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0564, training acc = 0.99
Batch [200/352] training loss = 0.0300, training acc = 0.99
Valid Test with nat
Test accuracy: 93.00% (4650/5000), Test loss:0.2894
Epoch [99/100], Passed time:[90.198/8929.649]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0131, training acc = 0.99
Batch [200/352] training loss = 0.0866, training acc = 0.96
Valid Test with nat
Test accuracy: 93.08% (4654/5000), Test loss:0.2926
Training done, model saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/seed9_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 92.62% (9262/10000), Test loss:0.2974
