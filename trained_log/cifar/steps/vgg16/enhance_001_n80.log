model_type : vgg16
init_type : pure
finetune_method : nat
enhance_method : nat
gpu : 5
model_name : enhance_001_n80
model_width : 8
n_pruning_steps : 1
max_pruning_ratio : 80
train_epochs : 80
enhance_epochs : 80
prune_method : unstructured
dataset : cifar
noise_sd : 1.0
trades_beta : 6.0
seed : 7
warmup : True
create_init : False
init_step : 1400
train_method : nat
early_stop : 50
norm : True
optm : sgd
batch_size : 64
test_batch_size : 100
learning_rate : 0.01
enhance_learning_rate : None
schedule_length : 10
weight_decay : 0.0001
epsilon : 0.03137254901960784
attack_iter : 10
eps_step : 0.00784313725490196
targeted : False
clip_min : 0
clip_max : 1.0
starting_epsilon : 1e-05
interval_weight : 0.1
ft_interval_weight : 50
verbose : 200
resume : 0
model_path : ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n80.pth
last_model_path : ./trained_models_new/
mask_path : ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/pruned_001_mask_r80.npy
mask_name : pruned_001_mask_r80
log_path : ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n80.log
init_path : ./trained_models_new/cifar/vgg16/init/pure_vgg16_init.pth
results_path : None
n_classes : 10
eval : False
init : True
transfer : False
CUDA enabled.
Enhance training config:
Enhance training method: nat
model will be saved in: ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n80.pth
Init model is: ./trained_models_new/cifar/vgg16/init/pure_vgg16_init.pth
Init mask used from: ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/pruned_001_mask_r80.npy
Log will be saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n80.log
Random seed is: 7

model loading from ./trained_models_new/cifar/vgg16/init/pure_vgg16_init.pth
Epoch [0/80]
learning rate: 0.001
Batch [0/704] training loss = 2.2368, training acc = 0.27
Batch [200/704] training loss = 1.5914, training acc = 0.45
Batch [400/704] training loss = 1.2494, training acc = 0.61
Batch [600/704] training loss = 0.7298, training acc = 0.77
Valid Test with nat
Test accuracy: 72.68% (3634/5000), Test loss:0.8164
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n80.pth
Test on test set:
Test accuracy: 72.19% (7219/10000), Test loss:0.8293
Epoch [1/80], Passed time:[68.977/68.977]
learning rate: 0.002
Batch [0/704] training loss = 0.8382, training acc = 0.70
Batch [200/704] training loss = 0.7020, training acc = 0.77
Batch [400/704] training loss = 0.4937, training acc = 0.83
Batch [600/704] training loss = 0.6214, training acc = 0.75
Valid Test with nat
Test accuracy: 82.66% (4133/5000), Test loss:0.5384
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n80.pth
Test on test set:
Test accuracy: 81.77% (8177/10000), Test loss:0.5503
Epoch [2/80], Passed time:[68.745/137.489]
learning rate: 0.0030000000000000005
Batch [0/704] training loss = 0.4358, training acc = 0.84
Batch [200/704] training loss = 0.4901, training acc = 0.84
Batch [400/704] training loss = 0.5478, training acc = 0.77
Batch [600/704] training loss = 0.4958, training acc = 0.81
Valid Test with nat
Test accuracy: 84.06% (4203/5000), Test loss:0.4786
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n80.pth
Test on test set:
Test accuracy: 83.52% (8352/10000), Test loss:0.4991
Epoch [3/80], Passed time:[68.849/206.546]
learning rate: 0.004
Batch [0/704] training loss = 0.2760, training acc = 0.92
Batch [200/704] training loss = 0.4717, training acc = 0.86
Batch [400/704] training loss = 0.4337, training acc = 0.80
Batch [600/704] training loss = 0.5494, training acc = 0.81
Valid Test with nat
Test accuracy: 84.52% (4226/5000), Test loss:0.4593
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n80.pth
Test on test set:
Test accuracy: 84.93% (8493/10000), Test loss:0.4419
Epoch [4/80], Passed time:[70.204/280.818]
learning rate: 0.005
Batch [0/704] training loss = 0.4170, training acc = 0.84
Batch [200/704] training loss = 0.2754, training acc = 0.91
Batch [400/704] training loss = 0.5937, training acc = 0.83
Batch [600/704] training loss = 0.6782, training acc = 0.77
Valid Test with nat
Test accuracy: 81.50% (4075/5000), Test loss:0.5606
Epoch [5/80], Passed time:[67.886/339.428]
learning rate: 0.006000000000000001
Batch [0/704] training loss = 0.5726, training acc = 0.80
Batch [200/704] training loss = 0.1702, training acc = 0.95
Batch [400/704] training loss = 0.4217, training acc = 0.84
Batch [600/704] training loss = 0.3065, training acc = 0.89
Valid Test with nat
Test accuracy: 86.32% (4316/5000), Test loss:0.4167
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n80.pth
Test on test set:
Test accuracy: 85.56% (8556/10000), Test loss:0.4414
Epoch [6/80], Passed time:[68.583/411.501]
learning rate: 0.007000000000000001
Batch [0/704] training loss = 0.3151, training acc = 0.86
Batch [200/704] training loss = 0.2760, training acc = 0.92
Batch [400/704] training loss = 0.3939, training acc = 0.81
Batch [600/704] training loss = 0.2079, training acc = 0.94
Valid Test with nat
Test accuracy: 87.12% (4356/5000), Test loss:0.3914
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n80.pth
Test on test set:
Test accuracy: 86.84% (8684/10000), Test loss:0.4102
Epoch [7/80], Passed time:[69.486/486.401]
learning rate: 0.008
Batch [0/704] training loss = 0.2993, training acc = 0.88
Batch [200/704] training loss = 0.2874, training acc = 0.89
Batch [400/704] training loss = 0.1862, training acc = 0.95
Batch [600/704] training loss = 0.3439, training acc = 0.86
Valid Test with nat
Test accuracy: 85.46% (4273/5000), Test loss:0.4198
Epoch [8/80], Passed time:[70.004/560.031]
learning rate: 0.009000000000000001
Batch [0/704] training loss = 0.5147, training acc = 0.86
Batch [200/704] training loss = 0.3721, training acc = 0.83
Batch [400/704] training loss = 0.2848, training acc = 0.88
Batch [600/704] training loss = 0.2025, training acc = 0.89
Valid Test with nat
Test accuracy: 87.52% (4376/5000), Test loss:0.3907
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n80.pth
Test on test set:
Test accuracy: 86.94% (8694/10000), Test loss:0.3984
Epoch [9/80], Passed time:[70.425/633.827]
learning rate: 0.01
Batch [0/704] training loss = 0.3455, training acc = 0.89
Batch [200/704] training loss = 0.2586, training acc = 0.88
Batch [400/704] training loss = 0.2676, training acc = 0.91
Batch [600/704] training loss = 0.3494, training acc = 0.88
Valid Test with nat
Test accuracy: 87.48% (4374/5000), Test loss:0.3871
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n80.pth
Test on test set:
Test accuracy: 87.00% (8700/10000), Test loss:0.4115
Epoch [10/80], Passed time:[70.583/705.828]
learning rate: 0.01
Batch [0/704] training loss = 0.1978, training acc = 0.94
Batch [200/704] training loss = 0.2405, training acc = 0.95
Batch [400/704] training loss = 0.1562, training acc = 0.95
Batch [600/704] training loss = 0.2098, training acc = 0.94
Valid Test with nat
Test accuracy: 87.74% (4387/5000), Test loss:0.3797
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n80.pth
Test on test set:
Test accuracy: 87.41% (8741/10000), Test loss:0.3975
Epoch [11/80], Passed time:[71.203/783.232]
learning rate: 0.01
Batch [0/704] training loss = 0.1027, training acc = 0.98
Batch [200/704] training loss = 0.3056, training acc = 0.94
Batch [400/704] training loss = 0.1979, training acc = 0.91
Batch [600/704] training loss = 0.2842, training acc = 0.91
Valid Test with nat
Test accuracy: 87.42% (4371/5000), Test loss:0.3926
Epoch [12/80], Passed time:[71.691/860.295]
learning rate: 0.01
Batch [0/704] training loss = 0.1076, training acc = 0.97
Batch [200/704] training loss = 0.2407, training acc = 0.91
Batch [400/704] training loss = 0.2936, training acc = 0.89
Batch [600/704] training loss = 0.2145, training acc = 0.91
Valid Test with nat
Test accuracy: 89.20% (4460/5000), Test loss:0.3289
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n80.pth
Test on test set:
Test accuracy: 89.11% (8911/10000), Test loss:0.3355
Epoch [13/80], Passed time:[72.090/937.165]
learning rate: 0.01
Batch [0/704] training loss = 0.1760, training acc = 0.94
Batch [200/704] training loss = 0.3088, training acc = 0.88
Batch [400/704] training loss = 0.1775, training acc = 0.95
Batch [600/704] training loss = 0.2173, training acc = 0.92
Valid Test with nat
Test accuracy: 89.08% (4454/5000), Test loss:0.3537
Epoch [14/80], Passed time:[71.616/1002.620]
learning rate: 0.01
Batch [0/704] training loss = 0.2135, training acc = 0.94
Batch [200/704] training loss = 0.1832, training acc = 0.94
Batch [400/704] training loss = 0.3094, training acc = 0.89
Batch [600/704] training loss = 0.3062, training acc = 0.89
Valid Test with nat
Test accuracy: 88.22% (4411/5000), Test loss:0.3698
Epoch [15/80], Passed time:[71.332/1069.978]
learning rate: 0.01
Batch [0/704] training loss = 0.2354, training acc = 0.92
Batch [200/704] training loss = 0.1832, training acc = 0.94
Batch [400/704] training loss = 0.2622, training acc = 0.91
Batch [600/704] training loss = 0.1850, training acc = 0.94
Valid Test with nat
Test accuracy: 88.20% (4410/5000), Test loss:0.3803
Epoch [16/80], Passed time:[71.257/1140.114]
learning rate: 0.01
Batch [0/704] training loss = 0.1658, training acc = 0.95
Batch [200/704] training loss = 0.2424, training acc = 0.95
Batch [400/704] training loss = 0.1659, training acc = 0.91
Batch [600/704] training loss = 0.4530, training acc = 0.84
Valid Test with nat
Test accuracy: 88.48% (4424/5000), Test loss:0.3723
Epoch [17/80], Passed time:[71.414/1214.030]
learning rate: 0.01
Batch [0/704] training loss = 0.0560, training acc = 0.98
Batch [200/704] training loss = 0.1029, training acc = 0.97
Batch [400/704] training loss = 0.1981, training acc = 0.88
Batch [600/704] training loss = 0.3493, training acc = 0.91
Valid Test with nat
Test accuracy: 89.20% (4460/5000), Test loss:0.3559
Epoch [18/80], Passed time:[71.227/1282.089]
learning rate: 0.01
Batch [0/704] training loss = 0.1494, training acc = 0.94
Batch [200/704] training loss = 0.1239, training acc = 0.94
Batch [400/704] training loss = 0.0539, training acc = 0.98
Batch [600/704] training loss = 0.1445, training acc = 0.95
Valid Test with nat
Test accuracy: 89.06% (4453/5000), Test loss:0.3663
Epoch [19/80], Passed time:[71.303/1354.760]
learning rate: 0.01
Batch [0/704] training loss = 0.1213, training acc = 0.94
Batch [200/704] training loss = 0.1320, training acc = 0.92
Batch [400/704] training loss = 0.1761, training acc = 0.92
Batch [600/704] training loss = 0.1486, training acc = 0.97
Valid Test with nat
Test accuracy: 89.28% (4464/5000), Test loss:0.3735
Epoch [20/80], Passed time:[71.488/1429.752]
learning rate: 0.01
Batch [0/704] training loss = 0.1066, training acc = 0.98
Batch [200/704] training loss = 0.0933, training acc = 0.97
Batch [400/704] training loss = 0.0469, training acc = 1.00
Batch [600/704] training loss = 0.1612, training acc = 0.95
Valid Test with nat
Test accuracy: 89.92% (4496/5000), Test loss:0.3368
Epoch [21/80], Passed time:[71.227/1495.776]
learning rate: 0.01
Batch [0/704] training loss = 0.2780, training acc = 0.91
Batch [200/704] training loss = 0.1267, training acc = 0.95
Batch [400/704] training loss = 0.0466, training acc = 1.00
Batch [600/704] training loss = 0.0842, training acc = 0.97
Valid Test with nat
Test accuracy: 90.50% (4525/5000), Test loss:0.3262
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n80.pth
Test on test set:
Test accuracy: 90.04% (9004/10000), Test loss:0.3315
Epoch [22/80], Passed time:[71.267/1567.882]
learning rate: 0.01
Batch [0/704] training loss = 0.0506, training acc = 1.00
Batch [200/704] training loss = 0.1715, training acc = 0.95
Batch [400/704] training loss = 0.2843, training acc = 0.88
Batch [600/704] training loss = 0.2235, training acc = 0.95
Valid Test with nat
Test accuracy: 89.00% (4450/5000), Test loss:0.3880
Epoch [23/80], Passed time:[71.208/1637.785]
learning rate: 0.01
Batch [0/704] training loss = 0.2146, training acc = 0.92
Batch [200/704] training loss = 0.1573, training acc = 0.97
Batch [400/704] training loss = 0.1221, training acc = 0.95
Batch [600/704] training loss = 0.1430, training acc = 0.97
Valid Test with nat
Test accuracy: 89.94% (4497/5000), Test loss:0.3407
Epoch [24/80], Passed time:[71.244/1709.859]
learning rate: 0.01
Batch [0/704] training loss = 0.1092, training acc = 0.97
Batch [200/704] training loss = 0.1363, training acc = 0.92
Batch [400/704] training loss = 0.0721, training acc = 0.98
Batch [600/704] training loss = 0.1304, training acc = 0.97
Valid Test with nat
Test accuracy: 90.14% (4507/5000), Test loss:0.3612
Epoch [25/80], Passed time:[71.158/1778.940]
learning rate: 0.01
Batch [0/704] training loss = 0.1482, training acc = 0.94
Batch [200/704] training loss = 0.0945, training acc = 0.95
Batch [400/704] training loss = 0.2008, training acc = 0.92
Batch [600/704] training loss = 0.0891, training acc = 0.97
Valid Test with nat
Test accuracy: 89.34% (4467/5000), Test loss:0.3603
Epoch [26/80], Passed time:[71.116/1849.019]
learning rate: 0.01
Batch [0/704] training loss = 0.1398, training acc = 0.95
Batch [200/704] training loss = 0.1327, training acc = 0.97
Batch [400/704] training loss = 0.0912, training acc = 0.97
Batch [600/704] training loss = 0.0523, training acc = 0.97
Valid Test with nat
Test accuracy: 89.20% (4460/5000), Test loss:0.3742
Epoch [27/80], Passed time:[71.190/1922.126]
learning rate: 0.01
Batch [0/704] training loss = 0.2151, training acc = 0.95
Batch [200/704] training loss = 0.1646, training acc = 0.95
Batch [400/704] training loss = 0.1249, training acc = 0.97
Batch [600/704] training loss = 0.1720, training acc = 0.95
Valid Test with nat
Test accuracy: 89.46% (4473/5000), Test loss:0.3545
Epoch [28/80], Passed time:[71.264/1995.394]
learning rate: 0.01
Batch [0/704] training loss = 0.0981, training acc = 0.97
Batch [200/704] training loss = 0.0706, training acc = 0.97
Batch [400/704] training loss = 0.1137, training acc = 0.94
Batch [600/704] training loss = 0.0326, training acc = 1.00
Valid Test with nat
Test accuracy: 89.42% (4471/5000), Test loss:0.3512
Epoch [29/80], Passed time:[71.172/2063.991]
learning rate: 0.01
Batch [0/704] training loss = 0.0959, training acc = 0.95
Batch [200/704] training loss = 0.1501, training acc = 0.95
Batch [400/704] training loss = 0.1142, training acc = 0.97
Batch [600/704] training loss = 0.0844, training acc = 0.97
Valid Test with nat
Test accuracy: 90.64% (4532/5000), Test loss:0.3273
Epoch [30/80], Passed time:[71.180/2135.413]
learning rate: 0.01
Batch [0/704] training loss = 0.1261, training acc = 0.94
Batch [200/704] training loss = 0.0314, training acc = 0.98
Batch [400/704] training loss = 0.1086, training acc = 0.95
Batch [600/704] training loss = 0.1734, training acc = 0.95
Valid Test with nat
Test accuracy: 90.16% (4508/5000), Test loss:0.3572
Epoch [31/80], Passed time:[71.131/2205.055]
learning rate: 0.01
Batch [0/704] training loss = 0.1071, training acc = 0.97
Batch [200/704] training loss = 0.1851, training acc = 0.88
Batch [400/704] training loss = 0.1522, training acc = 0.95
Batch [600/704] training loss = 0.2132, training acc = 0.95
Valid Test with nat
Test accuracy: 89.86% (4493/5000), Test loss:0.3536
Epoch [32/80], Passed time:[70.728/2263.296]
learning rate: 0.01
Batch [0/704] training loss = 0.0850, training acc = 0.98
Batch [200/704] training loss = 0.0261, training acc = 1.00
Batch [400/704] training loss = 0.2434, training acc = 0.92
Batch [600/704] training loss = 0.1800, training acc = 0.94
Valid Test with nat
Test accuracy: 89.68% (4484/5000), Test loss:0.3722
Epoch [33/80], Passed time:[70.470/2325.494]
learning rate: 0.01
Batch [0/704] training loss = 0.0576, training acc = 0.97
Batch [200/704] training loss = 0.1545, training acc = 0.97
Batch [400/704] training loss = 0.0421, training acc = 0.98
Batch [600/704] training loss = 0.0229, training acc = 1.00
Valid Test with nat
Test accuracy: 89.10% (4455/5000), Test loss:0.4189
Epoch [34/80], Passed time:[70.361/2392.278]
learning rate: 0.01
Batch [0/704] training loss = 0.0811, training acc = 0.97
Batch [200/704] training loss = 0.1370, training acc = 0.95
Batch [400/704] training loss = 0.0300, training acc = 1.00
Batch [600/704] training loss = 0.1124, training acc = 0.98
Valid Test with nat
Test accuracy: 89.40% (4470/5000), Test loss:0.3903
Epoch [35/80], Passed time:[70.302/2460.556]
learning rate: 0.01
Batch [0/704] training loss = 0.0740, training acc = 0.97
Batch [200/704] training loss = 0.0712, training acc = 0.98
Batch [400/704] training loss = 0.1838, training acc = 0.94
Batch [600/704] training loss = 0.0705, training acc = 0.97
Valid Test with nat
Test accuracy: 90.24% (4512/5000), Test loss:0.3499
Epoch [36/80], Passed time:[70.276/2529.952]
learning rate: 0.01
Batch [0/704] training loss = 0.1061, training acc = 0.98
Batch [200/704] training loss = 0.0352, training acc = 0.98
Batch [400/704] training loss = 0.2260, training acc = 0.94
Batch [600/704] training loss = 0.0346, training acc = 1.00
Valid Test with nat
Test accuracy: 89.28% (4464/5000), Test loss:0.3779
Epoch [37/80], Passed time:[70.309/2601.446]
learning rate: 0.01
Batch [0/704] training loss = 0.0976, training acc = 0.98
Batch [200/704] training loss = 0.0393, training acc = 0.98
Batch [400/704] training loss = 0.1260, training acc = 0.95
Batch [600/704] training loss = 0.0239, training acc = 0.98
Valid Test with nat
Test accuracy: 90.32% (4516/5000), Test loss:0.3473
Epoch [38/80], Passed time:[70.315/2671.962]
learning rate: 0.01
Batch [0/704] training loss = 0.1359, training acc = 0.94
Batch [200/704] training loss = 0.0569, training acc = 0.97
Batch [400/704] training loss = 0.1147, training acc = 0.92
Batch [600/704] training loss = 0.0765, training acc = 0.97
Valid Test with nat
Test accuracy: 90.00% (4500/5000), Test loss:0.3675
Epoch [39/80], Passed time:[70.232/2739.035]
learning rate: 0.01
Batch [0/704] training loss = 0.1117, training acc = 0.98
Batch [200/704] training loss = 0.0996, training acc = 0.95
Batch [400/704] training loss = 0.1470, training acc = 0.95
Batch [600/704] training loss = 0.1013, training acc = 0.98
Valid Test with nat
Test accuracy: 90.62% (4531/5000), Test loss:0.3493
Epoch [40/80], Passed time:[70.356/2814.231]
learning rate: 0.001
Batch [0/704] training loss = 0.1042, training acc = 0.97
Batch [200/704] training loss = 0.1431, training acc = 0.94
Batch [400/704] training loss = 0.0488, training acc = 0.97
Batch [600/704] training loss = 0.0351, training acc = 0.98
Valid Test with nat
Test accuracy: 91.48% (4574/5000), Test loss:0.3048
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n80.pth
Test on test set:
Test accuracy: 91.32% (9132/10000), Test loss:0.3101
Epoch [41/80], Passed time:[70.489/2890.055]
learning rate: 0.001
Batch [0/704] training loss = 0.0450, training acc = 0.98
Batch [200/704] training loss = 0.0264, training acc = 0.98
Batch [400/704] training loss = 0.0771, training acc = 0.98
Batch [600/704] training loss = 0.0562, training acc = 0.98
Valid Test with nat
Test accuracy: 91.62% (4581/5000), Test loss:0.2953
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n80.pth
Test on test set:
Test accuracy: 91.25% (9125/10000), Test loss:0.3089
Epoch [42/80], Passed time:[70.539/2962.639]
learning rate: 0.001
Batch [0/704] training loss = 0.0100, training acc = 1.00
Batch [200/704] training loss = 0.0409, training acc = 0.98
Batch [400/704] training loss = 0.0229, training acc = 1.00
Batch [600/704] training loss = 0.0198, training acc = 1.00
Valid Test with nat
Test accuracy: 91.74% (4587/5000), Test loss:0.3005
Epoch [43/80], Passed time:[70.531/3032.840]
learning rate: 0.001
Batch [0/704] training loss = 0.0093, training acc = 1.00
Batch [200/704] training loss = 0.0817, training acc = 0.97
Batch [400/704] training loss = 0.1154, training acc = 0.95
Batch [600/704] training loss = 0.0635, training acc = 0.97
Valid Test with nat
Test accuracy: 92.00% (4600/5000), Test loss:0.3027
Epoch [44/80], Passed time:[70.614/3107.027]
learning rate: 0.001
Batch [0/704] training loss = 0.0686, training acc = 0.98
Batch [200/704] training loss = 0.0364, training acc = 0.98
Batch [400/704] training loss = 0.0067, training acc = 1.00
Batch [600/704] training loss = 0.1315, training acc = 0.97
Valid Test with nat
Test accuracy: 91.94% (4597/5000), Test loss:0.2964
Epoch [45/80], Passed time:[70.574/3175.844]
learning rate: 0.001
Batch [0/704] training loss = 0.0453, training acc = 0.97
Batch [200/704] training loss = 0.0113, training acc = 1.00
Batch [400/704] training loss = 0.0365, training acc = 0.98
Batch [600/704] training loss = 0.1060, training acc = 0.97
Valid Test with nat
Test accuracy: 91.62% (4581/5000), Test loss:0.3049
Epoch [46/80], Passed time:[70.520/3243.936]
learning rate: 0.001
Batch [0/704] training loss = 0.0361, training acc = 0.97
Batch [200/704] training loss = 0.0137, training acc = 1.00
Batch [400/704] training loss = 0.0117, training acc = 1.00
Batch [600/704] training loss = 0.0882, training acc = 0.94
Valid Test with nat
Test accuracy: 91.54% (4577/5000), Test loss:0.3148
Epoch [47/80], Passed time:[70.541/3315.425]
learning rate: 0.001
Batch [0/704] training loss = 0.0050, training acc = 1.00
Batch [200/704] training loss = 0.0083, training acc = 1.00
Batch [400/704] training loss = 0.0537, training acc = 0.97
Batch [600/704] training loss = 0.0218, training acc = 0.98
Valid Test with nat
Test accuracy: 91.64% (4582/5000), Test loss:0.3133
Epoch [48/80], Passed time:[70.587/3388.179]
learning rate: 0.001
Batch [0/704] training loss = 0.0649, training acc = 0.98
Batch [200/704] training loss = 0.0808, training acc = 0.98
Batch [400/704] training loss = 0.0514, training acc = 0.97
Batch [600/704] training loss = 0.0312, training acc = 0.98
Valid Test with nat
Test accuracy: 91.72% (4586/5000), Test loss:0.3132
Epoch [49/80], Passed time:[70.559/3457.409]
learning rate: 0.001
Batch [0/704] training loss = 0.0152, training acc = 1.00
Batch [200/704] training loss = 0.0076, training acc = 1.00
Batch [400/704] training loss = 0.0430, training acc = 0.98
Batch [600/704] training loss = 0.0318, training acc = 0.98
Valid Test with nat
Test accuracy: 91.84% (4592/5000), Test loss:0.3144
Epoch [50/80], Passed time:[70.535/3526.758]
learning rate: 0.001
Batch [0/704] training loss = 0.0277, training acc = 1.00
Batch [200/704] training loss = 0.0200, training acc = 1.00
Batch [400/704] training loss = 0.0265, training acc = 1.00
Batch [600/704] training loss = 0.0085, training acc = 1.00
Valid Test with nat
Test accuracy: 91.76% (4588/5000), Test loss:0.3084
Epoch [51/80], Passed time:[70.526/3596.809]
learning rate: 0.001
Batch [0/704] training loss = 0.0902, training acc = 0.97
Batch [200/704] training loss = 0.0195, training acc = 1.00
Batch [400/704] training loss = 0.0229, training acc = 0.98
Batch [600/704] training loss = 0.0202, training acc = 1.00
Valid Test with nat
Test accuracy: 91.62% (4581/5000), Test loss:0.3088
Epoch [52/80], Passed time:[70.493/3665.648]
learning rate: 0.001
Batch [0/704] training loss = 0.0384, training acc = 0.98
Batch [200/704] training loss = 0.0038, training acc = 1.00
Batch [400/704] training loss = 0.0974, training acc = 0.98
Batch [600/704] training loss = 0.0029, training acc = 1.00
Valid Test with nat
Test accuracy: 91.86% (4593/5000), Test loss:0.3076
Epoch [53/80], Passed time:[70.506/3736.801]
learning rate: 0.001
Batch [0/704] training loss = 0.0263, training acc = 1.00
Batch [200/704] training loss = 0.0089, training acc = 1.00
Batch [400/704] training loss = 0.0165, training acc = 1.00
Batch [600/704] training loss = 0.0973, training acc = 0.98
Valid Test with nat
Test accuracy: 91.88% (4594/5000), Test loss:0.3061
Epoch [54/80], Passed time:[70.555/3809.958]
learning rate: 0.001
Batch [0/704] training loss = 0.0436, training acc = 0.98
Batch [200/704] training loss = 0.0190, training acc = 1.00
Batch [400/704] training loss = 0.0427, training acc = 0.98
Batch [600/704] training loss = 0.0018, training acc = 1.00
Valid Test with nat
Test accuracy: 91.90% (4595/5000), Test loss:0.3077
Epoch [55/80], Passed time:[70.691/3888.012]
learning rate: 0.001
Batch [0/704] training loss = 0.0102, training acc = 1.00
Batch [200/704] training loss = 0.0163, training acc = 1.00
Batch [400/704] training loss = 0.0046, training acc = 1.00
Batch [600/704] training loss = 0.0029, training acc = 1.00
Valid Test with nat
Test accuracy: 91.70% (4585/5000), Test loss:0.3187
Epoch [56/80], Passed time:[70.700/3959.214]
learning rate: 0.001
Batch [0/704] training loss = 0.0139, training acc = 1.00
Batch [200/704] training loss = 0.0040, training acc = 1.00
Batch [400/704] training loss = 0.0456, training acc = 0.98
Batch [600/704] training loss = 0.0227, training acc = 1.00
Valid Test with nat
Test accuracy: 91.82% (4591/5000), Test loss:0.3315
Epoch [57/80], Passed time:[70.699/4029.820]
learning rate: 0.001
Batch [0/704] training loss = 0.0145, training acc = 1.00
Batch [200/704] training loss = 0.0642, training acc = 0.97
Batch [400/704] training loss = 0.0817, training acc = 0.95
Batch [600/704] training loss = 0.0207, training acc = 0.98
Valid Test with nat
Test accuracy: 91.82% (4591/5000), Test loss:0.3159
Epoch [58/80], Passed time:[70.774/4104.870]
learning rate: 0.001
Batch [0/704] training loss = 0.0178, training acc = 0.98
Batch [200/704] training loss = 0.0078, training acc = 1.00
Batch [400/704] training loss = 0.0112, training acc = 1.00
Batch [600/704] training loss = 0.0123, training acc = 1.00
Valid Test with nat
Test accuracy: 91.78% (4589/5000), Test loss:0.3247
Epoch [59/80], Passed time:[70.742/4173.800]
learning rate: 0.001
Batch [0/704] training loss = 0.0135, training acc = 1.00
Batch [200/704] training loss = 0.0319, training acc = 0.98
Batch [400/704] training loss = 0.0244, training acc = 1.00
Batch [600/704] training loss = 0.0173, training acc = 1.00
Valid Test with nat
Test accuracy: 92.10% (4605/5000), Test loss:0.3192
Epoch [60/80], Passed time:[70.780/4246.809]
learning rate: 0.0001
Batch [0/704] training loss = 0.0099, training acc = 1.00
Batch [200/704] training loss = 0.0186, training acc = 0.98
Batch [400/704] training loss = 0.0330, training acc = 0.98
Batch [600/704] training loss = 0.0028, training acc = 1.00
Valid Test with nat
Test accuracy: 92.22% (4611/5000), Test loss:0.3238
Epoch [61/80], Passed time:[70.754/4315.981]
learning rate: 0.0001
Batch [0/704] training loss = 0.0029, training acc = 1.00
Batch [200/704] training loss = 0.0148, training acc = 1.00
Batch [400/704] training loss = 0.0224, training acc = 1.00
Batch [600/704] training loss = 0.0449, training acc = 0.97
Valid Test with nat
Test accuracy: 92.10% (4605/5000), Test loss:0.3305
Epoch [62/80], Passed time:[70.787/4388.799]
learning rate: 0.0001
Batch [0/704] training loss = 0.0442, training acc = 0.98
Batch [200/704] training loss = 0.0085, training acc = 1.00
Batch [400/704] training loss = 0.0125, training acc = 1.00
Batch [600/704] training loss = 0.1094, training acc = 0.97
Valid Test with nat
Test accuracy: 92.14% (4607/5000), Test loss:0.3151
Epoch [63/80], Passed time:[70.817/4461.453]
learning rate: 0.0001
Batch [0/704] training loss = 0.0207, training acc = 1.00
Batch [200/704] training loss = 0.0174, training acc = 1.00
Batch [400/704] training loss = 0.0238, training acc = 0.98
Batch [600/704] training loss = 0.0178, training acc = 0.98
Valid Test with nat
Test accuracy: 91.86% (4593/5000), Test loss:0.3178
Epoch [64/80], Passed time:[70.825/4532.806]
learning rate: 0.0001
Batch [0/704] training loss = 0.0075, training acc = 1.00
Batch [200/704] training loss = 0.0101, training acc = 1.00
Batch [400/704] training loss = 0.0370, training acc = 0.98
Batch [600/704] training loss = 0.0175, training acc = 1.00
Valid Test with nat
Test accuracy: 92.12% (4606/5000), Test loss:0.3200
Epoch [65/80], Passed time:[70.792/4601.468]
learning rate: 0.0001
Batch [0/704] training loss = 0.0394, training acc = 0.98
Batch [200/704] training loss = 0.0374, training acc = 0.97
Batch [400/704] training loss = 0.0318, training acc = 0.98
Batch [600/704] training loss = 0.0105, training acc = 1.00
Valid Test with nat
Test accuracy: 92.20% (4610/5000), Test loss:0.3250
Epoch [66/80], Passed time:[70.637/4662.037]
learning rate: 0.0001
Batch [0/704] training loss = 0.0292, training acc = 0.98
Batch [200/704] training loss = 0.0546, training acc = 0.98
Batch [400/704] training loss = 0.0634, training acc = 0.97
Batch [600/704] training loss = 0.0407, training acc = 0.98
Valid Test with nat
Test accuracy: 92.38% (4619/5000), Test loss:0.3059
Epoch [67/80], Passed time:[70.446/4719.911]
learning rate: 0.0001
Batch [0/704] training loss = 0.0181, training acc = 1.00
Batch [200/704] training loss = 0.0142, training acc = 1.00
Batch [400/704] training loss = 0.0038, training acc = 1.00
Batch [600/704] training loss = 0.0051, training acc = 1.00
Valid Test with nat
Test accuracy: 92.22% (4611/5000), Test loss:0.3188
Epoch [68/80], Passed time:[70.322/4781.887]
learning rate: 0.0001
Batch [0/704] training loss = 0.0055, training acc = 1.00
Batch [200/704] training loss = 0.0072, training acc = 1.00
Batch [400/704] training loss = 0.0326, training acc = 0.98
Batch [600/704] training loss = 0.0472, training acc = 0.97
Valid Test with nat
Test accuracy: 92.10% (4605/5000), Test loss:0.3149
Epoch [69/80], Passed time:[70.242/4846.712]
learning rate: 0.0001
Batch [0/704] training loss = 0.0050, training acc = 1.00
Batch [200/704] training loss = 0.0186, training acc = 1.00
Batch [400/704] training loss = 0.0102, training acc = 1.00
Batch [600/704] training loss = 0.0067, training acc = 1.00
Valid Test with nat
Test accuracy: 92.00% (4600/5000), Test loss:0.3129
Epoch [70/80], Passed time:[70.298/4920.885]
learning rate: 0.0001
Batch [0/704] training loss = 0.0127, training acc = 1.00
Batch [200/704] training loss = 0.0877, training acc = 0.97
Batch [400/704] training loss = 0.0248, training acc = 1.00
Batch [600/704] training loss = 0.0362, training acc = 0.98
Valid Test with nat
Test accuracy: 92.38% (4619/5000), Test loss:0.3140
Epoch [71/80], Passed time:[70.396/4998.086]
learning rate: 0.0001
Batch [0/704] training loss = 0.0045, training acc = 1.00
Batch [200/704] training loss = 0.0617, training acc = 0.98
Batch [400/704] training loss = 0.0484, training acc = 0.98
Batch [600/704] training loss = 0.0280, training acc = 0.98
Valid Test with nat
Test accuracy: 91.98% (4599/5000), Test loss:0.3181
Epoch [72/80], Passed time:[70.355/5065.563]
learning rate: 0.0001
Batch [0/704] training loss = 0.0255, training acc = 0.98
Batch [200/704] training loss = 0.0235, training acc = 0.98
Batch [400/704] training loss = 0.0668, training acc = 0.98
Batch [600/704] training loss = 0.0309, training acc = 0.98
Valid Test with nat
Test accuracy: 92.16% (4608/5000), Test loss:0.3234
Epoch [73/80], Passed time:[70.412/5140.054]
learning rate: 0.0001
Batch [0/704] training loss = 0.1079, training acc = 0.97
Batch [200/704] training loss = 0.0281, training acc = 0.98
Batch [400/704] training loss = 0.0434, training acc = 0.97
Batch [600/704] training loss = 0.0100, training acc = 1.00
Valid Test with nat
Test accuracy: 92.10% (4605/5000), Test loss:0.3127
Epoch [74/80], Passed time:[70.383/5208.314]
learning rate: 0.0001
Batch [0/704] training loss = 0.0080, training acc = 1.00
Batch [200/704] training loss = 0.0089, training acc = 1.00
Batch [400/704] training loss = 0.0194, training acc = 0.98
Batch [600/704] training loss = 0.0388, training acc = 0.97
Valid Test with nat
Test accuracy: 92.12% (4606/5000), Test loss:0.3172
Epoch [75/80], Passed time:[70.407/5280.500]
learning rate: 0.0001
Batch [0/704] training loss = 0.0206, training acc = 1.00
Batch [200/704] training loss = 0.0382, training acc = 0.98
Batch [400/704] training loss = 0.0043, training acc = 1.00
Batch [600/704] training loss = 0.0246, training acc = 1.00
Valid Test with nat
Test accuracy: 92.10% (4605/5000), Test loss:0.3109
Epoch [76/80], Passed time:[70.435/5353.097]
learning rate: 0.0001
Batch [0/704] training loss = 0.0206, training acc = 1.00
Batch [200/704] training loss = 0.0181, training acc = 0.98
Batch [400/704] training loss = 0.0348, training acc = 0.98
Batch [600/704] training loss = 0.0025, training acc = 1.00
Valid Test with nat
Test accuracy: 92.12% (4606/5000), Test loss:0.3141
Epoch [77/80], Passed time:[70.432/5423.249]
learning rate: 0.0001
Batch [0/704] training loss = 0.0053, training acc = 1.00
Batch [200/704] training loss = 0.0143, training acc = 0.98
Batch [400/704] training loss = 0.0302, training acc = 0.98
Batch [600/704] training loss = 0.0268, training acc = 0.98
Valid Test with nat
Test accuracy: 91.88% (4594/5000), Test loss:0.3139
Epoch [78/80], Passed time:[70.443/5494.582]
learning rate: 0.0001
Batch [0/704] training loss = 0.0197, training acc = 1.00
Batch [200/704] training loss = 0.0102, training acc = 1.00
Batch [400/704] training loss = 0.0037, training acc = 1.00
Batch [600/704] training loss = 0.0138, training acc = 1.00
Valid Test with nat
Test accuracy: 92.14% (4607/5000), Test loss:0.3106
Epoch [79/80], Passed time:[70.479/5567.876]
learning rate: 0.0001
Batch [0/704] training loss = 0.0458, training acc = 0.98
Batch [200/704] training loss = 0.0385, training acc = 0.98
Batch [400/704] training loss = 0.0086, training acc = 1.00
Batch [600/704] training loss = 0.0140, training acc = 1.00
Valid Test with nat
Test accuracy: 92.16% (4608/5000), Test loss:0.3126
Training done, model saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n80.pth
Test on test set:
Test accuracy: 91.58% (9158/10000), Test loss:0.3320
