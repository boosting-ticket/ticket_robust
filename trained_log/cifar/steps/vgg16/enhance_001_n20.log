model_type : vgg16
init_type : pure
finetune_method : nat
enhance_method : nat
gpu : 6
model_name : enhance_001_n20
model_width : 8
n_pruning_steps : 1
max_pruning_ratio : 80
train_epochs : 20
enhance_epochs : 20
prune_method : unstructured
dataset : cifar
noise_sd : 1.0
trades_beta : 6.0
seed : 7
warmup : True
create_init : False
init_step : 1400
train_method : nat
early_stop : 50
norm : True
optm : sgd
batch_size : 64
test_batch_size : 100
learning_rate : 0.01
enhance_learning_rate : None
schedule_length : 10
weight_decay : 0.0001
epsilon : 0.03137254901960784
attack_iter : 10
eps_step : 0.00784313725490196
targeted : False
clip_min : 0
clip_max : 1.0
starting_epsilon : 1e-05
interval_weight : 0.1
ft_interval_weight : 50
verbose : 200
resume : 0
model_path : ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n20.pth
last_model_path : ./trained_models_new/
mask_path : ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/pruned_001_mask_r80.npy
mask_name : pruned_001_mask_r80
log_path : ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n20.log
init_path : ./trained_models_new/cifar/vgg16/init/pure_vgg16_init.pth
results_path : None
n_classes : 10
eval : False
init : True
transfer : False
CUDA enabled.
Enhance training config:
Enhance training method: nat
model will be saved in: ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n20.pth
Init model is: ./trained_models_new/cifar/vgg16/init/pure_vgg16_init.pth
Init mask used from: ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/pruned_001_mask_r80.npy
Log will be saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n20.log
Random seed is: 7

model loading from ./trained_models_new/cifar/vgg16/init/pure_vgg16_init.pth
Epoch [0/20]
learning rate: 0.001
Batch [0/704] training loss = 2.2368, training acc = 0.27
Batch [200/704] training loss = 1.5914, training acc = 0.45
Batch [400/704] training loss = 1.2494, training acc = 0.61
Batch [600/704] training loss = 0.7298, training acc = 0.77
Valid Test with nat
Test accuracy: 72.68% (3634/5000), Test loss:0.8164
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n20.pth
Test on test set:
Test accuracy: 72.19% (7219/10000), Test loss:0.8293
Epoch [1/20], Passed time:[79.950/79.950]
learning rate: 0.002
Batch [0/704] training loss = 0.8382, training acc = 0.70
Batch [200/704] training loss = 0.7020, training acc = 0.77
Batch [400/704] training loss = 0.4937, training acc = 0.83
Batch [600/704] training loss = 0.6214, training acc = 0.75
Valid Test with nat
Test accuracy: 82.66% (4133/5000), Test loss:0.5384
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n20.pth
Test on test set:
Test accuracy: 81.77% (8177/10000), Test loss:0.5503
Epoch [2/20], Passed time:[82.979/165.957]
learning rate: 0.0030000000000000005
Batch [0/704] training loss = 0.4358, training acc = 0.84
Batch [200/704] training loss = 0.4901, training acc = 0.84
Batch [400/704] training loss = 0.5478, training acc = 0.77
Batch [600/704] training loss = 0.4958, training acc = 0.81
Valid Test with nat
Test accuracy: 84.06% (4203/5000), Test loss:0.4786
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n20.pth
Test on test set:
Test accuracy: 83.52% (8352/10000), Test loss:0.4991
Epoch [3/20], Passed time:[81.979/245.938]
learning rate: 0.004
Batch [0/704] training loss = 0.2760, training acc = 0.92
Batch [200/704] training loss = 0.4717, training acc = 0.86
Batch [400/704] training loss = 0.4337, training acc = 0.80
Batch [600/704] training loss = 0.5494, training acc = 0.81
Valid Test with nat
Test accuracy: 84.52% (4226/5000), Test loss:0.4593
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n20.pth
Test on test set:
Test accuracy: 84.93% (8493/10000), Test loss:0.4419
Epoch [4/20], Passed time:[83.127/332.508]
learning rate: 0.005
Batch [0/704] training loss = 0.4170, training acc = 0.84
Batch [200/704] training loss = 0.2754, training acc = 0.91
Batch [400/704] training loss = 0.5937, training acc = 0.83
Batch [600/704] training loss = 0.6782, training acc = 0.77
Valid Test with nat
Test accuracy: 81.50% (4075/5000), Test loss:0.5606
Epoch [5/20], Passed time:[84.496/422.482]
learning rate: 0.006000000000000001
Batch [0/704] training loss = 0.5726, training acc = 0.80
Batch [200/704] training loss = 0.1702, training acc = 0.95
Batch [400/704] training loss = 0.4217, training acc = 0.84
Batch [600/704] training loss = 0.3065, training acc = 0.89
Valid Test with nat
Test accuracy: 86.32% (4316/5000), Test loss:0.4167
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n20.pth
Test on test set:
Test accuracy: 85.56% (8556/10000), Test loss:0.4414
Epoch [6/20], Passed time:[88.567/531.399]
learning rate: 0.007000000000000001
Batch [0/704] training loss = 0.3151, training acc = 0.86
Batch [200/704] training loss = 0.2760, training acc = 0.92
Batch [400/704] training loss = 0.3939, training acc = 0.81
Batch [600/704] training loss = 0.2079, training acc = 0.94
Valid Test with nat
Test accuracy: 87.12% (4356/5000), Test loss:0.3914
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n20.pth
Test on test set:
Test accuracy: 86.84% (8684/10000), Test loss:0.4102
Epoch [7/20], Passed time:[91.494/640.461]
learning rate: 0.008
Batch [0/704] training loss = 0.2993, training acc = 0.88
Batch [200/704] training loss = 0.2874, training acc = 0.89
Batch [400/704] training loss = 0.1862, training acc = 0.95
Batch [600/704] training loss = 0.3439, training acc = 0.86
Valid Test with nat
Test accuracy: 85.46% (4273/5000), Test loss:0.4198
Epoch [8/20], Passed time:[91.137/729.094]
learning rate: 0.009000000000000001
Batch [0/704] training loss = 0.5147, training acc = 0.86
Batch [200/704] training loss = 0.3721, training acc = 0.83
Batch [400/704] training loss = 0.2848, training acc = 0.88
Batch [600/704] training loss = 0.2025, training acc = 0.89
Valid Test with nat
Test accuracy: 87.52% (4376/5000), Test loss:0.3907
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n20.pth
Test on test set:
Test accuracy: 86.94% (8694/10000), Test loss:0.3984
Epoch [9/20], Passed time:[92.340/831.062]
learning rate: 0.01
Batch [0/704] training loss = 0.3455, training acc = 0.89
Batch [200/704] training loss = 0.2586, training acc = 0.88
Batch [400/704] training loss = 0.2676, training acc = 0.91
Batch [600/704] training loss = 0.3494, training acc = 0.88
Valid Test with nat
Test accuracy: 87.48% (4374/5000), Test loss:0.3871
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n20.pth
Test on test set:
Test accuracy: 87.00% (8700/10000), Test loss:0.4115
Epoch [10/20], Passed time:[92.435/924.353]
learning rate: 0.001
Batch [0/704] training loss = 0.1978, training acc = 0.94
Batch [200/704] training loss = 0.1721, training acc = 0.94
Batch [400/704] training loss = 0.0757, training acc = 0.98
Batch [600/704] training loss = 0.2157, training acc = 0.92
Valid Test with nat
Test accuracy: 90.72% (4536/5000), Test loss:0.2926
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n20.pth
Test on test set:
Test accuracy: 89.88% (8988/10000), Test loss:0.3129
Epoch [11/20], Passed time:[93.197/1025.171]
learning rate: 0.001
Batch [0/704] training loss = 0.1158, training acc = 0.95
Batch [200/704] training loss = 0.2658, training acc = 0.94
Batch [400/704] training loss = 0.1771, training acc = 0.91
Batch [600/704] training loss = 0.0929, training acc = 0.97
Valid Test with nat
Test accuracy: 91.04% (4552/5000), Test loss:0.2821
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n20.pth
Test on test set:
Test accuracy: 90.30% (9030/10000), Test loss:0.3034
Epoch [12/20], Passed time:[93.639/1123.665]
learning rate: 0.001
Batch [0/704] training loss = 0.2292, training acc = 0.91
Batch [200/704] training loss = 0.0918, training acc = 0.95
Batch [400/704] training loss = 0.1417, training acc = 0.94
Batch [600/704] training loss = 0.1238, training acc = 0.92
Valid Test with nat
Test accuracy: 91.14% (4557/5000), Test loss:0.2819
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n20.pth
Test on test set:
Test accuracy: 90.47% (9047/10000), Test loss:0.3043
Epoch [13/20], Passed time:[94.084/1223.092]
learning rate: 0.001
Batch [0/704] training loss = 0.0739, training acc = 0.98
Batch [200/704] training loss = 0.1376, training acc = 0.95
Batch [400/704] training loss = 0.1706, training acc = 0.92
Batch [600/704] training loss = 0.1437, training acc = 0.92
Valid Test with nat
Test accuracy: 91.48% (4574/5000), Test loss:0.2752
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n20.pth
Test on test set:
Test accuracy: 90.42% (9042/10000), Test loss:0.3039
Epoch [14/20], Passed time:[94.694/1325.716]
learning rate: 0.001
Batch [0/704] training loss = 0.0659, training acc = 0.98
Batch [200/704] training loss = 0.0857, training acc = 0.97
Batch [400/704] training loss = 0.0639, training acc = 1.00
Batch [600/704] training loss = 0.0675, training acc = 0.97
Valid Test with nat
Test accuracy: 91.08% (4554/5000), Test loss:0.2891
Epoch [15/20], Passed time:[94.395/1415.925]
learning rate: 0.0001
Batch [0/704] training loss = 0.0526, training acc = 0.98
Batch [200/704] training loss = 0.0886, training acc = 0.98
Batch [400/704] training loss = 0.1853, training acc = 0.94
Batch [600/704] training loss = 0.0919, training acc = 0.97
Valid Test with nat
Test accuracy: 91.10% (4555/5000), Test loss:0.2936
Epoch [16/20], Passed time:[94.635/1514.163]
learning rate: 0.0001
Batch [0/704] training loss = 0.0975, training acc = 0.95
Batch [200/704] training loss = 0.0851, training acc = 0.95
Batch [400/704] training loss = 0.3155, training acc = 0.92
Batch [600/704] training loss = 0.0816, training acc = 0.97
Valid Test with nat
Test accuracy: 91.28% (4564/5000), Test loss:0.2788
Epoch [17/20], Passed time:[94.599/1608.176]
learning rate: 0.0001
Batch [0/704] training loss = 0.2031, training acc = 0.94
Batch [200/704] training loss = 0.2315, training acc = 0.91
Batch [400/704] training loss = 0.1105, training acc = 0.95
Batch [600/704] training loss = 0.0590, training acc = 0.98
Valid Test with nat
Test accuracy: 91.40% (4570/5000), Test loss:0.2774
Epoch [18/20], Passed time:[95.223/1714.014]
learning rate: 0.0001
Batch [0/704] training loss = 0.0415, training acc = 1.00
Batch [200/704] training loss = 0.0958, training acc = 0.97
Batch [400/704] training loss = 0.1527, training acc = 0.95
Batch [600/704] training loss = 0.0461, training acc = 0.97
Valid Test with nat
Test accuracy: 91.32% (4566/5000), Test loss:0.2824
Epoch [19/20], Passed time:[95.542/1815.302]
learning rate: 0.0001
Batch [0/704] training loss = 0.1141, training acc = 0.98
Batch [200/704] training loss = 0.1064, training acc = 0.95
Batch [400/704] training loss = 0.2940, training acc = 0.91
Batch [600/704] training loss = 0.1959, training acc = 0.91
Valid Test with nat
Test accuracy: 91.36% (4568/5000), Test loss:0.2791
Training done, model saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n20.pth
Test on test set:
Test accuracy: 90.53% (9053/10000), Test loss:0.3086
