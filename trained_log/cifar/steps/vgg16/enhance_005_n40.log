model_type : vgg16
init_type : pure
finetune_method : nat
enhance_method : nat
gpu : 7
model_name : enhance_005_n40
model_width : 8
n_pruning_steps : 1
max_pruning_ratio : 80
train_epochs : 40
enhance_epochs : 40
prune_method : unstructured
dataset : cifar
noise_sd : 1.0
trades_beta : 6.0
seed : 7
warmup : True
create_init : False
init_step : 1400
train_method : nat
early_stop : 50
norm : True
optm : sgd
batch_size : 64
test_batch_size : 100
learning_rate : 0.01
enhance_learning_rate : None
schedule_length : 10
weight_decay : 0.0001
epsilon : 0.03137254901960784
attack_iter : 10
eps_step : 0.00784313725490196
targeted : False
clip_min : 0
clip_max : 1.0
starting_epsilon : 1e-05
interval_weight : 0.1
ft_interval_weight : 50
verbose : 200
resume : 0
model_path : ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_005_n40.pth
last_model_path : ./trained_models_new/
mask_path : ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/pruned_005_mask_r80.npy
mask_name : pruned_005_mask_r80
log_path : ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_005_n40.log
init_path : ./trained_models_new/cifar/vgg16/init/pure_vgg16_init.pth
results_path : None
n_classes : 10
eval : False
init : True
transfer : False
CUDA enabled.
Enhance training config:
Enhance training method: nat
model will be saved in: ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_005_n40.pth
Init model is: ./trained_models_new/cifar/vgg16/init/pure_vgg16_init.pth
Init mask used from: ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/pruned_005_mask_r80.npy
Log will be saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_005_n40.log
Random seed is: 7

model loading from ./trained_models_new/cifar/vgg16/init/pure_vgg16_init.pth
Epoch [0/40]
learning rate: 0.001
Batch [0/704] training loss = 2.3108, training acc = 0.11
Batch [200/704] training loss = 1.8564, training acc = 0.36
Batch [400/704] training loss = 1.5861, training acc = 0.42
Batch [600/704] training loss = 1.4412, training acc = 0.45
Valid Test with nat
Test accuracy: 47.40% (2370/5000), Test loss:1.4270
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_005_n40.pth
Test on test set:
Test accuracy: 46.24% (4624/10000), Test loss:1.4694
Epoch [1/40], Passed time:[71.015/71.015]
learning rate: 0.002
Batch [0/704] training loss = 1.3877, training acc = 0.48
Batch [200/704] training loss = 1.5228, training acc = 0.42
Batch [400/704] training loss = 1.2692, training acc = 0.58
Batch [600/704] training loss = 1.3931, training acc = 0.47
Valid Test with nat
Test accuracy: 59.28% (2964/5000), Test loss:1.1609
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_005_n40.pth
Test on test set:
Test accuracy: 58.09% (5809/10000), Test loss:1.1954
Epoch [2/40], Passed time:[74.515/149.031]
learning rate: 0.0030000000000000005
Batch [0/704] training loss = 1.2482, training acc = 0.58
Batch [200/704] training loss = 1.1612, training acc = 0.59
Batch [400/704] training loss = 1.0817, training acc = 0.58
Batch [600/704] training loss = 0.9372, training acc = 0.72
Valid Test with nat
Test accuracy: 67.12% (3356/5000), Test loss:0.9510
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_005_n40.pth
Test on test set:
Test accuracy: 66.32% (6632/10000), Test loss:0.9615
Epoch [3/40], Passed time:[76.091/228.272]
learning rate: 0.004
Batch [0/704] training loss = 0.9243, training acc = 0.73
Batch [200/704] training loss = 1.0713, training acc = 0.64
Batch [400/704] training loss = 0.9233, training acc = 0.69
Batch [600/704] training loss = 0.9005, training acc = 0.72
Valid Test with nat
Test accuracy: 71.80% (3590/5000), Test loss:0.8412
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_005_n40.pth
Test on test set:
Test accuracy: 72.30% (7230/10000), Test loss:0.8213
Epoch [4/40], Passed time:[76.440/305.760]
learning rate: 0.005
Batch [0/704] training loss = 0.9749, training acc = 0.66
Batch [200/704] training loss = 0.7782, training acc = 0.72
Batch [400/704] training loss = 0.7358, training acc = 0.73
Batch [600/704] training loss = 0.8397, training acc = 0.72
Valid Test with nat
Test accuracy: 70.48% (3524/5000), Test loss:0.8598
Epoch [5/40], Passed time:[76.501/382.505]
learning rate: 0.006000000000000001
Batch [0/704] training loss = 0.7391, training acc = 0.72
Batch [200/704] training loss = 0.5301, training acc = 0.81
Batch [400/704] training loss = 0.8211, training acc = 0.73
Batch [600/704] training loss = 0.6427, training acc = 0.78
Valid Test with nat
Test accuracy: 75.90% (3795/5000), Test loss:0.7022
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_005_n40.pth
Test on test set:
Test accuracy: 74.85% (7485/10000), Test loss:0.7284
Epoch [6/40], Passed time:[76.916/461.494]
learning rate: 0.007000000000000001
Batch [0/704] training loss = 0.6708, training acc = 0.77
Batch [200/704] training loss = 0.5538, training acc = 0.77
Batch [400/704] training loss = 1.0122, training acc = 0.69
Batch [600/704] training loss = 0.4750, training acc = 0.83
Valid Test with nat
Test accuracy: 77.62% (3881/5000), Test loss:0.6792
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_005_n40.pth
Test on test set:
Test accuracy: 76.22% (7622/10000), Test loss:0.6986
Epoch [7/40], Passed time:[77.112/539.783]
learning rate: 0.008
Batch [0/704] training loss = 0.5385, training acc = 0.81
Batch [200/704] training loss = 0.6129, training acc = 0.78
Batch [400/704] training loss = 0.4812, training acc = 0.81
Batch [600/704] training loss = 0.7595, training acc = 0.78
Valid Test with nat
Test accuracy: 77.20% (3860/5000), Test loss:0.6545
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_005_n40.pth
Test on test set:
Test accuracy: 78.10% (7810/10000), Test loss:0.6517
Epoch [8/40], Passed time:[77.072/616.577]
learning rate: 0.009000000000000001
Batch [0/704] training loss = 0.7153, training acc = 0.77
Batch [200/704] training loss = 0.8012, training acc = 0.72
Batch [400/704] training loss = 0.5175, training acc = 0.84
Batch [600/704] training loss = 0.4373, training acc = 0.88
Valid Test with nat
Test accuracy: 80.76% (4038/5000), Test loss:0.5757
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_005_n40.pth
Test on test set:
Test accuracy: 80.71% (8071/10000), Test loss:0.5564
Epoch [9/40], Passed time:[77.159/694.434]
learning rate: 0.01
Batch [0/704] training loss = 0.3633, training acc = 0.88
Batch [200/704] training loss = 0.6619, training acc = 0.78
Batch [400/704] training loss = 0.4277, training acc = 0.81
Batch [600/704] training loss = 0.4070, training acc = 0.83
Valid Test with nat
Test accuracy: 80.90% (4045/5000), Test loss:0.5618
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_005_n40.pth
Test on test set:
Test accuracy: 82.02% (8202/10000), Test loss:0.5268
Epoch [10/40], Passed time:[76.222/762.216]
learning rate: 0.01
Batch [0/704] training loss = 0.3257, training acc = 0.88
Batch [200/704] training loss = 0.8083, training acc = 0.72
Batch [400/704] training loss = 0.4145, training acc = 0.83
Batch [600/704] training loss = 0.4258, training acc = 0.88
Valid Test with nat
Test accuracy: 78.32% (3916/5000), Test loss:0.6448
Epoch [11/40], Passed time:[75.793/833.720]
learning rate: 0.01
Batch [0/704] training loss = 0.5633, training acc = 0.80
Batch [200/704] training loss = 0.4355, training acc = 0.88
Batch [400/704] training loss = 0.5882, training acc = 0.77
Batch [600/704] training loss = 0.4928, training acc = 0.81
Valid Test with nat
Test accuracy: 83.80% (4190/5000), Test loss:0.5040
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_005_n40.pth
Test on test set:
Test accuracy: 83.68% (8368/10000), Test loss:0.4679
Epoch [12/40], Passed time:[76.247/914.964]
learning rate: 0.01
Batch [0/704] training loss = 0.4888, training acc = 0.83
Batch [200/704] training loss = 0.5305, training acc = 0.80
Batch [400/704] training loss = 0.4469, training acc = 0.83
Batch [600/704] training loss = 0.4850, training acc = 0.83
Valid Test with nat
Test accuracy: 83.66% (4183/5000), Test loss:0.4891
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_005_n40.pth
Test on test set:
Test accuracy: 84.37% (8437/10000), Test loss:0.4758
Epoch [13/40], Passed time:[76.528/994.868]
learning rate: 0.01
Batch [0/704] training loss = 0.4793, training acc = 0.77
Batch [200/704] training loss = 0.4627, training acc = 0.88
Batch [400/704] training loss = 0.4389, training acc = 0.86
Batch [600/704] training loss = 0.6056, training acc = 0.75
Valid Test with nat
Test accuracy: 82.68% (4134/5000), Test loss:0.5355
Epoch [14/40], Passed time:[76.669/1073.364]
learning rate: 0.01
Batch [0/704] training loss = 0.4369, training acc = 0.84
Batch [200/704] training loss = 0.5620, training acc = 0.80
Batch [400/704] training loss = 0.5917, training acc = 0.81
Batch [600/704] training loss = 0.3559, training acc = 0.89
Valid Test with nat
Test accuracy: 83.80% (4190/5000), Test loss:0.4929
Epoch [15/40], Passed time:[76.454/1146.808]
learning rate: 0.01
Batch [0/704] training loss = 0.5860, training acc = 0.83
Batch [200/704] training loss = 0.4240, training acc = 0.86
Batch [400/704] training loss = 0.5082, training acc = 0.83
Batch [600/704] training loss = 0.4158, training acc = 0.86
Valid Test with nat
Test accuracy: 84.80% (4240/5000), Test loss:0.4510
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_005_n40.pth
Test on test set:
Test accuracy: 84.35% (8435/10000), Test loss:0.4530
Epoch [16/40], Passed time:[76.172/1218.750]
learning rate: 0.01
Batch [0/704] training loss = 0.3119, training acc = 0.88
Batch [200/704] training loss = 0.3702, training acc = 0.84
Batch [400/704] training loss = 0.5344, training acc = 0.80
Batch [600/704] training loss = 0.3955, training acc = 0.84
Valid Test with nat
Test accuracy: 84.36% (4218/5000), Test loss:0.4584
Epoch [17/40], Passed time:[76.213/1295.613]
learning rate: 0.01
Batch [0/704] training loss = 0.3188, training acc = 0.88
Batch [200/704] training loss = 0.4402, training acc = 0.88
Batch [400/704] training loss = 0.3787, training acc = 0.86
Batch [600/704] training loss = 0.3124, training acc = 0.89
Valid Test with nat
Test accuracy: 85.26% (4263/5000), Test loss:0.4624
Epoch [18/40], Passed time:[76.236/1372.249]
learning rate: 0.01
Batch [0/704] training loss = 0.3258, training acc = 0.88
Batch [200/704] training loss = 0.1537, training acc = 0.94
Batch [400/704] training loss = 0.4723, training acc = 0.88
Batch [600/704] training loss = 0.2757, training acc = 0.92
Valid Test with nat
Test accuracy: 86.56% (4328/5000), Test loss:0.4035
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_005_n40.pth
Test on test set:
Test accuracy: 86.23% (8623/10000), Test loss:0.4119
Epoch [19/40], Passed time:[76.411/1451.802]
learning rate: 0.01
Batch [0/704] training loss = 0.3205, training acc = 0.89
Batch [200/704] training loss = 0.4216, training acc = 0.84
Batch [400/704] training loss = 0.3304, training acc = 0.88
Batch [600/704] training loss = 0.2166, training acc = 0.91
Valid Test with nat
Test accuracy: 86.56% (4328/5000), Test loss:0.4173
Epoch [20/40], Passed time:[76.239/1524.777]
learning rate: 0.001
Batch [0/704] training loss = 0.3106, training acc = 0.91
Batch [200/704] training loss = 0.3035, training acc = 0.91
Batch [400/704] training loss = 0.1549, training acc = 0.94
Batch [600/704] training loss = 0.2202, training acc = 0.91
Valid Test with nat
Test accuracy: 89.12% (4456/5000), Test loss:0.3465
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_005_n40.pth
Test on test set:
Test accuracy: 88.22% (8822/10000), Test loss:0.3562
Epoch [21/40], Passed time:[76.406/1604.525]
learning rate: 0.001
Batch [0/704] training loss = 0.1599, training acc = 0.95
Batch [200/704] training loss = 0.1370, training acc = 0.98
Batch [400/704] training loss = 0.1227, training acc = 0.97
Batch [600/704] training loss = 0.2883, training acc = 0.89
Valid Test with nat
Test accuracy: 89.24% (4462/5000), Test loss:0.3448
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_005_n40.pth
Test on test set:
Test accuracy: 88.64% (8864/10000), Test loss:0.3431
Epoch [22/40], Passed time:[76.412/1681.053]
learning rate: 0.001
Batch [0/704] training loss = 0.1107, training acc = 0.97
Batch [200/704] training loss = 0.4199, training acc = 0.88
Batch [400/704] training loss = 0.2173, training acc = 0.94
Batch [600/704] training loss = 0.1641, training acc = 0.95
Valid Test with nat
Test accuracy: 89.12% (4456/5000), Test loss:0.3506
Epoch [23/40], Passed time:[76.386/1756.886]
learning rate: 0.001
Batch [0/704] training loss = 0.2372, training acc = 0.91
Batch [200/704] training loss = 0.2469, training acc = 0.92
Batch [400/704] training loss = 0.2786, training acc = 0.91
Batch [600/704] training loss = 0.1831, training acc = 0.94
Valid Test with nat
Test accuracy: 89.56% (4478/5000), Test loss:0.3369
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_005_n40.pth
Test on test set:
Test accuracy: 88.75% (8875/10000), Test loss:0.3393
Epoch [24/40], Passed time:[76.595/1838.286]
learning rate: 0.001
Batch [0/704] training loss = 0.1934, training acc = 0.92
Batch [200/704] training loss = 0.1622, training acc = 0.95
Batch [400/704] training loss = 0.2088, training acc = 0.92
Batch [600/704] training loss = 0.3304, training acc = 0.92
Valid Test with nat
Test accuracy: 89.32% (4466/5000), Test loss:0.3444
Epoch [25/40], Passed time:[76.400/1910.008]
learning rate: 0.001
Batch [0/704] training loss = 0.1577, training acc = 0.94
Batch [200/704] training loss = 0.3158, training acc = 0.91
Batch [400/704] training loss = 0.3097, training acc = 0.91
Batch [600/704] training loss = 0.1387, training acc = 0.92
Valid Test with nat
Test accuracy: 89.66% (4483/5000), Test loss:0.3431
Epoch [26/40], Passed time:[76.353/1985.184]
learning rate: 0.001
Batch [0/704] training loss = 0.1895, training acc = 0.94
Batch [200/704] training loss = 0.3015, training acc = 0.89
Batch [400/704] training loss = 0.2178, training acc = 0.94
Batch [600/704] training loss = 0.6007, training acc = 0.83
Valid Test with nat
Test accuracy: 89.48% (4474/5000), Test loss:0.3340
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_005_n40.pth
Test on test set:
Test accuracy: 88.52% (8852/10000), Test loss:0.3537
Epoch [27/40], Passed time:[76.399/2062.771]
learning rate: 0.001
Batch [0/704] training loss = 0.3345, training acc = 0.89
Batch [200/704] training loss = 0.1542, training acc = 0.97
Batch [400/704] training loss = 0.2938, training acc = 0.92
Batch [600/704] training loss = 0.1633, training acc = 0.95
Valid Test with nat
Test accuracy: 90.04% (4502/5000), Test loss:0.3320
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_005_n40.pth
Test on test set:
Test accuracy: 88.70% (8870/10000), Test loss:0.3398
Epoch [28/40], Passed time:[76.433/2140.111]
learning rate: 0.001
Batch [0/704] training loss = 0.1723, training acc = 0.92
Batch [200/704] training loss = 0.1730, training acc = 0.94
Batch [400/704] training loss = 0.2245, training acc = 0.92
Batch [600/704] training loss = 0.1659, training acc = 0.94
Valid Test with nat
Test accuracy: 89.48% (4474/5000), Test loss:0.3359
Epoch [29/40], Passed time:[76.641/2222.581]
learning rate: 0.001
Batch [0/704] training loss = 0.1533, training acc = 0.91
Batch [200/704] training loss = 0.1453, training acc = 0.94
Batch [400/704] training loss = 0.0892, training acc = 0.98
Batch [600/704] training loss = 0.2043, training acc = 0.92
Valid Test with nat
Test accuracy: 89.34% (4467/5000), Test loss:0.3364
Epoch [30/40], Passed time:[76.504/2295.118]
learning rate: 0.0001
Batch [0/704] training loss = 0.1568, training acc = 0.94
Batch [200/704] training loss = 0.2877, training acc = 0.91
Batch [400/704] training loss = 0.2537, training acc = 0.91
Batch [600/704] training loss = 0.2398, training acc = 0.91
Valid Test with nat
Test accuracy: 89.34% (4467/5000), Test loss:0.3460
Epoch [31/40], Passed time:[76.482/2370.936]
learning rate: 0.0001
Batch [0/704] training loss = 0.2649, training acc = 0.88
Batch [200/704] training loss = 0.0766, training acc = 0.98
Batch [400/704] training loss = 0.2480, training acc = 0.89
Batch [600/704] training loss = 0.1168, training acc = 0.94
Valid Test with nat
Test accuracy: 89.50% (4475/5000), Test loss:0.3351
Epoch [32/40], Passed time:[76.598/2451.124]
learning rate: 0.0001
Batch [0/704] training loss = 0.0888, training acc = 1.00
Batch [200/704] training loss = 0.1241, training acc = 0.95
Batch [400/704] training loss = 0.1898, training acc = 0.94
Batch [600/704] training loss = 0.2380, training acc = 0.92
Valid Test with nat
Test accuracy: 89.88% (4494/5000), Test loss:0.3327
Epoch [33/40], Passed time:[76.712/2531.499]
learning rate: 0.0001
Batch [0/704] training loss = 0.1842, training acc = 0.92
Batch [200/704] training loss = 0.1400, training acc = 0.92
Batch [400/704] training loss = 0.1778, training acc = 0.95
Batch [600/704] training loss = 0.0828, training acc = 0.98
Valid Test with nat
Test accuracy: 89.66% (4483/5000), Test loss:0.3387
Epoch [34/40], Passed time:[76.624/2605.225]
learning rate: 0.0001
Batch [0/704] training loss = 0.2282, training acc = 0.92
Batch [200/704] training loss = 0.2526, training acc = 0.89
Batch [400/704] training loss = 0.3564, training acc = 0.86
Batch [600/704] training loss = 0.2339, training acc = 0.91
Valid Test with nat
Test accuracy: 89.62% (4481/5000), Test loss:0.3313
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_005_n40.pth
Test on test set:
Test accuracy: 89.05% (8905/10000), Test loss:0.3360
Epoch [35/40], Passed time:[76.721/2685.248]
learning rate: 0.0001
Batch [0/704] training loss = 0.1090, training acc = 0.95
Batch [200/704] training loss = 0.1595, training acc = 0.94
Batch [400/704] training loss = 0.1424, training acc = 0.94
Batch [600/704] training loss = 0.1479, training acc = 0.97
Valid Test with nat
Test accuracy: 89.66% (4483/5000), Test loss:0.3290
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_005_n40.pth
Test on test set:
Test accuracy: 89.03% (8903/10000), Test loss:0.3393
Epoch [36/40], Passed time:[76.758/2763.299]
learning rate: 0.0001
Batch [0/704] training loss = 0.1625, training acc = 0.95
Batch [200/704] training loss = 0.0533, training acc = 0.98
Batch [400/704] training loss = 0.1201, training acc = 0.95
Batch [600/704] training loss = 0.2371, training acc = 0.91
Valid Test with nat
Test accuracy: 89.68% (4484/5000), Test loss:0.3301
Epoch [37/40], Passed time:[76.705/2838.085]
learning rate: 0.0001
Batch [0/704] training loss = 0.1473, training acc = 0.95
Batch [200/704] training loss = 0.1711, training acc = 0.91
Batch [400/704] training loss = 0.2191, training acc = 0.91
Batch [600/704] training loss = 0.1569, training acc = 0.95
Valid Test with nat
Test accuracy: 89.66% (4483/5000), Test loss:0.3316
Epoch [38/40], Passed time:[76.685/2914.040]
learning rate: 0.0001
Batch [0/704] training loss = 0.1375, training acc = 0.95
Batch [200/704] training loss = 0.2470, training acc = 0.91
Batch [400/704] training loss = 0.1757, training acc = 0.92
Batch [600/704] training loss = 0.3501, training acc = 0.86
Valid Test with nat
Test accuracy: 89.68% (4484/5000), Test loss:0.3348
Epoch [39/40], Passed time:[76.644/2989.108]
learning rate: 0.0001
Batch [0/704] training loss = 0.3790, training acc = 0.88
Batch [200/704] training loss = 0.1730, training acc = 0.94
Batch [400/704] training loss = 0.2406, training acc = 0.94
Batch [600/704] training loss = 0.1622, training acc = 0.94
Valid Test with nat
Test accuracy: 89.74% (4487/5000), Test loss:0.3326
Training done, model saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_005_n40.pth
Test on test set:
Test accuracy: 89.13% (8913/10000), Test loss:0.3398
