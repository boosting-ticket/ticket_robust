model_type : vgg16
init_type : pure
finetune_method : nat
enhance_method : nat
gpu : 7
model_name : enhance_001_n60
model_width : 8
n_pruning_steps : 1
max_pruning_ratio : 80
train_epochs : 60
enhance_epochs : 60
prune_method : unstructured
dataset : cifar
noise_sd : 1.0
trades_beta : 6.0
seed : 7
warmup : True
create_init : False
init_step : 1400
train_method : nat
early_stop : 50
norm : True
optm : sgd
batch_size : 64
test_batch_size : 100
learning_rate : 0.01
enhance_learning_rate : None
schedule_length : 10
weight_decay : 0.0001
epsilon : 0.03137254901960784
attack_iter : 10
eps_step : 0.00784313725490196
targeted : False
clip_min : 0
clip_max : 1.0
starting_epsilon : 1e-05
interval_weight : 0.1
ft_interval_weight : 50
verbose : 200
resume : 0
model_path : ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n60.pth
last_model_path : ./trained_models_new/
mask_path : ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/pruned_001_mask_r80.npy
mask_name : pruned_001_mask_r80
log_path : ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n60.log
init_path : ./trained_models_new/cifar/vgg16/init/pure_vgg16_init.pth
results_path : None
n_classes : 10
eval : False
init : True
transfer : False
CUDA enabled.
Enhance training config:
Enhance training method: nat
model will be saved in: ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n60.pth
Init model is: ./trained_models_new/cifar/vgg16/init/pure_vgg16_init.pth
Init mask used from: ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/pruned_001_mask_r80.npy
Log will be saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n60.log
Random seed is: 7

model loading from ./trained_models_new/cifar/vgg16/init/pure_vgg16_init.pth
Epoch [0/60]
learning rate: 0.001
Batch [0/704] training loss = 2.2368, training acc = 0.27
Batch [200/704] training loss = 1.5914, training acc = 0.45
Batch [400/704] training loss = 1.2494, training acc = 0.61
Batch [600/704] training loss = 0.7298, training acc = 0.77
Valid Test with nat
Test accuracy: 72.68% (3634/5000), Test loss:0.8164
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n60.pth
Test on test set:
Test accuracy: 72.19% (7219/10000), Test loss:0.8293
Epoch [1/60], Passed time:[83.243/83.243]
learning rate: 0.002
Batch [0/704] training loss = 0.8382, training acc = 0.70
Batch [200/704] training loss = 0.7020, training acc = 0.77
Batch [400/704] training loss = 0.4937, training acc = 0.83
Batch [600/704] training loss = 0.6214, training acc = 0.75
Valid Test with nat
Test accuracy: 82.66% (4133/5000), Test loss:0.5384
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n60.pth
Test on test set:
Test accuracy: 81.77% (8177/10000), Test loss:0.5503
Epoch [2/60], Passed time:[82.122/164.245]
learning rate: 0.0030000000000000005
Batch [0/704] training loss = 0.4358, training acc = 0.84
Batch [200/704] training loss = 0.4901, training acc = 0.84
Batch [400/704] training loss = 0.5478, training acc = 0.77
Batch [600/704] training loss = 0.4958, training acc = 0.81
Valid Test with nat
Test accuracy: 84.06% (4203/5000), Test loss:0.4786
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n60.pth
Test on test set:
Test accuracy: 83.52% (8352/10000), Test loss:0.4991
Epoch [3/60], Passed time:[82.644/247.933]
learning rate: 0.004
Batch [0/704] training loss = 0.2760, training acc = 0.92
Batch [200/704] training loss = 0.4717, training acc = 0.86
Batch [400/704] training loss = 0.4337, training acc = 0.80
Batch [600/704] training loss = 0.5494, training acc = 0.81
Valid Test with nat
Test accuracy: 84.52% (4226/5000), Test loss:0.4593
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n60.pth
Test on test set:
Test accuracy: 84.93% (8493/10000), Test loss:0.4419
Epoch [4/60], Passed time:[82.061/328.245]
learning rate: 0.005
Batch [0/704] training loss = 0.4170, training acc = 0.84
Batch [200/704] training loss = 0.2754, training acc = 0.91
Batch [400/704] training loss = 0.5937, training acc = 0.83
Batch [600/704] training loss = 0.6782, training acc = 0.77
Valid Test with nat
Test accuracy: 81.50% (4075/5000), Test loss:0.5606
Epoch [5/60], Passed time:[82.171/410.853]
learning rate: 0.006000000000000001
Batch [0/704] training loss = 0.5726, training acc = 0.80
Batch [200/704] training loss = 0.1702, training acc = 0.95
Batch [400/704] training loss = 0.4217, training acc = 0.84
Batch [600/704] training loss = 0.3065, training acc = 0.89
Valid Test with nat
Test accuracy: 86.32% (4316/5000), Test loss:0.4167
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n60.pth
Test on test set:
Test accuracy: 85.56% (8556/10000), Test loss:0.4414
Epoch [6/60], Passed time:[82.666/495.997]
learning rate: 0.007000000000000001
Batch [0/704] training loss = 0.3151, training acc = 0.86
Batch [200/704] training loss = 0.2760, training acc = 0.92
Batch [400/704] training loss = 0.3939, training acc = 0.81
Batch [600/704] training loss = 0.2079, training acc = 0.94
Valid Test with nat
Test accuracy: 87.12% (4356/5000), Test loss:0.3914
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n60.pth
Test on test set:
Test accuracy: 86.84% (8684/10000), Test loss:0.4102
Epoch [7/60], Passed time:[83.253/582.768]
learning rate: 0.008
Batch [0/704] training loss = 0.2993, training acc = 0.88
Batch [200/704] training loss = 0.2874, training acc = 0.89
Batch [400/704] training loss = 0.1862, training acc = 0.95
Batch [600/704] training loss = 0.3439, training acc = 0.86
Valid Test with nat
Test accuracy: 85.46% (4273/5000), Test loss:0.4198
Epoch [8/60], Passed time:[83.286/666.290]
learning rate: 0.009000000000000001
Batch [0/704] training loss = 0.5147, training acc = 0.86
Batch [200/704] training loss = 0.3721, training acc = 0.83
Batch [400/704] training loss = 0.2848, training acc = 0.88
Batch [600/704] training loss = 0.2025, training acc = 0.89
Valid Test with nat
Test accuracy: 87.52% (4376/5000), Test loss:0.3907
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n60.pth
Test on test set:
Test accuracy: 86.94% (8694/10000), Test loss:0.3984
Epoch [9/60], Passed time:[83.788/754.089]
learning rate: 0.01
Batch [0/704] training loss = 0.3455, training acc = 0.89
Batch [200/704] training loss = 0.2586, training acc = 0.88
Batch [400/704] training loss = 0.2676, training acc = 0.91
Batch [600/704] training loss = 0.3494, training acc = 0.88
Valid Test with nat
Test accuracy: 87.48% (4374/5000), Test loss:0.3871
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n60.pth
Test on test set:
Test accuracy: 87.00% (8700/10000), Test loss:0.4115
Epoch [10/60], Passed time:[83.226/832.265]
learning rate: 0.01
Batch [0/704] training loss = 0.1978, training acc = 0.94
Batch [200/704] training loss = 0.2405, training acc = 0.95
Batch [400/704] training loss = 0.1562, training acc = 0.95
Batch [600/704] training loss = 0.2098, training acc = 0.94
Valid Test with nat
Test accuracy: 87.74% (4387/5000), Test loss:0.3797
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n60.pth
Test on test set:
Test accuracy: 87.41% (8741/10000), Test loss:0.3975
Epoch [11/60], Passed time:[82.909/912.002]
learning rate: 0.01
Batch [0/704] training loss = 0.1027, training acc = 0.98
Batch [200/704] training loss = 0.3056, training acc = 0.94
Batch [400/704] training loss = 0.1979, training acc = 0.91
Batch [600/704] training loss = 0.2842, training acc = 0.91
Valid Test with nat
Test accuracy: 87.42% (4371/5000), Test loss:0.3926
Epoch [12/60], Passed time:[82.508/990.097]
learning rate: 0.01
Batch [0/704] training loss = 0.1076, training acc = 0.97
Batch [200/704] training loss = 0.2407, training acc = 0.91
Batch [400/704] training loss = 0.2936, training acc = 0.89
Batch [600/704] training loss = 0.2145, training acc = 0.91
Valid Test with nat
Test accuracy: 89.20% (4460/5000), Test loss:0.3289
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n60.pth
Test on test set:
Test accuracy: 89.11% (8911/10000), Test loss:0.3355
Epoch [13/60], Passed time:[82.105/1067.367]
learning rate: 0.01
Batch [0/704] training loss = 0.1760, training acc = 0.94
Batch [200/704] training loss = 0.3088, training acc = 0.88
Batch [400/704] training loss = 0.1775, training acc = 0.95
Batch [600/704] training loss = 0.2173, training acc = 0.92
Valid Test with nat
Test accuracy: 89.08% (4454/5000), Test loss:0.3537
Epoch [14/60], Passed time:[81.778/1144.890]
learning rate: 0.01
Batch [0/704] training loss = 0.2135, training acc = 0.94
Batch [200/704] training loss = 0.1832, training acc = 0.94
Batch [400/704] training loss = 0.3094, training acc = 0.89
Batch [600/704] training loss = 0.3062, training acc = 0.89
Valid Test with nat
Test accuracy: 88.22% (4411/5000), Test loss:0.3698
Epoch [15/60], Passed time:[81.057/1215.848]
learning rate: 0.01
Batch [0/704] training loss = 0.2354, training acc = 0.92
Batch [200/704] training loss = 0.1832, training acc = 0.94
Batch [400/704] training loss = 0.2622, training acc = 0.91
Batch [600/704] training loss = 0.1850, training acc = 0.94
Valid Test with nat
Test accuracy: 88.20% (4410/5000), Test loss:0.3803
Epoch [16/60], Passed time:[80.052/1280.835]
learning rate: 0.01
Batch [0/704] training loss = 0.1658, training acc = 0.95
Batch [200/704] training loss = 0.2424, training acc = 0.95
Batch [400/704] training loss = 0.1659, training acc = 0.91
Batch [600/704] training loss = 0.4530, training acc = 0.84
Valid Test with nat
Test accuracy: 88.48% (4424/5000), Test loss:0.3723
Epoch [17/60], Passed time:[79.193/1346.284]
learning rate: 0.01
Batch [0/704] training loss = 0.0560, training acc = 0.98
Batch [200/704] training loss = 0.1029, training acc = 0.97
Batch [400/704] training loss = 0.1981, training acc = 0.88
Batch [600/704] training loss = 0.3493, training acc = 0.91
Valid Test with nat
Test accuracy: 89.20% (4460/5000), Test loss:0.3559
Epoch [18/60], Passed time:[78.311/1409.601]
learning rate: 0.01
Batch [0/704] training loss = 0.1494, training acc = 0.94
Batch [200/704] training loss = 0.1239, training acc = 0.94
Batch [400/704] training loss = 0.0539, training acc = 0.98
Batch [600/704] training loss = 0.1445, training acc = 0.95
Valid Test with nat
Test accuracy: 89.06% (4453/5000), Test loss:0.3663
Epoch [19/60], Passed time:[77.539/1473.241]
learning rate: 0.01
Batch [0/704] training loss = 0.1213, training acc = 0.94
Batch [200/704] training loss = 0.1320, training acc = 0.92
Batch [400/704] training loss = 0.1761, training acc = 0.92
Batch [600/704] training loss = 0.1486, training acc = 0.97
Valid Test with nat
Test accuracy: 89.28% (4464/5000), Test loss:0.3735
Epoch [20/60], Passed time:[76.893/1537.863]
learning rate: 0.01
Batch [0/704] training loss = 0.1066, training acc = 0.98
Batch [200/704] training loss = 0.0933, training acc = 0.97
Batch [400/704] training loss = 0.0469, training acc = 1.00
Batch [600/704] training loss = 0.1612, training acc = 0.95
Valid Test with nat
Test accuracy: 89.92% (4496/5000), Test loss:0.3368
Epoch [21/60], Passed time:[76.211/1600.434]
learning rate: 0.01
Batch [0/704] training loss = 0.2780, training acc = 0.91
Batch [200/704] training loss = 0.1267, training acc = 0.95
Batch [400/704] training loss = 0.0466, training acc = 1.00
Batch [600/704] training loss = 0.0842, training acc = 0.97
Valid Test with nat
Test accuracy: 90.50% (4525/5000), Test loss:0.3262
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n60.pth
Test on test set:
Test accuracy: 90.04% (9004/10000), Test loss:0.3315
Epoch [22/60], Passed time:[75.789/1667.367]
learning rate: 0.01
Batch [0/704] training loss = 0.0506, training acc = 1.00
Batch [200/704] training loss = 0.1715, training acc = 0.95
Batch [400/704] training loss = 0.2843, training acc = 0.88
Batch [600/704] training loss = 0.2235, training acc = 0.95
Valid Test with nat
Test accuracy: 89.00% (4450/5000), Test loss:0.3880
Epoch [23/60], Passed time:[75.354/1733.147]
learning rate: 0.01
Batch [0/704] training loss = 0.2146, training acc = 0.92
Batch [200/704] training loss = 0.1573, training acc = 0.97
Batch [400/704] training loss = 0.1221, training acc = 0.95
Batch [600/704] training loss = 0.1430, training acc = 0.97
Valid Test with nat
Test accuracy: 89.94% (4497/5000), Test loss:0.3407
Epoch [24/60], Passed time:[74.716/1793.191]
learning rate: 0.01
Batch [0/704] training loss = 0.1092, training acc = 0.97
Batch [200/704] training loss = 0.1363, training acc = 0.92
Batch [400/704] training loss = 0.0721, training acc = 0.98
Batch [600/704] training loss = 0.1304, training acc = 0.97
Valid Test with nat
Test accuracy: 90.14% (4507/5000), Test loss:0.3612
Epoch [25/60], Passed time:[74.263/1856.582]
learning rate: 0.01
Batch [0/704] training loss = 0.1482, training acc = 0.94
Batch [200/704] training loss = 0.0945, training acc = 0.95
Batch [400/704] training loss = 0.2008, training acc = 0.92
Batch [600/704] training loss = 0.0891, training acc = 0.97
Valid Test with nat
Test accuracy: 89.34% (4467/5000), Test loss:0.3603
Epoch [26/60], Passed time:[73.816/1919.214]
learning rate: 0.01
Batch [0/704] training loss = 0.1398, training acc = 0.95
Batch [200/704] training loss = 0.1327, training acc = 0.97
Batch [400/704] training loss = 0.0912, training acc = 0.97
Batch [600/704] training loss = 0.0523, training acc = 0.97
Valid Test with nat
Test accuracy: 89.20% (4460/5000), Test loss:0.3742
Epoch [27/60], Passed time:[73.368/1980.924]
learning rate: 0.01
Batch [0/704] training loss = 0.2151, training acc = 0.95
Batch [200/704] training loss = 0.1646, training acc = 0.95
Batch [400/704] training loss = 0.1249, training acc = 0.97
Batch [600/704] training loss = 0.1720, training acc = 0.95
Valid Test with nat
Test accuracy: 89.46% (4473/5000), Test loss:0.3545
Epoch [28/60], Passed time:[72.952/2042.666]
learning rate: 0.01
Batch [0/704] training loss = 0.0981, training acc = 0.97
Batch [200/704] training loss = 0.0706, training acc = 0.97
Batch [400/704] training loss = 0.1137, training acc = 0.94
Batch [600/704] training loss = 0.0326, training acc = 1.00
Valid Test with nat
Test accuracy: 89.42% (4471/5000), Test loss:0.3512
Epoch [29/60], Passed time:[72.640/2106.563]
learning rate: 0.01
Batch [0/704] training loss = 0.0959, training acc = 0.95
Batch [200/704] training loss = 0.1501, training acc = 0.95
Batch [400/704] training loss = 0.1142, training acc = 0.97
Batch [600/704] training loss = 0.0844, training acc = 0.97
Valid Test with nat
Test accuracy: 90.64% (4532/5000), Test loss:0.3273
Epoch [30/60], Passed time:[72.329/2169.876]
learning rate: 0.001
Batch [0/704] training loss = 0.1261, training acc = 0.94
Batch [200/704] training loss = 0.0233, training acc = 1.00
Batch [400/704] training loss = 0.0519, training acc = 0.98
Batch [600/704] training loss = 0.1007, training acc = 0.97
Valid Test with nat
Test accuracy: 91.30% (4565/5000), Test loss:0.2966
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n60.pth
Test on test set:
Test accuracy: 91.27% (9127/10000), Test loss:0.2984
Epoch [31/60], Passed time:[72.163/2237.056]
learning rate: 0.001
Batch [0/704] training loss = 0.0502, training acc = 0.97
Batch [200/704] training loss = 0.0544, training acc = 0.97
Batch [400/704] training loss = 0.0469, training acc = 0.98
Batch [600/704] training loss = 0.1053, training acc = 0.97
Valid Test with nat
Test accuracy: 91.42% (4571/5000), Test loss:0.3059
Epoch [32/60], Passed time:[71.955/2302.549]
learning rate: 0.001
Batch [0/704] training loss = 0.0506, training acc = 0.98
Batch [200/704] training loss = 0.0617, training acc = 0.98
Batch [400/704] training loss = 0.0184, training acc = 1.00
Batch [600/704] training loss = 0.0452, training acc = 0.98
Valid Test with nat
Test accuracy: 91.40% (4570/5000), Test loss:0.2979
Epoch [33/60], Passed time:[71.747/2367.646]
learning rate: 0.001
Batch [0/704] training loss = 0.0242, training acc = 1.00
Batch [200/704] training loss = 0.0623, training acc = 0.97
Batch [400/704] training loss = 0.0135, training acc = 1.00
Batch [600/704] training loss = 0.0374, training acc = 0.98
Valid Test with nat
Test accuracy: 91.44% (4572/5000), Test loss:0.2966
Best model so far saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n60.pth
Test on test set:
Test accuracy: 91.49% (9149/10000), Test loss:0.3002
Epoch [34/60], Passed time:[71.544/2432.499]
learning rate: 0.001
Batch [0/704] training loss = 0.0504, training acc = 0.97
Batch [200/704] training loss = 0.0665, training acc = 0.97
Batch [400/704] training loss = 0.0435, training acc = 0.98
Batch [600/704] training loss = 0.0572, training acc = 0.98
Valid Test with nat
Test accuracy: 91.64% (4582/5000), Test loss:0.3020
Epoch [35/60], Passed time:[71.284/2494.957]
learning rate: 0.001
Batch [0/704] training loss = 0.1161, training acc = 0.95
Batch [200/704] training loss = 0.1131, training acc = 0.95
Batch [400/704] training loss = 0.0064, training acc = 1.00
Batch [600/704] training loss = 0.0126, training acc = 1.00
Valid Test with nat
Test accuracy: 91.54% (4577/5000), Test loss:0.3020
Epoch [36/60], Passed time:[71.041/2557.475]
learning rate: 0.001
Batch [0/704] training loss = 0.0139, training acc = 1.00
Batch [200/704] training loss = 0.0046, training acc = 1.00
Batch [400/704] training loss = 0.0142, training acc = 1.00
Batch [600/704] training loss = 0.0097, training acc = 1.00
Valid Test with nat
Test accuracy: 91.58% (4579/5000), Test loss:0.3037
Epoch [37/60], Passed time:[70.834/2620.843]
learning rate: 0.001
Batch [0/704] training loss = 0.0241, training acc = 1.00
Batch [200/704] training loss = 0.0766, training acc = 0.95
Batch [400/704] training loss = 0.0491, training acc = 0.97
Batch [600/704] training loss = 0.0727, training acc = 0.97
Valid Test with nat
Test accuracy: 91.62% (4581/5000), Test loss:0.3218
Epoch [38/60], Passed time:[70.583/2682.168]
learning rate: 0.001
Batch [0/704] training loss = 0.0570, training acc = 0.98
Batch [200/704] training loss = 0.0243, training acc = 1.00
Batch [400/704] training loss = 0.0165, training acc = 1.00
Batch [600/704] training loss = 0.0957, training acc = 0.97
Valid Test with nat
Test accuracy: 91.66% (4583/5000), Test loss:0.3052
Epoch [39/60], Passed time:[70.383/2744.932]
learning rate: 0.001
Batch [0/704] training loss = 0.0898, training acc = 0.95
Batch [200/704] training loss = 0.0523, training acc = 0.98
Batch [400/704] training loss = 0.0337, training acc = 1.00
Batch [600/704] training loss = 0.0140, training acc = 1.00
Valid Test with nat
Test accuracy: 91.74% (4587/5000), Test loss:0.3100
Epoch [40/60], Passed time:[70.155/2806.209]
learning rate: 0.001
Batch [0/704] training loss = 0.0316, training acc = 0.98
Batch [200/704] training loss = 0.0427, training acc = 1.00
Batch [400/704] training loss = 0.0206, training acc = 1.00
Batch [600/704] training loss = 0.2041, training acc = 0.94
Valid Test with nat
Test accuracy: 91.64% (4582/5000), Test loss:0.3060
Epoch [41/60], Passed time:[70.155/2876.347]
learning rate: 0.001
Batch [0/704] training loss = 0.0782, training acc = 0.98
Batch [200/704] training loss = 0.1002, training acc = 0.97
Batch [400/704] training loss = 0.0139, training acc = 1.00
Batch [600/704] training loss = 0.0693, training acc = 0.98
Valid Test with nat
Test accuracy: 91.78% (4589/5000), Test loss:0.3185
Epoch [42/60], Passed time:[70.363/2955.246]
learning rate: 0.001
Batch [0/704] training loss = 0.0179, training acc = 1.00
Batch [200/704] training loss = 0.0257, training acc = 0.98
Batch [400/704] training loss = 0.0120, training acc = 1.00
Batch [600/704] training loss = 0.0140, training acc = 1.00
Valid Test with nat
Test accuracy: 91.62% (4581/5000), Test loss:0.3205
Epoch [43/60], Passed time:[70.461/3029.825]
learning rate: 0.001
Batch [0/704] training loss = 0.0236, training acc = 1.00
Batch [200/704] training loss = 0.0040, training acc = 1.00
Batch [400/704] training loss = 0.0722, training acc = 0.98
Batch [600/704] training loss = 0.0301, training acc = 0.98
Valid Test with nat
Test accuracy: 91.72% (4586/5000), Test loss:0.3173
Epoch [44/60], Passed time:[70.580/3105.523]
learning rate: 0.001
Batch [0/704] training loss = 0.0483, training acc = 0.97
Batch [200/704] training loss = 0.0350, training acc = 0.98
Batch [400/704] training loss = 0.0096, training acc = 1.00
Batch [600/704] training loss = 0.1079, training acc = 0.94
Valid Test with nat
Test accuracy: 91.74% (4587/5000), Test loss:0.3091
Epoch [45/60], Passed time:[70.547/3174.596]
learning rate: 0.0001
Batch [0/704] training loss = 0.0113, training acc = 1.00
Batch [200/704] training loss = 0.0168, training acc = 1.00
Batch [400/704] training loss = 0.0321, training acc = 0.98
Batch [600/704] training loss = 0.1331, training acc = 0.95
Valid Test with nat
Test accuracy: 91.76% (4588/5000), Test loss:0.3130
Epoch [46/60], Passed time:[70.554/3245.489]
learning rate: 0.0001
Batch [0/704] training loss = 0.0437, training acc = 0.98
Batch [200/704] training loss = 0.0095, training acc = 1.00
Batch [400/704] training loss = 0.0369, training acc = 0.98
Batch [600/704] training loss = 0.0657, training acc = 0.98
Valid Test with nat
Test accuracy: 91.76% (4588/5000), Test loss:0.3188
Epoch [47/60], Passed time:[70.614/3318.863]
learning rate: 0.0001
Batch [0/704] training loss = 0.0076, training acc = 1.00
Batch [200/704] training loss = 0.0275, training acc = 0.98
Batch [400/704] training loss = 0.0863, training acc = 0.95
Batch [600/704] training loss = 0.0172, training acc = 0.98
Valid Test with nat
Test accuracy: 91.80% (4590/5000), Test loss:0.3171
Epoch [48/60], Passed time:[70.780/3397.431]
learning rate: 0.0001
Batch [0/704] training loss = 0.0321, training acc = 0.98
Batch [200/704] training loss = 0.0990, training acc = 0.97
Batch [400/704] training loss = 0.0709, training acc = 0.97
Batch [600/704] training loss = 0.0151, training acc = 1.00
Valid Test with nat
Test accuracy: 91.94% (4597/5000), Test loss:0.3154
Epoch [49/60], Passed time:[70.969/3477.491]
learning rate: 0.0001
Batch [0/704] training loss = 0.0157, training acc = 1.00
Batch [200/704] training loss = 0.0452, training acc = 0.97
Batch [400/704] training loss = 0.0562, training acc = 0.98
Batch [600/704] training loss = 0.0151, training acc = 1.00
Valid Test with nat
Test accuracy: 91.80% (4590/5000), Test loss:0.3176
Epoch [50/60], Passed time:[71.131/3556.539]
learning rate: 0.0001
Batch [0/704] training loss = 0.0237, training acc = 1.00
Batch [200/704] training loss = 0.0820, training acc = 0.95
Batch [400/704] training loss = 0.0808, training acc = 0.95
Batch [600/704] training loss = 0.0296, training acc = 0.98
Valid Test with nat
Test accuracy: 91.68% (4584/5000), Test loss:0.3125
Epoch [51/60], Passed time:[71.214/3631.936]
learning rate: 0.0001
Batch [0/704] training loss = 0.0685, training acc = 0.97
Batch [200/704] training loss = 0.0425, training acc = 0.98
Batch [400/704] training loss = 0.0457, training acc = 0.98
Batch [600/704] training loss = 0.0314, training acc = 0.98
Valid Test with nat
Test accuracy: 91.74% (4587/5000), Test loss:0.3197
Epoch [52/60], Passed time:[71.321/3708.701]
learning rate: 0.0001
Batch [0/704] training loss = 0.0343, training acc = 0.98
Batch [200/704] training loss = 0.0029, training acc = 1.00
Batch [400/704] training loss = 0.0520, training acc = 0.98
Batch [600/704] training loss = 0.0032, training acc = 1.00
Valid Test with nat
Test accuracy: 91.70% (4585/5000), Test loss:0.3145
Epoch [53/60], Passed time:[71.365/3782.330]
learning rate: 0.0001
Batch [0/704] training loss = 0.0144, training acc = 1.00
Batch [200/704] training loss = 0.0080, training acc = 1.00
Batch [400/704] training loss = 0.0543, training acc = 0.97
Batch [600/704] training loss = 0.0998, training acc = 0.97
Valid Test with nat
Test accuracy: 91.84% (4592/5000), Test loss:0.3109
Epoch [54/60], Passed time:[71.363/3853.579]
learning rate: 0.0001
Batch [0/704] training loss = 0.0838, training acc = 0.97
Batch [200/704] training loss = 0.0145, training acc = 1.00
Batch [400/704] training loss = 0.0264, training acc = 1.00
Batch [600/704] training loss = 0.0041, training acc = 1.00
Valid Test with nat
Test accuracy: 91.78% (4589/5000), Test loss:0.3131
Epoch [55/60], Passed time:[71.435/3928.939]
learning rate: 0.0001
Batch [0/704] training loss = 0.0753, training acc = 0.97
Batch [200/704] training loss = 0.0620, training acc = 0.97
Batch [400/704] training loss = 0.0319, training acc = 0.98
Batch [600/704] training loss = 0.0061, training acc = 1.00
Valid Test with nat
Test accuracy: 91.54% (4577/5000), Test loss:0.3147
Epoch [56/60], Passed time:[71.538/4006.144]
learning rate: 0.0001
Batch [0/704] training loss = 0.0315, training acc = 0.98
Batch [200/704] training loss = 0.0175, training acc = 1.00
Batch [400/704] training loss = 0.1097, training acc = 0.97
Batch [600/704] training loss = 0.0169, training acc = 1.00
Valid Test with nat
Test accuracy: 91.82% (4591/5000), Test loss:0.3310
Epoch [57/60], Passed time:[71.655/4084.314]
learning rate: 0.0001
Batch [0/704] training loss = 0.0048, training acc = 1.00
Batch [200/704] training loss = 0.1163, training acc = 0.97
Batch [400/704] training loss = 0.0734, training acc = 0.97
Batch [600/704] training loss = 0.0426, training acc = 0.98
Valid Test with nat
Test accuracy: 91.68% (4584/5000), Test loss:0.3149
Epoch [58/60], Passed time:[71.696/4158.360]
learning rate: 0.0001
Batch [0/704] training loss = 0.0456, training acc = 0.98
Batch [200/704] training loss = 0.0132, training acc = 1.00
Batch [400/704] training loss = 0.0497, training acc = 0.97
Batch [600/704] training loss = 0.0386, training acc = 0.98
Valid Test with nat
Test accuracy: 91.78% (4589/5000), Test loss:0.3144
Epoch [59/60], Passed time:[71.819/4237.306]
learning rate: 0.0001
Batch [0/704] training loss = 0.0344, training acc = 0.98
Batch [200/704] training loss = 0.0979, training acc = 0.97
Batch [400/704] training loss = 0.0277, training acc = 1.00
Batch [600/704] training loss = 0.0571, training acc = 0.97
Valid Test with nat
Test accuracy: 91.70% (4585/5000), Test loss:0.3160
Training done, model saved in ./trained_models_new/cifar/vgg16/nat/pruned1_epoch100_r80/init_pure/enhance_001_n60.pth
Test on test set:
Test accuracy: 91.78% (9178/10000), Test loss:0.3104
