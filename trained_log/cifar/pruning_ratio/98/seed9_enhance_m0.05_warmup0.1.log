model_type : resnet18
init_type : pure
finetune_method : nat
enhance_method : nat
gpu : 5
model_name : seed9_enhance_m0.05_warmup0.1
model_width : 8
n_pruning_steps : 1
max_pruning_ratio : 98
train_epochs : 100
enhance_epochs : None
prune_method : unstructured
dataset : cifar
noise_sd : 1.0
trades_beta : 6.0
seed : 9
warmup : True
parallel : False
create_init : False
init_step : 1400
train_method : nat
early_stop : 1000
norm : True
optm : sgd
batch_size : 128
test_batch_size : 100
learning_rate : 0.1
enhance_learning_rate : 0.1
schedule_length : 10
weight_decay : 0.0001
epsilon : 0.03137254901960784
attack_iter : 10
eps_step : 0.00784313725490196
targeted : False
clip_min : 0
clip_max : 1.0
starting_epsilon : 1e-05
interval_weight : 0.1
ft_interval_weight : 50
verbose : 200
resume : 0
model_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r98/init_pure/seed9_enhance_m0.05_warmup0.1.pth
last_model_path : ./trained_models_new/
mask_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r98/init_pure/pruned_lr0.05_mask_r98.npy
mask_name : pruned_lr0.05_mask_r98
log_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r98/init_pure/seed9_enhance_m0.05_warmup0.1.log
init_path : ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
results_path : None
n_classes : 10
eval : False
init : False
transfer : False
CUDA enabled.
Enhance training config:
Enhance training method: nat
model will be saved in: ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r98/init_pure/seed9_enhance_m0.05_warmup0.1.pth
Init model is: ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
Init mask used from: ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r98/init_pure/pruned_lr0.05_mask_r98.npy
Log will be saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r98/init_pure/seed9_enhance_m0.05_warmup0.1.log
Random seed is: 9

Epoch [0/100]
learning rate: 0.05
Batch [0/352] training loss = 2.3007, training acc = 0.13
Batch [200/352] training loss = 1.5045, training acc = 0.42
Valid Test with nat
Test accuracy: 45.10% (2255/5000), Test loss:1.7586
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r98/init_pure/seed9_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 46.37% (4637/10000), Test loss:1.6464
Epoch [1/100], Passed time:[75.455/75.455]
learning rate: 0.055
Batch [0/352] training loss = 1.3133, training acc = 0.50
Batch [200/352] training loss = 0.8707, training acc = 0.70
Valid Test with nat
Test accuracy: 59.92% (2996/5000), Test loss:1.2566
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r98/init_pure/seed9_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 59.17% (5917/10000), Test loss:1.2275
Epoch [2/100], Passed time:[77.364/154.727]
learning rate: 0.060000000000000005
Batch [0/352] training loss = 1.0644, training acc = 0.63
Batch [200/352] training loss = 0.8995, training acc = 0.67
Valid Test with nat
Test accuracy: 63.80% (3190/5000), Test loss:1.1278
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r98/init_pure/seed9_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 61.91% (6191/10000), Test loss:1.1466
Epoch [3/100], Passed time:[77.523/232.570]
learning rate: 0.065
Batch [0/352] training loss = 0.9413, training acc = 0.68
Batch [200/352] training loss = 1.0458, training acc = 0.66
Valid Test with nat
Test accuracy: 64.00% (3200/5000), Test loss:1.2053
Epoch [4/100], Passed time:[78.820/315.280]
learning rate: 0.07
Batch [0/352] training loss = 0.8194, training acc = 0.74
Batch [200/352] training loss = 0.7950, training acc = 0.73
Valid Test with nat
Test accuracy: 71.32% (3566/5000), Test loss:0.8933
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r98/init_pure/seed9_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 70.86% (7086/10000), Test loss:0.8752
Epoch [5/100], Passed time:[83.513/417.565]
learning rate: 0.07500000000000001
Batch [0/352] training loss = 0.6449, training acc = 0.77
Batch [200/352] training loss = 0.7067, training acc = 0.71
Valid Test with nat
Test accuracy: 69.96% (3498/5000), Test loss:0.9415
Epoch [6/100], Passed time:[87.263/523.579]
learning rate: 0.08000000000000002
Batch [0/352] training loss = 0.6993, training acc = 0.73
Batch [200/352] training loss = 0.7789, training acc = 0.74
Valid Test with nat
Test accuracy: 73.54% (3677/5000), Test loss:0.8318
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r98/init_pure/seed9_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 72.84% (7284/10000), Test loss:0.8210
Epoch [7/100], Passed time:[90.931/636.514]
learning rate: 0.085
Batch [0/352] training loss = 0.5962, training acc = 0.79
Batch [200/352] training loss = 0.7447, training acc = 0.71
Valid Test with nat
Test accuracy: 75.26% (3763/5000), Test loss:0.7652
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r98/init_pure/seed9_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 75.04% (7504/10000), Test loss:0.7418
Epoch [8/100], Passed time:[93.401/747.205]
learning rate: 0.09
Batch [0/352] training loss = 0.6582, training acc = 0.79
Batch [200/352] training loss = 0.6232, training acc = 0.82
Valid Test with nat
Test accuracy: 76.86% (3843/5000), Test loss:0.7192
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r98/init_pure/seed9_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 77.16% (7716/10000), Test loss:0.6968
Epoch [9/100], Passed time:[95.426/858.835]
learning rate: 0.095
Batch [0/352] training loss = 0.5472, training acc = 0.82
Batch [200/352] training loss = 0.7930, training acc = 0.70
Valid Test with nat
Test accuracy: 73.28% (3664/5000), Test loss:0.8446
Epoch [10/100], Passed time:[96.269/962.694]
learning rate: 0.1
Batch [0/352] training loss = 0.6316, training acc = 0.76
Batch [200/352] training loss = 0.5722, training acc = 0.77
Valid Test with nat
Test accuracy: 76.54% (3827/5000), Test loss:0.7862
Epoch [11/100], Passed time:[96.733/1064.060]
learning rate: 0.1
Batch [0/352] training loss = 0.4371, training acc = 0.88
Batch [200/352] training loss = 0.6219, training acc = 0.78
Valid Test with nat
Test accuracy: 73.94% (3697/5000), Test loss:0.8791
Epoch [12/100], Passed time:[97.097/1165.165]
learning rate: 0.1
Batch [0/352] training loss = 0.6147, training acc = 0.80
Batch [200/352] training loss = 0.5046, training acc = 0.84
Valid Test with nat
Test accuracy: 75.48% (3774/5000), Test loss:0.7649
Epoch [13/100], Passed time:[97.351/1265.567]
learning rate: 0.1
Batch [0/352] training loss = 0.4678, training acc = 0.83
Batch [200/352] training loss = 0.5615, training acc = 0.77
Valid Test with nat
Test accuracy: 74.98% (3749/5000), Test loss:0.7853
Epoch [14/100], Passed time:[97.584/1366.177]
learning rate: 0.1
Batch [0/352] training loss = 0.5076, training acc = 0.81
Batch [200/352] training loss = 0.4391, training acc = 0.83
Valid Test with nat
Test accuracy: 79.12% (3956/5000), Test loss:0.6454
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r98/init_pure/seed9_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 78.99% (7899/10000), Test loss:0.6347
Epoch [15/100], Passed time:[98.162/1472.427]
learning rate: 0.1
Batch [0/352] training loss = 0.4790, training acc = 0.84
Batch [200/352] training loss = 0.5249, training acc = 0.82
Valid Test with nat
Test accuracy: 76.60% (3830/5000), Test loss:0.6973
Epoch [16/100], Passed time:[98.332/1573.305]
learning rate: 0.1
Batch [0/352] training loss = 0.5617, training acc = 0.80
Batch [200/352] training loss = 0.4456, training acc = 0.86
Valid Test with nat
Test accuracy: 76.08% (3804/5000), Test loss:0.7328
Epoch [17/100], Passed time:[98.537/1675.132]
learning rate: 0.1
Batch [0/352] training loss = 0.3808, training acc = 0.84
Batch [200/352] training loss = 0.4907, training acc = 0.84
Valid Test with nat
Test accuracy: 79.50% (3975/5000), Test loss:0.6397
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r98/init_pure/seed9_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 79.02% (7902/10000), Test loss:0.6717
Epoch [18/100], Passed time:[98.797/1778.344]
learning rate: 0.1
Batch [0/352] training loss = 0.6585, training acc = 0.76
Batch [200/352] training loss = 0.5589, training acc = 0.82
Valid Test with nat
Test accuracy: 79.28% (3964/5000), Test loss:0.6379
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r98/init_pure/seed9_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 79.20% (7920/10000), Test loss:0.6191
Epoch [19/100], Passed time:[99.197/1884.743]
learning rate: 0.1
Batch [0/352] training loss = 0.5226, training acc = 0.80
Batch [200/352] training loss = 0.6166, training acc = 0.78
Valid Test with nat
Test accuracy: 79.38% (3969/5000), Test loss:0.6219
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r98/init_pure/seed9_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 78.26% (7826/10000), Test loss:0.6764
Epoch [20/100], Passed time:[99.758/1995.166]
learning rate: 0.1
Batch [0/352] training loss = 0.5016, training acc = 0.83
Batch [200/352] training loss = 0.3799, training acc = 0.88
Valid Test with nat
Test accuracy: 79.22% (3961/5000), Test loss:0.6200
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r98/init_pure/seed9_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 79.21% (7921/10000), Test loss:0.6364
Epoch [21/100], Passed time:[100.318/2106.678]
learning rate: 0.1
Batch [0/352] training loss = 0.5741, training acc = 0.79
Batch [200/352] training loss = 0.4845, training acc = 0.85
Valid Test with nat
Test accuracy: 79.54% (3977/5000), Test loss:0.6731
Epoch [22/100], Passed time:[100.577/2212.690]
learning rate: 0.1
Batch [0/352] training loss = 0.6394, training acc = 0.83
Batch [200/352] training loss = 0.5760, training acc = 0.79
Valid Test with nat
Test accuracy: 80.02% (4001/5000), Test loss:0.6238
Epoch [23/100], Passed time:[100.833/2319.151]
learning rate: 0.1
Batch [0/352] training loss = 0.6206, training acc = 0.80
Batch [200/352] training loss = 0.5255, training acc = 0.85
Valid Test with nat
Test accuracy: 77.62% (3881/5000), Test loss:0.7100
Epoch [24/100], Passed time:[100.808/2419.401]
learning rate: 0.1
Batch [0/352] training loss = 0.5953, training acc = 0.75
Batch [200/352] training loss = 0.5560, training acc = 0.80
Valid Test with nat
Test accuracy: 74.04% (3702/5000), Test loss:0.8573
Epoch [25/100], Passed time:[100.837/2520.928]
learning rate: 0.1
Batch [0/352] training loss = 0.5137, training acc = 0.81
Batch [200/352] training loss = 0.4306, training acc = 0.84
Valid Test with nat
Test accuracy: 81.20% (4060/5000), Test loss:0.5658
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r98/init_pure/seed9_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 80.57% (8057/10000), Test loss:0.5911
Epoch [26/100], Passed time:[101.013/2626.343]
learning rate: 0.1
Batch [0/352] training loss = 0.6077, training acc = 0.75
Batch [200/352] training loss = 0.5472, training acc = 0.81
Valid Test with nat
Test accuracy: 78.66% (3933/5000), Test loss:0.6983
Epoch [27/100], Passed time:[101.032/2727.862]
learning rate: 0.1
Batch [0/352] training loss = 0.5560, training acc = 0.80
Batch [200/352] training loss = 0.4993, training acc = 0.83
Valid Test with nat
Test accuracy: 80.22% (4011/5000), Test loss:0.6249
Epoch [28/100], Passed time:[100.974/2827.258]
learning rate: 0.1
Batch [0/352] training loss = 0.4689, training acc = 0.84
Batch [200/352] training loss = 0.4914, training acc = 0.84
Valid Test with nat
Test accuracy: 80.24% (4012/5000), Test loss:0.5983
Epoch [29/100], Passed time:[100.921/2926.703]
learning rate: 0.1
Batch [0/352] training loss = 0.4752, training acc = 0.83
Batch [200/352] training loss = 0.4133, training acc = 0.84
Valid Test with nat
Test accuracy: 80.14% (4007/5000), Test loss:0.6214
Epoch [30/100], Passed time:[100.855/3025.639]
learning rate: 0.1
Batch [0/352] training loss = 0.4031, training acc = 0.85
Batch [200/352] training loss = 0.2716, training acc = 0.91
Valid Test with nat
Test accuracy: 80.30% (4015/5000), Test loss:0.5742
Epoch [31/100], Passed time:[100.831/3125.747]
learning rate: 0.1
Batch [0/352] training loss = 0.5110, training acc = 0.84
Batch [200/352] training loss = 0.5468, training acc = 0.83
Valid Test with nat
Test accuracy: 80.28% (4014/5000), Test loss:0.6207
Epoch [32/100], Passed time:[100.841/3226.903]
learning rate: 0.1
Batch [0/352] training loss = 0.6478, training acc = 0.80
Batch [200/352] training loss = 0.3270, training acc = 0.91
Valid Test with nat
Test accuracy: 79.72% (3986/5000), Test loss:0.6679
Epoch [33/100], Passed time:[100.941/3331.049]
learning rate: 0.1
Batch [0/352] training loss = 0.3115, training acc = 0.90
Batch [200/352] training loss = 0.5970, training acc = 0.75
Valid Test with nat
Test accuracy: 78.96% (3948/5000), Test loss:0.6504
Epoch [34/100], Passed time:[101.148/3439.031]
learning rate: 0.1
Batch [0/352] training loss = 0.4448, training acc = 0.85
Batch [200/352] training loss = 0.4639, training acc = 0.84
Valid Test with nat
Test accuracy: 81.28% (4064/5000), Test loss:0.5897
Epoch [35/100], Passed time:[101.268/3544.370]
learning rate: 0.1
Batch [0/352] training loss = 0.3794, training acc = 0.88
Batch [200/352] training loss = 0.5047, training acc = 0.80
Valid Test with nat
Test accuracy: 79.22% (3961/5000), Test loss:0.6554
Epoch [36/100], Passed time:[101.363/3649.077]
learning rate: 0.1
Batch [0/352] training loss = 0.3871, training acc = 0.86
Batch [200/352] training loss = 0.5019, training acc = 0.80
Valid Test with nat
Test accuracy: 78.04% (3902/5000), Test loss:0.7077
Epoch [37/100], Passed time:[101.328/3749.138]
learning rate: 0.1
Batch [0/352] training loss = 0.5109, training acc = 0.84
Batch [200/352] training loss = 0.4635, training acc = 0.81
Valid Test with nat
Test accuracy: 80.10% (4005/5000), Test loss:0.6129
Epoch [38/100], Passed time:[101.359/3851.639]
learning rate: 0.1
Batch [0/352] training loss = 0.4901, training acc = 0.84
Batch [200/352] training loss = 0.5448, training acc = 0.83
Valid Test with nat
Test accuracy: 79.46% (3973/5000), Test loss:0.6486
Epoch [39/100], Passed time:[101.324/3951.632]
learning rate: 0.1
Batch [0/352] training loss = 0.4769, training acc = 0.89
Batch [200/352] training loss = 0.6674, training acc = 0.78
Valid Test with nat
Test accuracy: 77.02% (3851/5000), Test loss:0.7581
Epoch [40/100], Passed time:[101.294/4051.765]
learning rate: 0.1
Batch [0/352] training loss = 0.5294, training acc = 0.80
Batch [200/352] training loss = 0.4807, training acc = 0.81
Valid Test with nat
Test accuracy: 78.48% (3924/5000), Test loss:0.6648
Epoch [41/100], Passed time:[101.270/4152.081]
learning rate: 0.1
Batch [0/352] training loss = 0.3350, training acc = 0.88
Batch [200/352] training loss = 0.4166, training acc = 0.87
Valid Test with nat
Test accuracy: 82.32% (4116/5000), Test loss:0.5667
Epoch [42/100], Passed time:[101.233/4251.792]
learning rate: 0.1
Batch [0/352] training loss = 0.4727, training acc = 0.80
Batch [200/352] training loss = 0.5264, training acc = 0.84
Valid Test with nat
Test accuracy: 81.94% (4097/5000), Test loss:0.5764
Epoch [43/100], Passed time:[101.298/4355.833]
learning rate: 0.1
Batch [0/352] training loss = 0.5534, training acc = 0.80
Batch [200/352] training loss = 0.5448, training acc = 0.84
Valid Test with nat
Test accuracy: 79.50% (3975/5000), Test loss:0.6353
Epoch [44/100], Passed time:[101.380/4460.715]
learning rate: 0.1
Batch [0/352] training loss = 0.3575, training acc = 0.88
Batch [200/352] training loss = 0.4610, training acc = 0.82
Valid Test with nat
Test accuracy: 81.94% (4097/5000), Test loss:0.6071
Epoch [45/100], Passed time:[101.492/4567.151]
learning rate: 0.1
Batch [0/352] training loss = 0.3360, training acc = 0.85
Batch [200/352] training loss = 0.4074, training acc = 0.86
Valid Test with nat
Test accuracy: 81.48% (4074/5000), Test loss:0.5464
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r98/init_pure/seed9_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 82.10% (8210/10000), Test loss:0.5351
Epoch [46/100], Passed time:[101.651/4675.935]
learning rate: 0.1
Batch [0/352] training loss = 0.5400, training acc = 0.79
Batch [200/352] training loss = 0.4383, training acc = 0.87
Valid Test with nat
Test accuracy: 78.06% (3903/5000), Test loss:0.7522
Epoch [47/100], Passed time:[101.589/4774.687]
learning rate: 0.1
Batch [0/352] training loss = 0.3335, training acc = 0.89
Batch [200/352] training loss = 0.4124, training acc = 0.86
Valid Test with nat
Test accuracy: 78.08% (3904/5000), Test loss:0.7074
Epoch [48/100], Passed time:[101.522/4873.046]
learning rate: 0.1
Batch [0/352] training loss = 0.4727, training acc = 0.84
Batch [200/352] training loss = 0.2758, training acc = 0.91
Valid Test with nat
Test accuracy: 82.18% (4109/5000), Test loss:0.5601
Epoch [49/100], Passed time:[101.394/4968.315]
learning rate: 0.1
Batch [0/352] training loss = 0.3859, training acc = 0.86
Batch [200/352] training loss = 0.4844, training acc = 0.82
Valid Test with nat
Test accuracy: 82.28% (4114/5000), Test loss:0.5549
Epoch [50/100], Passed time:[101.220/5061.021]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.4398, training acc = 0.86
Batch [200/352] training loss = 0.2599, training acc = 0.90
Valid Test with nat
Test accuracy: 86.42% (4321/5000), Test loss:0.4247
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r98/init_pure/seed9_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 86.28% (8628/10000), Test loss:0.4117
Epoch [51/100], Passed time:[101.198/5161.106]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.3765, training acc = 0.84
Batch [200/352] training loss = 0.2832, training acc = 0.90
Valid Test with nat
