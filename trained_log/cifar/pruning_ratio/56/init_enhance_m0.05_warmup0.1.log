model_type : resnet18
init_type : pure
finetune_method : nat
enhance_method : nat
gpu : 4
model_name : init_enhance_m0.05_warmup0.1
model_width : 8
n_pruning_steps : 1
max_pruning_ratio : 56
train_epochs : 100
enhance_epochs : None
prune_method : unstructured
dataset : cifar
noise_sd : 1.0
trades_beta : 6.0
seed : 7
warmup : True
parallel : False
create_init : False
init_step : 1400
train_method : nat
early_stop : 1000
norm : True
optm : sgd
batch_size : 128
test_batch_size : 100
learning_rate : 0.1
enhance_learning_rate : 0.1
schedule_length : 10
weight_decay : 0.0001
epsilon : 0.03137254901960784
attack_iter : 10
eps_step : 0.00784313725490196
targeted : False
clip_min : 0
clip_max : 1.0
starting_epsilon : 1e-05
interval_weight : 0.1
ft_interval_weight : 50
verbose : 200
resume : 0
model_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r56/init_pure/init_enhance_m0.05_warmup0.1.pth
last_model_path : ./trained_models_new/
mask_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r56/init_pure/pruned_lr0.05_mask_r56.npy
mask_name : pruned_lr0.05_mask_r56
log_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r56/init_pure/init_enhance_m0.05_warmup0.1.log
init_path : ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
results_path : None
n_classes : 10
eval : False
init : True
transfer : False
CUDA enabled.
Enhance training config:
Enhance training method: nat
model will be saved in: ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r56/init_pure/init_enhance_m0.05_warmup0.1.pth
Init model is: ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
Init mask used from: ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r56/init_pure/pruned_lr0.05_mask_r56.npy
Log will be saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r56/init_pure/init_enhance_m0.05_warmup0.1.log
Random seed is: 7

model loading from ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
Epoch [0/100]
learning rate: 0.05
Batch [0/352] training loss = 2.1805, training acc = 0.22
Batch [200/352] training loss = 0.8594, training acc = 0.70
Valid Test with nat
Test accuracy: 68.74% (3437/5000), Test loss:1.1480
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r56/init_pure/init_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 67.17% (6717/10000), Test loss:1.1802
Epoch [1/100], Passed time:[81.658/81.658]
learning rate: 0.055
Batch [0/352] training loss = 0.6094, training acc = 0.80
Batch [200/352] training loss = 0.5013, training acc = 0.82
Valid Test with nat
Test accuracy: 76.54% (3827/5000), Test loss:0.8174
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r56/init_pure/init_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 76.18% (7618/10000), Test loss:0.8406
Epoch [2/100], Passed time:[79.921/159.841]
learning rate: 0.060000000000000005
Batch [0/352] training loss = 0.4456, training acc = 0.82
Batch [200/352] training loss = 0.3664, training acc = 0.87
Valid Test with nat
Test accuracy: 83.34% (4167/5000), Test loss:0.5291
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r56/init_pure/init_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 82.16% (8216/10000), Test loss:0.5647
Epoch [3/100], Passed time:[78.127/234.382]
learning rate: 0.065
Batch [0/352] training loss = 0.3591, training acc = 0.87
Batch [200/352] training loss = 0.2750, training acc = 0.89
Valid Test with nat
Test accuracy: 85.22% (4261/5000), Test loss:0.4797
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r56/init_pure/init_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 84.80% (8480/10000), Test loss:0.4995
Epoch [4/100], Passed time:[78.353/313.413]
learning rate: 0.07
Batch [0/352] training loss = 0.3065, training acc = 0.90
Batch [200/352] training loss = 0.2753, training acc = 0.88
Valid Test with nat
Test accuracy: 84.06% (4203/5000), Test loss:0.5306
Epoch [5/100], Passed time:[80.069/400.347]
learning rate: 0.07500000000000001
Batch [0/352] training loss = 0.3207, training acc = 0.88
Batch [200/352] training loss = 0.3662, training acc = 0.88
Valid Test with nat
Test accuracy: 87.42% (4371/5000), Test loss:0.3922
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r56/init_pure/init_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 87.41% (8741/10000), Test loss:0.4048
Epoch [6/100], Passed time:[81.930/491.577]
learning rate: 0.08000000000000002
Batch [0/352] training loss = 0.1738, training acc = 0.91
Batch [200/352] training loss = 0.3183, training acc = 0.89
Valid Test with nat
Test accuracy: 84.42% (4221/5000), Test loss:0.5880
Epoch [7/100], Passed time:[82.764/579.348]
learning rate: 0.085
Batch [0/352] training loss = 0.2458, training acc = 0.91
Batch [200/352] training loss = 0.1598, training acc = 0.95
Valid Test with nat
Test accuracy: 85.90% (4295/5000), Test loss:0.4715
Epoch [8/100], Passed time:[83.182/665.459]
learning rate: 0.09
Batch [0/352] training loss = 0.1848, training acc = 0.95
Batch [200/352] training loss = 0.3162, training acc = 0.92
Valid Test with nat
Test accuracy: 87.86% (4393/5000), Test loss:0.4059
Epoch [9/100], Passed time:[83.538/751.842]
learning rate: 0.095
Batch [0/352] training loss = 0.2085, training acc = 0.92
Batch [200/352] training loss = 0.2479, training acc = 0.91
Valid Test with nat
Test accuracy: 87.22% (4361/5000), Test loss:0.4536
Epoch [10/100], Passed time:[83.608/836.083]
learning rate: 0.1
Batch [0/352] training loss = 0.2199, training acc = 0.94
Batch [200/352] training loss = 0.2640, training acc = 0.88
Valid Test with nat
Test accuracy: 87.52% (4376/5000), Test loss:0.4072
Epoch [11/100], Passed time:[83.821/922.031]
learning rate: 0.1
Batch [0/352] training loss = 0.1275, training acc = 0.95
Batch [200/352] training loss = 0.1525, training acc = 0.95
Valid Test with nat
Test accuracy: 88.76% (4438/5000), Test loss:0.3962
Epoch [12/100], Passed time:[84.094/1009.129]
learning rate: 0.1
Batch [0/352] training loss = 0.1343, training acc = 0.93
Batch [200/352] training loss = 0.3332, training acc = 0.88
Valid Test with nat
Test accuracy: 88.00% (4400/5000), Test loss:0.4648
Epoch [13/100], Passed time:[84.220/1094.864]
learning rate: 0.1
Batch [0/352] training loss = 0.1321, training acc = 0.95
Batch [200/352] training loss = 0.1306, training acc = 0.95
Valid Test with nat
Test accuracy: 86.84% (4342/5000), Test loss:0.4966
Epoch [14/100], Passed time:[84.389/1181.450]
learning rate: 0.1
Batch [0/352] training loss = 0.1886, training acc = 0.93
Batch [200/352] training loss = 0.0753, training acc = 0.98
Valid Test with nat
Test accuracy: 89.86% (4493/5000), Test loss:0.3444
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r56/init_pure/init_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 88.92% (8892/10000), Test loss:0.3767
Epoch [15/100], Passed time:[84.617/1269.254]
learning rate: 0.1
Batch [0/352] training loss = 0.1474, training acc = 0.95
Batch [200/352] training loss = 0.2211, training acc = 0.90
Valid Test with nat
Test accuracy: 87.30% (4365/5000), Test loss:0.5287
Epoch [16/100], Passed time:[84.728/1355.644]
learning rate: 0.1
Batch [0/352] training loss = 0.1546, training acc = 0.96
Batch [200/352] training loss = 0.0990, training acc = 0.98
Valid Test with nat
Test accuracy: 88.18% (4409/5000), Test loss:0.4117
Epoch [17/100], Passed time:[84.621/1438.551]
learning rate: 0.1
Batch [0/352] training loss = 0.1093, training acc = 0.94
Batch [200/352] training loss = 0.1557, training acc = 0.97
Valid Test with nat
Test accuracy: 90.02% (4501/5000), Test loss:0.3478
Epoch [18/100], Passed time:[84.658/1523.843]
learning rate: 0.1
Batch [0/352] training loss = 0.1029, training acc = 0.98
Batch [200/352] training loss = 0.1870, training acc = 0.95
Valid Test with nat
Test accuracy: 87.38% (4369/5000), Test loss:0.4942
Epoch [19/100], Passed time:[84.630/1607.973]
learning rate: 0.1
Batch [0/352] training loss = 0.1328, training acc = 0.94
Batch [200/352] training loss = 0.1292, training acc = 0.95
Valid Test with nat
Test accuracy: 90.20% (4510/5000), Test loss:0.3550
Epoch [20/100], Passed time:[84.654/1693.078]
learning rate: 0.1
Batch [0/352] training loss = 0.2210, training acc = 0.94
Batch [200/352] training loss = 0.1562, training acc = 0.91
Valid Test with nat
Test accuracy: 90.14% (4507/5000), Test loss:0.3505
Epoch [21/100], Passed time:[84.806/1780.923]
learning rate: 0.1
Batch [0/352] training loss = 0.1535, training acc = 0.96
Batch [200/352] training loss = 0.1361, training acc = 0.96
Valid Test with nat
Test accuracy: 89.84% (4492/5000), Test loss:0.3745
Epoch [22/100], Passed time:[84.986/1869.698]
learning rate: 0.1
Batch [0/352] training loss = 0.1213, training acc = 0.97
Batch [200/352] training loss = 0.1738, training acc = 0.93
Valid Test with nat
Test accuracy: 90.64% (4532/5000), Test loss:0.3226
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r56/init_pure/init_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 90.09% (9009/10000), Test loss:0.3551
Epoch [23/100], Passed time:[85.381/1963.770]
learning rate: 0.1
Batch [0/352] training loss = 0.1706, training acc = 0.93
Batch [200/352] training loss = 0.1840, training acc = 0.93
Valid Test with nat
Test accuracy: 90.88% (4544/5000), Test loss:0.3168
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r56/init_pure/init_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 90.36% (9036/10000), Test loss:0.3079
Epoch [24/100], Passed time:[85.709/2057.015]
learning rate: 0.1
Batch [0/352] training loss = 0.0927, training acc = 0.97
Batch [200/352] training loss = 0.1316, training acc = 0.96
Valid Test with nat
Test accuracy: 90.30% (4515/5000), Test loss:0.3462
Epoch [25/100], Passed time:[85.758/2143.942]
learning rate: 0.1
Batch [0/352] training loss = 0.1357, training acc = 0.94
Batch [200/352] training loss = 0.0938, training acc = 0.98
Valid Test with nat
Test accuracy: 88.08% (4404/5000), Test loss:0.4477
Epoch [26/100], Passed time:[85.797/2230.713]
learning rate: 0.1
Batch [0/352] training loss = 0.1268, training acc = 0.95
Batch [200/352] training loss = 0.2495, training acc = 0.91
Valid Test with nat
Test accuracy: 89.72% (4486/5000), Test loss:0.3884
Epoch [27/100], Passed time:[85.793/2316.420]
learning rate: 0.1
Batch [0/352] training loss = 0.1410, training acc = 0.96
Batch [200/352] training loss = 0.1253, training acc = 0.96
Valid Test with nat
Test accuracy: 88.58% (4429/5000), Test loss:0.4207
Epoch [28/100], Passed time:[85.798/2402.352]
learning rate: 0.1
Batch [0/352] training loss = 0.1024, training acc = 0.95
Batch [200/352] training loss = 0.0937, training acc = 0.98
Valid Test with nat
Test accuracy: 87.84% (4392/5000), Test loss:0.4744
Epoch [29/100], Passed time:[85.793/2488.002]
learning rate: 0.1
Batch [0/352] training loss = 0.0944, training acc = 0.98
Batch [200/352] training loss = 0.0951, training acc = 0.96
Valid Test with nat
Test accuracy: 89.92% (4496/5000), Test loss:0.3782
Epoch [30/100], Passed time:[85.727/2571.824]
learning rate: 0.1
Batch [0/352] training loss = 0.2143, training acc = 0.93
Batch [200/352] training loss = 0.1116, training acc = 0.97
Valid Test with nat
Test accuracy: 88.58% (4429/5000), Test loss:0.4001
Epoch [31/100], Passed time:[85.727/2657.540]
learning rate: 0.1
Batch [0/352] training loss = 0.1112, training acc = 0.96
Batch [200/352] training loss = 0.1810, training acc = 0.93
Valid Test with nat
Test accuracy: 88.04% (4402/5000), Test loss:0.4719
Epoch [32/100], Passed time:[85.691/2742.098]
learning rate: 0.1
Batch [0/352] training loss = 0.1495, training acc = 0.97
Batch [200/352] training loss = 0.0725, training acc = 0.98
Valid Test with nat
Test accuracy: 89.32% (4466/5000), Test loss:0.3914
Epoch [33/100], Passed time:[85.707/2828.335]
learning rate: 0.1
Batch [0/352] training loss = 0.1187, training acc = 0.97
Batch [200/352] training loss = 0.2354, training acc = 0.93
Valid Test with nat
Test accuracy: 89.40% (4470/5000), Test loss:0.3710
Epoch [34/100], Passed time:[85.697/2913.706]
learning rate: 0.1
Batch [0/352] training loss = 0.1159, training acc = 0.96
Batch [200/352] training loss = 0.0782, training acc = 0.98
Valid Test with nat
Test accuracy: 86.02% (4301/5000), Test loss:0.5371
Epoch [35/100], Passed time:[85.706/2999.723]
learning rate: 0.1
Batch [0/352] training loss = 0.2405, training acc = 0.91
Batch [200/352] training loss = 0.1530, training acc = 0.95
Valid Test with nat
Test accuracy: 88.10% (4405/5000), Test loss:0.4844
Epoch [36/100], Passed time:[85.732/3086.335]
learning rate: 0.1
Batch [0/352] training loss = 0.0865, training acc = 0.98
Batch [200/352] training loss = 0.1130, training acc = 0.98
Valid Test with nat
Test accuracy: 88.54% (4427/5000), Test loss:0.4436
Epoch [37/100], Passed time:[85.717/3171.545]
learning rate: 0.1
Batch [0/352] training loss = 0.0888, training acc = 0.98
Batch [200/352] training loss = 0.1237, training acc = 0.96
Valid Test with nat
Test accuracy: 88.14% (4407/5000), Test loss:0.4916
Epoch [38/100], Passed time:[85.715/3257.169]
learning rate: 0.1
Batch [0/352] training loss = 0.1800, training acc = 0.94
Batch [200/352] training loss = 0.2106, training acc = 0.91
Valid Test with nat
Test accuracy: 89.66% (4483/5000), Test loss:0.4370
Epoch [39/100], Passed time:[85.641/3339.990]
learning rate: 0.1
Batch [0/352] training loss = 0.1024, training acc = 0.97
Batch [200/352] training loss = 0.1073, training acc = 0.97
Valid Test with nat
Test accuracy: 88.54% (4427/5000), Test loss:0.4568
Epoch [40/100], Passed time:[85.638/3425.536]
learning rate: 0.1
Batch [0/352] training loss = 0.1082, training acc = 0.96
Batch [200/352] training loss = 0.1022, training acc = 0.96
Valid Test with nat
Test accuracy: 88.02% (4401/5000), Test loss:0.4500
Epoch [41/100], Passed time:[85.665/3512.280]
learning rate: 0.1
Batch [0/352] training loss = 0.1344, training acc = 0.95
Batch [200/352] training loss = 0.1414, training acc = 0.97
Valid Test with nat
Test accuracy: 87.80% (4390/5000), Test loss:0.4445
Epoch [42/100], Passed time:[85.620/3596.050]
learning rate: 0.1
Batch [0/352] training loss = 0.1285, training acc = 0.96
Batch [200/352] training loss = 0.0974, training acc = 0.96
Valid Test with nat
Test accuracy: 90.00% (4500/5000), Test loss:0.3596
Epoch [43/100], Passed time:[85.593/3680.502]
learning rate: 0.1
Batch [0/352] training loss = 0.0776, training acc = 0.97
Batch [200/352] training loss = 0.0867, training acc = 0.97
Valid Test with nat
Test accuracy: 89.00% (4450/5000), Test loss:0.4045
Epoch [44/100], Passed time:[85.551/3764.244]
learning rate: 0.1
Batch [0/352] training loss = 0.1008, training acc = 0.95
Batch [200/352] training loss = 0.0766, training acc = 0.98
Valid Test with nat
Test accuracy: 87.54% (4377/5000), Test loss:0.4688
Epoch [45/100], Passed time:[85.527/3848.737]
learning rate: 0.1
Batch [0/352] training loss = 0.0633, training acc = 0.98
Batch [200/352] training loss = 0.1920, training acc = 0.95
Valid Test with nat
Test accuracy: 89.28% (4464/5000), Test loss:0.4114
Epoch [46/100], Passed time:[85.476/3931.918]
learning rate: 0.1
Batch [0/352] training loss = 0.1153, training acc = 0.96
Batch [200/352] training loss = 0.0595, training acc = 0.98
Valid Test with nat
Test accuracy: 88.72% (4436/5000), Test loss:0.4391
Epoch [47/100], Passed time:[85.471/4017.140]
learning rate: 0.1
Batch [0/352] training loss = 0.0756, training acc = 0.97
Batch [200/352] training loss = 0.0715, training acc = 0.96
Valid Test with nat
Test accuracy: 89.88% (4494/5000), Test loss:0.3497
Epoch [48/100], Passed time:[85.517/4104.805]
learning rate: 0.1
Batch [0/352] training loss = 0.2045, training acc = 0.93
Batch [200/352] training loss = 0.2031, training acc = 0.90
Valid Test with nat
Test accuracy: 89.56% (4478/5000), Test loss:0.4153
Epoch [49/100], Passed time:[85.633/4196.000]
learning rate: 0.1
Batch [0/352] training loss = 0.1408, training acc = 0.95
Batch [200/352] training loss = 0.1188, training acc = 0.95
Valid Test with nat
Test accuracy: 88.86% (4443/5000), Test loss:0.4297
Epoch [50/100], Passed time:[85.717/4285.847]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.1061, training acc = 0.97
Batch [200/352] training loss = 0.0554, training acc = 0.98
Valid Test with nat
Test accuracy: 93.62% (4681/5000), Test loss:0.2452
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r56/init_pure/init_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 92.69% (9269/10000), Test loss:0.2615
Epoch [51/100], Passed time:[85.858/4378.734]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0523, training acc = 0.99
Batch [200/352] training loss = 0.0197, training acc = 1.00
Valid Test with nat
Test accuracy: 93.94% (4697/5000), Test loss:0.2472
Epoch [52/100], Passed time:[85.854/4464.414]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0335, training acc = 0.98
Batch [200/352] training loss = 0.0293, training acc = 0.99
Valid Test with nat
Test accuracy: 93.76% (4688/5000), Test loss:0.2450
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r56/init_pure/init_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 92.95% (9295/10000), Test loss:0.2632
Epoch [53/100], Passed time:[85.937/4554.682]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0809, training acc = 0.98
Batch [200/352] training loss = 0.0221, training acc = 1.00
Valid Test with nat
Test accuracy: 93.92% (4696/5000), Test loss:0.2550
Epoch [54/100], Passed time:[85.951/4641.381]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0059, training acc = 1.00
Batch [200/352] training loss = 0.0218, training acc = 1.00
Valid Test with nat
Test accuracy: 94.10% (4705/5000), Test loss:0.2449
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r56/init_pure/init_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 93.24% (9324/10000), Test loss:0.2620
Epoch [55/100], Passed time:[86.033/4731.809]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0215, training acc = 0.99
Batch [200/352] training loss = 0.0229, training acc = 0.99
Valid Test with nat
Test accuracy: 94.10% (4705/5000), Test loss:0.2556
Epoch [56/100], Passed time:[86.025/4817.378]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0059, training acc = 1.00
Batch [200/352] training loss = 0.0176, training acc = 1.00
Valid Test with nat
Test accuracy: 94.10% (4705/5000), Test loss:0.2612
Epoch [57/100], Passed time:[86.008/4902.467]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0434, training acc = 0.98
Batch [200/352] training loss = 0.0627, training acc = 0.98
Valid Test with nat
Test accuracy: 94.34% (4717/5000), Test loss:0.2441
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r56/init_pure/init_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 93.41% (9341/10000), Test loss:0.2680
Epoch [58/100], Passed time:[86.082/4992.774]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0100, training acc = 0.99
Batch [200/352] training loss = 0.0135, training acc = 1.00
Valid Test with nat
Test accuracy: 94.20% (4710/5000), Test loss:0.2658
Epoch [59/100], Passed time:[86.047/5076.752]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0027, training acc = 1.00
Batch [200/352] training loss = 0.0110, training acc = 1.00
Valid Test with nat
Test accuracy: 93.96% (4698/5000), Test loss:0.2693
Epoch [60/100], Passed time:[86.040/5162.417]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0185, training acc = 0.99
Batch [200/352] training loss = 0.0069, training acc = 1.00
Valid Test with nat
Test accuracy: 94.18% (4709/5000), Test loss:0.2672
Epoch [61/100], Passed time:[86.037/5248.269]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0056, training acc = 1.00
Batch [200/352] training loss = 0.0633, training acc = 0.98
Valid Test with nat
Test accuracy: 93.98% (4699/5000), Test loss:0.2873
Epoch [62/100], Passed time:[85.984/5331.006]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0114, training acc = 0.99
Batch [200/352] training loss = 0.0040, training acc = 1.00
Valid Test with nat
Test accuracy: 94.12% (4706/5000), Test loss:0.2765
Epoch [63/100], Passed time:[86.001/5418.079]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0069, training acc = 1.00
Batch [200/352] training loss = 0.0412, training acc = 0.99
Valid Test with nat
Test accuracy: 94.20% (4710/5000), Test loss:0.2579
Epoch [64/100], Passed time:[85.998/5503.842]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0078, training acc = 0.99
Batch [200/352] training loss = 0.0320, training acc = 0.98
Valid Test with nat
Test accuracy: 94.16% (4708/5000), Test loss:0.2576
Epoch [65/100], Passed time:[86.038/5592.444]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0096, training acc = 1.00
Batch [200/352] training loss = 0.0490, training acc = 0.98
Valid Test with nat
Test accuracy: 94.38% (4719/5000), Test loss:0.2583
Epoch [66/100], Passed time:[86.083/5681.484]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0332, training acc = 0.98
Batch [200/352] training loss = 0.0023, training acc = 1.00
Valid Test with nat
Test accuracy: 94.28% (4714/5000), Test loss:0.2578
Epoch [67/100], Passed time:[86.109/5769.318]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0307, training acc = 0.98
Batch [200/352] training loss = 0.0171, training acc = 0.99
Valid Test with nat
Test accuracy: 94.36% (4718/5000), Test loss:0.2600
Epoch [68/100], Passed time:[86.149/5858.120]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0124, training acc = 0.99
Batch [200/352] training loss = 0.0095, training acc = 1.00
Valid Test with nat
Test accuracy: 94.44% (4722/5000), Test loss:0.2592
Epoch [69/100], Passed time:[86.153/5944.571]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0103, training acc = 1.00
Batch [200/352] training loss = 0.0094, training acc = 1.00
Valid Test with nat
Test accuracy: 94.08% (4704/5000), Test loss:0.2806
Epoch [70/100], Passed time:[86.183/6032.789]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0257, training acc = 0.98
Batch [200/352] training loss = 0.0028, training acc = 1.00
Valid Test with nat
Test accuracy: 94.34% (4717/5000), Test loss:0.2635
Epoch [71/100], Passed time:[86.182/6118.936]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0139, training acc = 0.99
Batch [200/352] training loss = 0.0012, training acc = 1.00
Valid Test with nat
Test accuracy: 94.32% (4716/5000), Test loss:0.2632
Epoch [72/100], Passed time:[86.179/6204.853]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0070, training acc = 1.00
Batch [200/352] training loss = 0.0043, training acc = 1.00
Valid Test with nat
Test accuracy: 94.44% (4722/5000), Test loss:0.2587
Epoch [73/100], Passed time:[86.163/6289.870]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0024, training acc = 1.00
Batch [200/352] training loss = 0.0106, training acc = 1.00
Valid Test with nat
Test accuracy: 94.28% (4714/5000), Test loss:0.2599
Epoch [74/100], Passed time:[86.155/6375.436]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0055, training acc = 1.00
Batch [200/352] training loss = 0.0025, training acc = 1.00
Valid Test with nat
Test accuracy: 94.38% (4719/5000), Test loss:0.2571
Epoch [75/100], Passed time:[86.135/6460.135]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0020, training acc = 1.00
Batch [200/352] training loss = 0.0026, training acc = 1.00
Valid Test with nat
Test accuracy: 94.30% (4715/5000), Test loss:0.2602
Epoch [76/100], Passed time:[86.136/6546.317]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0086, training acc = 1.00
Batch [200/352] training loss = 0.0022, training acc = 1.00
Valid Test with nat
Test accuracy: 94.36% (4718/5000), Test loss:0.2533
Epoch [77/100], Passed time:[86.111/6630.554]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0062, training acc = 1.00
Batch [200/352] training loss = 0.0028, training acc = 1.00
Valid Test with nat
Test accuracy: 94.22% (4711/5000), Test loss:0.2553
Epoch [78/100], Passed time:[86.110/6716.549]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0014, training acc = 1.00
Batch [200/352] training loss = 0.0090, training acc = 0.99
Valid Test with nat
Test accuracy: 94.34% (4717/5000), Test loss:0.2622
Epoch [79/100], Passed time:[86.080/6800.306]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0062, training acc = 1.00
Batch [200/352] training loss = 0.0016, training acc = 1.00
Valid Test with nat
Test accuracy: 94.32% (4716/5000), Test loss:0.2556
Epoch [80/100], Passed time:[86.064/6885.160]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0125, training acc = 1.00
Batch [200/352] training loss = 0.0038, training acc = 1.00
Valid Test with nat
Test accuracy: 94.38% (4719/5000), Test loss:0.2557
Epoch [81/100], Passed time:[86.058/6970.696]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0019, training acc = 1.00
Batch [200/352] training loss = 0.0186, training acc = 0.98
Valid Test with nat
Test accuracy: 94.40% (4720/5000), Test loss:0.2544
Epoch [82/100], Passed time:[86.026/7054.167]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0075, training acc = 1.00
Batch [200/352] training loss = 0.0350, training acc = 0.98
Valid Test with nat
Test accuracy: 94.30% (4715/5000), Test loss:0.2583
Epoch [83/100], Passed time:[86.011/7138.929]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0047, training acc = 1.00
Batch [200/352] training loss = 0.0047, training acc = 1.00
Valid Test with nat
Test accuracy: 94.34% (4717/5000), Test loss:0.2629
Epoch [84/100], Passed time:[85.996/7223.671]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0156, training acc = 0.99
Batch [200/352] training loss = 0.0054, training acc = 1.00
Valid Test with nat
Test accuracy: 94.26% (4713/5000), Test loss:0.2572
Epoch [85/100], Passed time:[85.983/7308.553]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0408, training acc = 0.98
Batch [200/352] training loss = 0.0011, training acc = 1.00
Valid Test with nat
Test accuracy: 94.32% (4716/5000), Test loss:0.2805
Epoch [86/100], Passed time:[85.973/7393.706]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0128, training acc = 0.99
Batch [200/352] training loss = 0.0038, training acc = 1.00
Valid Test with nat
Test accuracy: 94.34% (4717/5000), Test loss:0.2578
Epoch [87/100], Passed time:[86.006/7482.507]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0491, training acc = 0.99
Batch [200/352] training loss = 0.0126, training acc = 0.99
Valid Test with nat
Test accuracy: 94.42% (4721/5000), Test loss:0.2547
Epoch [88/100], Passed time:[86.043/7571.809]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0124, training acc = 0.99
Batch [200/352] training loss = 0.0030, training acc = 1.00
Valid Test with nat
Test accuracy: 94.44% (4722/5000), Test loss:0.2541
Epoch [89/100], Passed time:[86.083/7661.363]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0059, training acc = 1.00
Batch [200/352] training loss = 0.0084, training acc = 0.99
Valid Test with nat
Test accuracy: 94.32% (4716/5000), Test loss:0.2566
Epoch [90/100], Passed time:[86.094/7748.433]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0134, training acc = 0.99
Batch [200/352] training loss = 0.0018, training acc = 1.00
Valid Test with nat
Test accuracy: 94.20% (4710/5000), Test loss:0.2584
Epoch [91/100], Passed time:[86.128/7837.638]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0057, training acc = 1.00
Batch [200/352] training loss = 0.0044, training acc = 1.00
Valid Test with nat
Test accuracy: 94.22% (4711/5000), Test loss:0.2596
Epoch [92/100], Passed time:[86.129/7923.836]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0019, training acc = 1.00
Batch [200/352] training loss = 0.0022, training acc = 1.00
Valid Test with nat
Test accuracy: 94.32% (4716/5000), Test loss:0.2593
Epoch [93/100], Passed time:[86.120/8009.188]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0066, training acc = 1.00
Batch [200/352] training loss = 0.0061, training acc = 1.00
Valid Test with nat
Test accuracy: 94.34% (4717/5000), Test loss:0.2548
Epoch [94/100], Passed time:[86.114/8094.740]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0130, training acc = 0.99
Batch [200/352] training loss = 0.0033, training acc = 1.00
Valid Test with nat
Test accuracy: 94.40% (4720/5000), Test loss:0.2539
Epoch [95/100], Passed time:[86.093/8178.804]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0021, training acc = 1.00
Batch [200/352] training loss = 0.0015, training acc = 1.00
Valid Test with nat
Test accuracy: 94.30% (4715/5000), Test loss:0.2538
Epoch [96/100], Passed time:[86.104/8265.971]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0119, training acc = 0.99
Batch [200/352] training loss = 0.0013, training acc = 1.00
Valid Test with nat
Test accuracy: 94.42% (4721/5000), Test loss:0.2569
Epoch [97/100], Passed time:[86.102/8351.906]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0010, training acc = 1.00
Batch [200/352] training loss = 0.0015, training acc = 1.00
Valid Test with nat
Test accuracy: 94.30% (4715/5000), Test loss:0.2544
Epoch [98/100], Passed time:[86.087/8436.545]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0070, training acc = 1.00
Batch [200/352] training loss = 0.0173, training acc = 0.99
Valid Test with nat
Test accuracy: 94.28% (4714/5000), Test loss:0.2551
Epoch [99/100], Passed time:[86.073/8521.230]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0302, training acc = 0.99
Batch [200/352] training loss = 0.0021, training acc = 1.00
Valid Test with nat
Test accuracy: 94.24% (4712/5000), Test loss:0.2574
Training done, model saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r56/init_pure/init_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 93.36% (9336/10000), Test loss:0.2809
