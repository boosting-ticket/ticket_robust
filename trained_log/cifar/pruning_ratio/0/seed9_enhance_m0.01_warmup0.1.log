CUDA enabled.
model_width : 8
gpu : 1
enhance_learning_rate : None
parallel : False
clip_min : 0
train_method : nat
prune_method : unstructured
clip_max : 1.0
mask_name : None
last_model_path : ./trained_models_new/
transfer : False
train_epochs : 100
seed : 7
init : False
init_type : pure
interval_weight : 0.1
finetune_method : nat
trades_beta : 6.0
weight_decay : 0.0001
dataset : cifar
resume : 0
batch_size : 64
epsilon : 0.03137254901960784
mask_path : None
create_init : False
ft_interval_weight : 50
eval : False
test_batch_size : 100
noise_sd : 1.0
model_type : vgg16
early_stop : 100
log_path : ./trained_models_new/cifar/vgg16/training/nat/train_lr0.1_warmup0.01.log
attack_iter : 10
eps_step : 0.00784313725490196
enhance_epochs : None
model_name : train_lr0.1_warmup0.01
schedule_length : 10
norm : True
enhance_method : None
optm : sgd
max_pruning_ratio : 80
warmup : True
model_path : ./trained_models_new/cifar/vgg16/training/nat/train_lr0.1_warmup0.01.pth
targeted : False
results_path : None
n_pruning_steps : 1
init_step : 1400
n_classes : 10
init_path : None
starting_epsilon : 1e-05
learning_rate : 0.1
verbose : 200
config:
training method: nat
model will be saved in: ./trained_models_new/cifar/vgg16/training/nat/train_lr0.1_warmup0.01.pth
Log will be saved in ./trained_models_new/cifar/vgg16/training/nat/train_lr0.1_warmup0.01.log
Epoch [0/100]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 2.3097, training acc = 0.16
Batch [200/704] training loss = 1.7404, training acc = 0.39
Batch [400/704] training loss = 1.5515, training acc = 0.53
Batch [600/704] training loss = 1.0975, training acc = 0.69
Valid Test with nat
Test accuracy: 51.70% (2585/5000), Test loss:1.3692
Best model so far saved in ./trained_models_new/cifar/vgg16/training/nat/train_lr0.1_warmup0.01.pth
Test on test set:
Test accuracy: 50.59% (5059/10000), Test loss:1.3923
Epoch [1/100], Passed time:[87.898/87.898]
learning rate: 0.020000000000000004
Batch [0/704] training loss = 1.1448, training acc = 0.55
Batch [200/704] training loss = 1.4090, training acc = 0.44
Batch [400/704] training loss = 0.9691, training acc = 0.67
Batch [600/704] training loss = 1.1557, training acc = 0.64
Valid Test with nat
Test accuracy: 61.02% (3051/5000), Test loss:1.2325
Best model so far saved in ./trained_models_new/cifar/vgg16/training/nat/train_lr0.1_warmup0.01.pth
Test on test set:
Test accuracy: 58.43% (5843/10000), Test loss:1.3357
Epoch [2/100], Passed time:[88.217/176.433]
learning rate: 0.030000000000000006
Batch [0/704] training loss = 0.9004, training acc = 0.70
Batch [200/704] training loss = 0.8877, training acc = 0.77
Batch [400/704] training loss = 0.8877, training acc = 0.70
Batch [600/704] training loss = 0.8086, training acc = 0.73
Valid Test with nat
Test accuracy: 69.44% (3472/5000), Test loss:0.9171
Best model so far saved in ./trained_models_new/cifar/vgg16/training/nat/train_lr0.1_warmup0.01.pth
Test on test set:
Test accuracy: 68.41% (6841/10000), Test loss:0.9394
Epoch [3/100], Passed time:[92.746/278.238]
learning rate: 0.04000000000000001
Batch [0/704] training loss = 0.8031, training acc = 0.69
Batch [200/704] training loss = 0.9346, training acc = 0.67
Batch [400/704] training loss = 0.8605, training acc = 0.70
Batch [600/704] training loss = 0.9311, training acc = 0.72
Valid Test with nat
Test accuracy: 70.42% (3521/5000), Test loss:0.9381
Epoch [4/100], Passed time:[101.598/406.391]
learning rate: 0.05
Batch [0/704] training loss = 0.6817, training acc = 0.78
Batch [200/704] training loss = 0.8491, training acc = 0.67
Batch [400/704] training loss = 0.9080, training acc = 0.67
Batch [600/704] training loss = 0.7930, training acc = 0.70
Valid Test with nat
Test accuracy: 76.60% (3830/5000), Test loss:0.6971
Best model so far saved in ./trained_models_new/cifar/vgg16/training/nat/train_lr0.1_warmup0.01.pth
Test on test set:
Test accuracy: 75.83% (7583/10000), Test loss:0.7205
Epoch [5/100], Passed time:[107.410/537.049]
learning rate: 0.06000000000000001
Batch [0/704] training loss = 0.7846, training acc = 0.73
Batch [200/704] training loss = 0.4965, training acc = 0.83
Batch [400/704] training loss = 0.7994, training acc = 0.75
Batch [600/704] training loss = 0.8361, training acc = 0.75
Valid Test with nat
Test accuracy: 66.68% (3334/5000), Test loss:1.0648
Epoch [6/100], Passed time:[110.338/662.025]
learning rate: 0.07
Batch [0/704] training loss = 0.8011, training acc = 0.70
Batch [200/704] training loss = 0.6526, training acc = 0.81
Batch [400/704] training loss = 0.5613, training acc = 0.84
Batch [600/704] training loss = 0.8293, training acc = 0.72
Valid Test with nat
Test accuracy: 74.58% (3729/5000), Test loss:0.7574
Epoch [7/100], Passed time:[112.996/790.972]
learning rate: 0.08000000000000002
Batch [0/704] training loss = 0.5041, training acc = 0.81
Batch [200/704] training loss = 0.5400, training acc = 0.84
Batch [400/704] training loss = 0.8581, training acc = 0.75
Batch [600/704] training loss = 0.5925, training acc = 0.77
Valid Test with nat
Test accuracy: 76.66% (3833/5000), Test loss:0.7007
Epoch [8/100], Passed time:[114.252/914.015]
learning rate: 0.09000000000000001
Batch [0/704] training loss = 0.5607, training acc = 0.81
Batch [200/704] training loss = 1.0975, training acc = 0.70
Batch [400/704] training loss = 0.6345, training acc = 0.77
Batch [600/704] training loss = 0.4538, training acc = 0.88
Valid Test with nat
Test accuracy: 76.66% (3833/5000), Test loss:0.7603
Epoch [9/100], Passed time:[115.760/1041.838]
learning rate: 0.1
Batch [0/704] training loss = 0.5758, training acc = 0.81
Batch [200/704] training loss = 0.4546, training acc = 0.84
Batch [400/704] training loss = 0.7749, training acc = 0.83
Batch [600/704] training loss = 0.6449, training acc = 0.80
Valid Test with nat
Test accuracy: 76.32% (3816/5000), Test loss:0.6896
Best model so far saved in ./trained_models_new/cifar/vgg16/training/nat/train_lr0.1_warmup0.01.pth
Test on test set:
Test accuracy: 75.48% (7548/10000), Test loss:0.7060
Epoch [10/100], Passed time:[117.571/1175.707]
learning rate: 0.1
Batch [0/704] training loss = 0.4053, training acc = 0.89
Batch [200/704] training loss = 0.4626, training acc = 0.80
Batch [400/704] training loss = 0.3813, training acc = 0.86
Batch [600/704] training loss = 0.6696, training acc = 0.78
Valid Test with nat
Test accuracy: 77.18% (3859/5000), Test loss:0.6912
Epoch [11/100], Passed time:[118.466/1303.127]
learning rate: 0.1
Batch [0/704] training loss = 0.6187, training acc = 0.77
Batch [200/704] training loss = 0.3306, training acc = 0.89
Batch [400/704] training loss = 0.3576, training acc = 0.88
Batch [600/704] training loss = 0.3372, training acc = 0.88
Valid Test with nat
Test accuracy: 78.70% (3935/5000), Test loss:0.6926
Epoch [12/100], Passed time:[119.178/1430.139]
learning rate: 0.1
Batch [0/704] training loss = 0.4722, training acc = 0.83
Batch [200/704] training loss = 0.4999, training acc = 0.88
Batch [400/704] training loss = 0.3937, training acc = 0.84
Batch [600/704] training loss = 0.4813, training acc = 0.81
Valid Test with nat
Test accuracy: 80.08% (4004/5000), Test loss:0.6006
Best model so far saved in ./trained_models_new/cifar/vgg16/training/nat/train_lr0.1_warmup0.01.pth
Test on test set:
Test accuracy: 81.17% (8117/10000), Test loss:0.5696
Epoch [13/100], Passed time:[119.969/1559.600]
learning rate: 0.1
Batch [0/704] training loss = 0.4274, training acc = 0.86
Batch [200/704] training loss = 0.5489, training acc = 0.83
Batch [400/704] training loss = 0.4887, training acc = 0.86
Batch [600/704] training loss = 0.5892, training acc = 0.80
Valid Test with nat
Test accuracy: 84.66% (4233/5000), Test loss:0.4601
Best model so far saved in ./trained_models_new/cifar/vgg16/training/nat/train_lr0.1_warmup0.01.pth
Test on test set:
Test accuracy: 85.05% (8505/10000), Test loss:0.4621
Epoch [14/100], Passed time:[120.681/1689.529]
learning rate: 0.1
Batch [0/704] training loss = 0.3672, training acc = 0.92
Batch [200/704] training loss = 0.5046, training acc = 0.83
Batch [400/704] training loss = 0.5523, training acc = 0.83
Batch [600/704] training loss = 0.2752, training acc = 0.89
Valid Test with nat
Test accuracy: 82.40% (4120/5000), Test loss:0.5457
Epoch [15/100], Passed time:[121.210/1818.155]
learning rate: 0.1
Batch [0/704] training loss = 0.4175, training acc = 0.86
Batch [200/704] training loss = 0.3715, training acc = 0.86
Batch [400/704] training loss = 0.5008, training acc = 0.83
Batch [600/704] training loss = 0.4471, training acc = 0.84
Valid Test with nat
Test accuracy: 82.46% (4123/5000), Test loss:0.5479
Epoch [16/100], Passed time:[121.427/1942.837]
learning rate: 0.1
Batch [0/704] training loss = 0.2936, training acc = 0.89
Batch [200/704] training loss = 0.3515, training acc = 0.86
Batch [400/704] training loss = 0.6349, training acc = 0.80
Batch [600/704] training loss = 0.2230, training acc = 0.95
Valid Test with nat
Test accuracy: 83.30% (4165/5000), Test loss:0.5282
Epoch [17/100], Passed time:[121.023/2057.388]
learning rate: 0.1
Batch [0/704] training loss = 0.4094, training acc = 0.88
Batch [200/704] training loss = 0.3369, training acc = 0.89
Batch [400/704] training loss = 0.2213, training acc = 0.95
Batch [600/704] training loss = 0.4832, training acc = 0.83
Valid Test with nat
Test accuracy: 84.72% (4236/5000), Test loss:0.4773
Epoch [18/100], Passed time:[120.409/2167.370]
learning rate: 0.1
Batch [0/704] training loss = 0.3453, training acc = 0.89
Batch [200/704] training loss = 0.5071, training acc = 0.81
Batch [400/704] training loss = 0.3565, training acc = 0.88
Batch [600/704] training loss = 0.2746, training acc = 0.94
Valid Test with nat
Test accuracy: 82.26% (4113/5000), Test loss:0.5524
Epoch [19/100], Passed time:[120.839/2295.945]
learning rate: 0.1
Batch [0/704] training loss = 0.3776, training acc = 0.88
Batch [200/704] training loss = 0.2648, training acc = 0.92
Batch [400/704] training loss = 0.3541, training acc = 0.92
Batch [600/704] training loss = 0.4594, training acc = 0.86
Valid Test with nat
Test accuracy: 81.86% (4093/5000), Test loss:0.5608
Epoch [20/100], Passed time:[121.916/2438.314]
learning rate: 0.1
Batch [0/704] training loss = 0.3360, training acc = 0.91
Batch [200/704] training loss = 0.5738, training acc = 0.83
Batch [400/704] training loss = 0.5636, training acc = 0.83
Batch [600/704] training loss = 0.2205, training acc = 0.92
Valid Test with nat
Test accuracy: 84.10% (4205/5000), Test loss:0.4903
Epoch [21/100], Passed time:[123.054/2584.132]
learning rate: 0.1
Batch [0/704] training loss = 0.3164, training acc = 0.94
Batch [200/704] training loss = 0.1846, training acc = 0.95
Batch [400/704] training loss = 0.3411, training acc = 0.91
Batch [600/704] training loss = 0.3752, training acc = 0.88
Valid Test with nat
Test accuracy: 84.52% (4226/5000), Test loss:0.4901
Epoch [22/100], Passed time:[124.265/2733.827]
learning rate: 0.1
Batch [0/704] training loss = 0.2025, training acc = 0.97
Batch [200/704] training loss = 0.2727, training acc = 0.91
Batch [400/704] training loss = 0.4199, training acc = 0.81
Batch [600/704] training loss = 0.3112, training acc = 0.86
Valid Test with nat
Test accuracy: 85.20% (4260/5000), Test loss:0.4509
Best model so far saved in ./trained_models_new/cifar/vgg16/training/nat/train_lr0.1_warmup0.01.pth
Test on test set:
Test accuracy: 84.90% (8490/10000), Test loss:0.4679
Epoch [23/100], Passed time:[125.463/2885.639]
learning rate: 0.1
Batch [0/704] training loss = 0.3333, training acc = 0.83
Batch [200/704] training loss = 0.4616, training acc = 0.86
Batch [400/704] training loss = 0.2651, training acc = 0.92
Batch [600/704] training loss = 0.3642, training acc = 0.89
Valid Test with nat
Test accuracy: 85.30% (4265/5000), Test loss:0.4596
Epoch [24/100], Passed time:[126.466/3035.176]
learning rate: 0.1
Batch [0/704] training loss = 0.3035, training acc = 0.92
Batch [200/704] training loss = 0.4144, training acc = 0.81
Batch [400/704] training loss = 0.2954, training acc = 0.89
Batch [600/704] training loss = 0.3701, training acc = 0.88
Valid Test with nat
Test accuracy: 85.68% (4284/5000), Test loss:0.4514
Epoch [25/100], Passed time:[127.316/3182.906]
learning rate: 0.1
Batch [0/704] training loss = 0.4820, training acc = 0.81
Batch [200/704] training loss = 0.2384, training acc = 0.95
Batch [400/704] training loss = 0.2667, training acc = 0.91
Batch [600/704] training loss = 0.2048, training acc = 0.91
Valid Test with nat
Test accuracy: 83.94% (4197/5000), Test loss:0.5132
Epoch [26/100], Passed time:[128.120/3331.125]
learning rate: 0.1
Batch [0/704] training loss = 0.3506, training acc = 0.88
Batch [200/704] training loss = 0.5784, training acc = 0.86
Batch [400/704] training loss = 0.3637, training acc = 0.86
Batch [600/704] training loss = 0.3196, training acc = 0.92
Valid Test with nat
Test accuracy: 86.32% (4316/5000), Test loss:0.4192
Best model so far saved in ./trained_models_new/cifar/vgg16/training/nat/train_lr0.1_warmup0.01.pth
Test on test set:
Test accuracy: 86.00% (8600/10000), Test loss:0.4309
Epoch [27/100], Passed time:[128.949/3481.633]
learning rate: 0.1
Batch [0/704] training loss = 0.4671, training acc = 0.81
Batch [200/704] training loss = 0.4398, training acc = 0.84
Batch [400/704] training loss = 0.2465, training acc = 0.94
Batch [600/704] training loss = 0.4772, training acc = 0.83
Valid Test with nat
Test accuracy: 82.56% (4128/5000), Test loss:0.5526
Epoch [28/100], Passed time:[129.732/3632.495]
learning rate: 0.1
Batch [0/704] training loss = 0.4104, training acc = 0.86
Batch [200/704] training loss = 0.5319, training acc = 0.83
Batch [400/704] training loss = 0.4666, training acc = 0.88
Batch [600/704] training loss = 0.3220, training acc = 0.89
Valid Test with nat
Test accuracy: 85.78% (4289/5000), Test loss:0.4575
Epoch [29/100], Passed time:[130.522/3785.133]
learning rate: 0.1
Batch [0/704] training loss = 0.3583, training acc = 0.84
Batch [200/704] training loss = 0.1392, training acc = 0.97
Batch [400/704] training loss = 0.4016, training acc = 0.83
Batch [600/704] training loss = 0.3752, training acc = 0.88
Valid Test with nat
Test accuracy: 86.82% (4341/5000), Test loss:0.4112
Best model so far saved in ./trained_models_new/cifar/vgg16/training/nat/train_lr0.1_warmup0.01.pth
Test on test set:
Test accuracy: 86.85% (8685/10000), Test loss:0.4206
Epoch [30/100], Passed time:[131.382/3941.474]
learning rate: 0.1
Batch [0/704] training loss = 0.1497, training acc = 0.97
Batch [200/704] training loss = 0.2063, training acc = 0.94
Batch [400/704] training loss = 0.5137, training acc = 0.83
Batch [600/704] training loss = 0.3905, training acc = 0.86
Valid Test with nat
Test accuracy: 83.12% (4156/5000), Test loss:0.5418
Epoch [31/100], Passed time:[131.995/4091.851]
learning rate: 0.1
Batch [0/704] training loss = 0.3299, training acc = 0.89
Batch [200/704] training loss = 0.2104, training acc = 0.91
Batch [400/704] training loss = 0.4707, training acc = 0.84
Batch [600/704] training loss = 0.3164, training acc = 0.86
Valid Test with nat
Test accuracy: 83.26% (4163/5000), Test loss:0.5072
Epoch [32/100], Passed time:[132.478/4239.301]
learning rate: 0.1
Batch [0/704] training loss = 0.1861, training acc = 0.94
Batch [200/704] training loss = 0.4145, training acc = 0.89
Batch [400/704] training loss = 0.4337, training acc = 0.88
Batch [600/704] training loss = 0.2931, training acc = 0.89
Valid Test with nat
Test accuracy: 86.06% (4303/5000), Test loss:0.4223
Epoch [33/100], Passed time:[132.857/4384.271]
learning rate: 0.1
Batch [0/704] training loss = 0.3093, training acc = 0.92
Batch [200/704] training loss = 0.2907, training acc = 0.88
Batch [400/704] training loss = 0.4845, training acc = 0.86
Batch [600/704] training loss = 0.4089, training acc = 0.88
Valid Test with nat
Test accuracy: 86.30% (4315/5000), Test loss:0.4349
Epoch [34/100], Passed time:[133.331/4533.246]
learning rate: 0.1
Batch [0/704] training loss = 0.1826, training acc = 0.92
Batch [200/704] training loss = 0.2377, training acc = 0.91
Batch [400/704] training loss = 0.4883, training acc = 0.83
Batch [600/704] training loss = 0.3461, training acc = 0.84
Valid Test with nat
Test accuracy: 85.34% (4267/5000), Test loss:0.4826
Epoch [35/100], Passed time:[133.729/4680.510]
learning rate: 0.1
Batch [0/704] training loss = 0.3009, training acc = 0.89
Batch [200/704] training loss = 0.2200, training acc = 0.91
Batch [400/704] training loss = 0.1843, training acc = 0.94
Batch [600/704] training loss = 0.3298, training acc = 0.88
Valid Test with nat
Test accuracy: 86.00% (4300/5000), Test loss:0.4297
Epoch [36/100], Passed time:[134.266/4833.586]
learning rate: 0.1
Batch [0/704] training loss = 0.3868, training acc = 0.88
Batch [200/704] training loss = 0.2853, training acc = 0.89
Batch [400/704] training loss = 0.4430, training acc = 0.88
Batch [600/704] training loss = 0.2270, training acc = 0.92
Valid Test with nat
Test accuracy: 87.04% (4352/5000), Test loss:0.3837
Best model so far saved in ./trained_models_new/cifar/vgg16/training/nat/train_lr0.1_warmup0.01.pth
Test on test set:
Test accuracy: 87.15% (8715/10000), Test loss:0.3930
Epoch [37/100], Passed time:[134.876/4990.416]
learning rate: 0.1
Batch [0/704] training loss = 0.3452, training acc = 0.88
Batch [200/704] training loss = 0.2880, training acc = 0.91
Batch [400/704] training loss = 0.3357, training acc = 0.89
Batch [600/704] training loss = 0.2475, training acc = 0.92
Valid Test with nat
Test accuracy: 86.16% (4308/5000), Test loss:0.4838
Epoch [38/100], Passed time:[135.198/5137.518]
learning rate: 0.1
Batch [0/704] training loss = 0.3755, training acc = 0.86
Batch [200/704] training loss = 0.1735, training acc = 0.95
Batch [400/704] training loss = 0.3030, training acc = 0.89
Batch [600/704] training loss = 0.2985, training acc = 0.92
Valid Test with nat
Test accuracy: 85.60% (4280/5000), Test loss:0.4628
Epoch [39/100], Passed time:[135.658/5290.648]
learning rate: 0.1
Batch [0/704] training loss = 0.3180, training acc = 0.86
Batch [200/704] training loss = 0.4251, training acc = 0.86
Batch [400/704] training loss = 0.3976, training acc = 0.88
Batch [600/704] training loss = 0.3629, training acc = 0.91
Valid Test with nat
Test accuracy: 84.96% (4248/5000), Test loss:0.5037
Epoch [40/100], Passed time:[136.015/5440.582]
learning rate: 0.1
Batch [0/704] training loss = 0.4476, training acc = 0.84
Batch [200/704] training loss = 0.2758, training acc = 0.91
Batch [400/704] training loss = 0.4377, training acc = 0.84
Batch [600/704] training loss = 0.3340, training acc = 0.88
Valid Test with nat
Test accuracy: 82.58% (4129/5000), Test loss:0.5938
Epoch [41/100], Passed time:[136.359/5590.714]
learning rate: 0.1
Batch [0/704] training loss = 0.1497, training acc = 0.94
Batch [200/704] training loss = 0.2287, training acc = 0.94
Batch [400/704] training loss = 0.4291, training acc = 0.86
Batch [600/704] training loss = 0.3552, training acc = 0.91
Valid Test with nat
Test accuracy: 87.62% (4381/5000), Test loss:0.3824
Best model so far saved in ./trained_models_new/cifar/vgg16/training/nat/train_lr0.1_warmup0.01.pth
Test on test set:
Test accuracy: 87.29% (8729/10000), Test loss:0.3919
Epoch [42/100], Passed time:[136.824/5746.623]
learning rate: 0.1
Batch [0/704] training loss = 0.3303, training acc = 0.89
Batch [200/704] training loss = 0.3013, training acc = 0.89
Batch [400/704] training loss = 0.4629, training acc = 0.83
Batch [600/704] training loss = 0.4349, training acc = 0.80
Valid Test with nat
Test accuracy: 86.70% (4335/5000), Test loss:0.4385
Epoch [43/100], Passed time:[137.106/5895.558]
learning rate: 0.1
Batch [0/704] training loss = 0.3854, training acc = 0.86
Batch [200/704] training loss = 0.4516, training acc = 0.88
Batch [400/704] training loss = 0.3516, training acc = 0.88
Batch [600/704] training loss = 0.3308, training acc = 0.89
Valid Test with nat
Test accuracy: 86.76% (4338/5000), Test loss:0.4085
Epoch [44/100], Passed time:[137.382/6044.810]
learning rate: 0.1
Batch [0/704] training loss = 0.1572, training acc = 0.97
Batch [200/704] training loss = 0.1736, training acc = 0.94
Batch [400/704] training loss = 0.3060, training acc = 0.88
Batch [600/704] training loss = 0.3187, training acc = 0.92
Valid Test with nat
Test accuracy: 86.08% (4304/5000), Test loss:0.4578
Epoch [45/100], Passed time:[137.667/6195.001]
learning rate: 0.1
Batch [0/704] training loss = 0.4212, training acc = 0.84
Batch [200/704] training loss = 0.4214, training acc = 0.86
Batch [400/704] training loss = 0.4149, training acc = 0.88
Batch [600/704] training loss = 0.2651, training acc = 0.89
Valid Test with nat
Test accuracy: 87.86% (4393/5000), Test loss:0.3846
Epoch [46/100], Passed time:[137.905/6343.631]
learning rate: 0.1
Batch [0/704] training loss = 0.1799, training acc = 0.92
Batch [200/704] training loss = 0.3642, training acc = 0.88
Batch [400/704] training loss = 0.2166, training acc = 0.92
Batch [600/704] training loss = 0.3616, training acc = 0.86
Valid Test with nat
Test accuracy: 86.86% (4343/5000), Test loss:0.4171
Epoch [47/100], Passed time:[138.241/6497.316]
learning rate: 0.1
Batch [0/704] training loss = 0.2969, training acc = 0.89
Batch [200/704] training loss = 0.2090, training acc = 0.92
Batch [400/704] training loss = 0.2056, training acc = 0.94
Batch [600/704] training loss = 0.3226, training acc = 0.91
Valid Test with nat
Test accuracy: 81.80% (4090/5000), Test loss:0.6230
Epoch [48/100], Passed time:[137.926/6620.428]
learning rate: 0.1
Batch [0/704] training loss = 0.3656, training acc = 0.84
Batch [200/704] training loss = 0.2766, training acc = 0.89
Batch [400/704] training loss = 0.3441, training acc = 0.86
Batch [600/704] training loss = 0.4729, training acc = 0.89
Valid Test with nat
Test accuracy: 85.44% (4272/5000), Test loss:0.4474
Epoch [49/100], Passed time:[137.763/6750.389]
learning rate: 0.1
Batch [0/704] training loss = 0.2522, training acc = 0.91
Batch [200/704] training loss = 0.2063, training acc = 0.92
Batch [400/704] training loss = 0.5938, training acc = 0.86
Batch [600/704] training loss = 0.2052, training acc = 0.94
Valid Test with nat
Test accuracy: 84.18% (4209/5000), Test loss:0.4998
Epoch [50/100], Passed time:[138.066/6903.302]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.1969, training acc = 0.94
Batch [200/704] training loss = 0.1541, training acc = 0.92
Batch [400/704] training loss = 0.0697, training acc = 0.97
Batch [600/704] training loss = 0.0567, training acc = 0.98
Valid Test with nat
Test accuracy: 92.26% (4613/5000), Test loss:0.2572
Best model so far saved in ./trained_models_new/cifar/vgg16/training/nat/train_lr0.1_warmup0.01.pth
Test on test set:
Test accuracy: 91.97% (9197/10000), Test loss:0.2542
Epoch [51/100], Passed time:[138.531/7065.056]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.1646, training acc = 0.92
Batch [200/704] training loss = 0.0965, training acc = 0.98
Batch [400/704] training loss = 0.2074, training acc = 0.94
Batch [600/704] training loss = 0.1406, training acc = 0.95
Valid Test with nat
Test accuracy: 92.72% (4636/5000), Test loss:0.2484
Best model so far saved in ./trained_models_new/cifar/vgg16/training/nat/train_lr0.1_warmup0.01.pth
Test on test set:
Test accuracy: 92.17% (9217/10000), Test loss:0.2490
Epoch [52/100], Passed time:[138.915/7223.587]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.0375, training acc = 0.98
Batch [200/704] training loss = 0.0873, training acc = 0.95
Batch [400/704] training loss = 0.1233, training acc = 0.94
Batch [600/704] training loss = 0.0668, training acc = 0.97
Valid Test with nat
Test accuracy: 92.66% (4633/5000), Test loss:0.2495
Epoch [53/100], Passed time:[139.273/7381.461]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.2206, training acc = 0.95
Batch [200/704] training loss = 0.1041, training acc = 0.97
Batch [400/704] training loss = 0.1246, training acc = 0.95
Batch [600/704] training loss = 0.0201, training acc = 1.00
Valid Test with nat
Test accuracy: 92.68% (4634/5000), Test loss:0.2470
Best model so far saved in ./trained_models_new/cifar/vgg16/training/nat/train_lr0.1_warmup0.01.pth
Test on test set:
Test accuracy: 92.47% (9247/10000), Test loss:0.2507
Epoch [54/100], Passed time:[139.589/7537.821]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.1266, training acc = 0.94
Batch [200/704] training loss = 0.1576, training acc = 0.94
Batch [400/704] training loss = 0.1880, training acc = 0.92
Batch [600/704] training loss = 0.0103, training acc = 1.00
Valid Test with nat
Test accuracy: 92.60% (4630/5000), Test loss:0.2596
Epoch [55/100], Passed time:[139.828/7690.551]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.1338, training acc = 0.94
Batch [200/704] training loss = 0.1115, training acc = 0.95
Batch [400/704] training loss = 0.0915, training acc = 0.97
Batch [600/704] training loss = 0.0285, training acc = 1.00
Valid Test with nat
Test accuracy: 92.92% (4646/5000), Test loss:0.2571
Epoch [56/100], Passed time:[140.028/7841.542]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.0170, training acc = 1.00
Batch [200/704] training loss = 0.0316, training acc = 1.00
Batch [400/704] training loss = 0.0217, training acc = 1.00
Batch [600/704] training loss = 0.0746, training acc = 0.97
Valid Test with nat
Test accuracy: 92.66% (4633/5000), Test loss:0.2612
Epoch [57/100], Passed time:[140.280/7995.945]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.1654, training acc = 0.94
Batch [200/704] training loss = 0.0723, training acc = 0.98
Batch [400/704] training loss = 0.0110, training acc = 1.00
Batch [600/704] training loss = 0.0340, training acc = 1.00
Valid Test with nat
Test accuracy: 92.42% (4621/5000), Test loss:0.2637
Epoch [58/100], Passed time:[140.473/8147.456]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.0688, training acc = 0.97
Batch [200/704] training loss = 0.0947, training acc = 0.97
Batch [400/704] training loss = 0.0583, training acc = 0.98
Batch [600/704] training loss = 0.0642, training acc = 0.98
Valid Test with nat
Test accuracy: 93.08% (4654/5000), Test loss:0.2599
Epoch [59/100], Passed time:[140.617/8296.383]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.0711, training acc = 0.97
Batch [200/704] training loss = 0.0819, training acc = 0.97
Batch [400/704] training loss = 0.0444, training acc = 0.98
Batch [600/704] training loss = 0.0106, training acc = 1.00
Valid Test with nat
Test accuracy: 93.00% (4650/5000), Test loss:0.2602
Epoch [60/100], Passed time:[140.853/8451.152]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.0177, training acc = 1.00
Batch [200/704] training loss = 0.0418, training acc = 0.98
Batch [400/704] training loss = 0.0563, training acc = 0.97
Batch [600/704] training loss = 0.1259, training acc = 0.95
Valid Test with nat
Test accuracy: 92.86% (4643/5000), Test loss:0.2624
Epoch [61/100], Passed time:[141.069/8605.208]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.0425, training acc = 0.98
Batch [200/704] training loss = 0.0136, training acc = 1.00
Batch [400/704] training loss = 0.1477, training acc = 0.95
Batch [600/704] training loss = 0.0794, training acc = 0.98
Valid Test with nat
Test accuracy: 92.86% (4643/5000), Test loss:0.2709
Epoch [62/100], Passed time:[141.313/8761.434]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.0370, training acc = 0.98
Batch [200/704] training loss = 0.0968, training acc = 0.97
Batch [400/704] training loss = 0.0397, training acc = 0.98
Batch [600/704] training loss = 0.0923, training acc = 0.95
Valid Test with nat
Test accuracy: 92.78% (4639/5000), Test loss:0.2696
Epoch [63/100], Passed time:[141.534/8916.644]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.0184, training acc = 1.00
Batch [200/704] training loss = 0.0065, training acc = 1.00
Batch [400/704] training loss = 0.0276, training acc = 1.00
Batch [600/704] training loss = 0.0777, training acc = 0.95
Valid Test with nat
Test accuracy: 92.80% (4640/5000), Test loss:0.2725
Epoch [64/100], Passed time:[141.684/9067.745]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.0239, training acc = 1.00
Batch [200/704] training loss = 0.0172, training acc = 1.00
Batch [400/704] training loss = 0.0215, training acc = 0.98
Batch [600/704] training loss = 0.0337, training acc = 1.00
Valid Test with nat
Test accuracy: 92.80% (4640/5000), Test loss:0.2723
Epoch [65/100], Passed time:[141.904/9223.753]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.0237, training acc = 1.00
Batch [200/704] training loss = 0.1541, training acc = 0.94
Batch [400/704] training loss = 0.0047, training acc = 1.00
Batch [600/704] training loss = 0.0642, training acc = 0.98
Valid Test with nat
Test accuracy: 92.90% (4645/5000), Test loss:0.2720
Epoch [66/100], Passed time:[142.055/9375.632]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.0252, training acc = 0.98
Batch [200/704] training loss = 0.0477, training acc = 0.98
Batch [400/704] training loss = 0.0597, training acc = 0.98
Batch [600/704] training loss = 0.0665, training acc = 0.98
Valid Test with nat
Test accuracy: 92.90% (4645/5000), Test loss:0.2731
Epoch [67/100], Passed time:[142.239/9530.001]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.0157, training acc = 1.00
Batch [200/704] training loss = 0.0455, training acc = 0.97
Batch [400/704] training loss = 0.1722, training acc = 0.95
Batch [600/704] training loss = 0.0212, training acc = 0.98
Valid Test with nat
Test accuracy: 92.86% (4643/5000), Test loss:0.2873
Epoch [68/100], Passed time:[142.427/9685.032]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.0688, training acc = 0.98
Batch [200/704] training loss = 0.0393, training acc = 0.98
Batch [400/704] training loss = 0.0237, training acc = 1.00
Batch [600/704] training loss = 0.0955, training acc = 0.97
Valid Test with nat
Test accuracy: 92.94% (4647/5000), Test loss:0.2779
Epoch [69/100], Passed time:[142.611/9840.169]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.0120, training acc = 1.00
Batch [200/704] training loss = 0.0127, training acc = 1.00
Batch [400/704] training loss = 0.0175, training acc = 1.00
Batch [600/704] training loss = 0.0580, training acc = 0.98
Valid Test with nat
Test accuracy: 93.10% (4655/5000), Test loss:0.2760
Epoch [70/100], Passed time:[142.801/9996.088]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.0534, training acc = 0.97
Batch [200/704] training loss = 0.0586, training acc = 0.97
Batch [400/704] training loss = 0.0944, training acc = 0.95
Batch [600/704] training loss = 0.0577, training acc = 0.98
Valid Test with nat
Test accuracy: 93.18% (4659/5000), Test loss:0.2822
Epoch [71/100], Passed time:[142.986/10152.034]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.0150, training acc = 1.00
Batch [200/704] training loss = 0.0343, training acc = 0.98
Batch [400/704] training loss = 0.0914, training acc = 0.97
Batch [600/704] training loss = 0.1178, training acc = 0.97
Valid Test with nat
Test accuracy: 93.04% (4652/5000), Test loss:0.2725
Epoch [72/100], Passed time:[143.116/10304.327]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.0959, training acc = 0.95
Batch [200/704] training loss = 0.0114, training acc = 1.00
Batch [400/704] training loss = 0.0858, training acc = 0.97
Batch [600/704] training loss = 0.0439, training acc = 0.98
Valid Test with nat
Test accuracy: 93.44% (4672/5000), Test loss:0.2667
Epoch [73/100], Passed time:[143.241/10456.628]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.0435, training acc = 0.97
Batch [200/704] training loss = 0.0873, training acc = 0.95
Batch [400/704] training loss = 0.1292, training acc = 0.97
Batch [600/704] training loss = 0.0362, training acc = 0.97
Valid Test with nat
Test accuracy: 92.98% (4649/5000), Test loss:0.2801
Epoch [74/100], Passed time:[143.370/10609.370]
learning rate: 0.010000000000000002
Batch [0/704] training loss = 0.0279, training acc = 1.00
Batch [200/704] training loss = 0.0420, training acc = 0.97
Batch [400/704] training loss = 0.0872, training acc = 0.97
Batch [600/704] training loss = 0.1924, training acc = 0.95
Valid Test with nat
Test accuracy: 92.78% (4639/5000), Test loss:0.2908
Epoch [75/100], Passed time:[143.514/10763.532]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0515, training acc = 0.95
Batch [200/704] training loss = 0.0104, training acc = 1.00
Batch [400/704] training loss = 0.0097, training acc = 1.00
Batch [600/704] training loss = 0.0346, training acc = 0.98
Valid Test with nat
Test accuracy: 93.18% (4659/5000), Test loss:0.2884
Epoch [76/100], Passed time:[143.673/10919.168]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0696, training acc = 0.98
Batch [200/704] training loss = 0.0221, training acc = 0.98
Batch [400/704] training loss = 0.0145, training acc = 1.00
Batch [600/704] training loss = 0.0099, training acc = 1.00
Valid Test with nat
Test accuracy: 93.32% (4666/5000), Test loss:0.2739
Epoch [77/100], Passed time:[143.786/11071.546]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0621, training acc = 0.97
Batch [200/704] training loss = 0.0054, training acc = 1.00
Batch [400/704] training loss = 0.0105, training acc = 1.00
Batch [600/704] training loss = 0.1054, training acc = 0.97
Valid Test with nat
Test accuracy: 93.34% (4667/5000), Test loss:0.2710
Epoch [78/100], Passed time:[143.951/11228.161]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.1210, training acc = 0.95
Batch [200/704] training loss = 0.0742, training acc = 0.97
Batch [400/704] training loss = 0.1178, training acc = 0.97
Batch [600/704] training loss = 0.0453, training acc = 0.98
Valid Test with nat
Test accuracy: 93.38% (4669/5000), Test loss:0.2709
Epoch [79/100], Passed time:[143.961/11372.888]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0058, training acc = 1.00
Batch [200/704] training loss = 0.0081, training acc = 1.00
Batch [400/704] training loss = 0.0183, training acc = 1.00
Batch [600/704] training loss = 0.0069, training acc = 1.00
Valid Test with nat
Test accuracy: 93.38% (4669/5000), Test loss:0.2700
Epoch [80/100], Passed time:[143.995/11519.574]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0751, training acc = 0.98
Batch [200/704] training loss = 0.0188, training acc = 0.98
Batch [400/704] training loss = 0.0125, training acc = 1.00
Batch [600/704] training loss = 0.0477, training acc = 0.97
Valid Test with nat
Test accuracy: 93.72% (4686/5000), Test loss:0.2735
Epoch [81/100], Passed time:[144.087/11671.028]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0102, training acc = 1.00
Batch [200/704] training loss = 0.1066, training acc = 0.97
Batch [400/704] training loss = 0.0564, training acc = 0.97
Batch [600/704] training loss = 0.0020, training acc = 1.00
Valid Test with nat
Test accuracy: 93.62% (4681/5000), Test loss:0.2772
Epoch [82/100], Passed time:[144.174/11822.260]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0024, training acc = 1.00
Batch [200/704] training loss = 0.0099, training acc = 1.00
Batch [400/704] training loss = 0.0072, training acc = 1.00
Batch [600/704] training loss = 0.0126, training acc = 1.00
Valid Test with nat
Test accuracy: 93.58% (4679/5000), Test loss:0.2792
Epoch [83/100], Passed time:[144.254/11973.060]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0297, training acc = 0.98
Batch [200/704] training loss = 0.0112, training acc = 1.00
Batch [400/704] training loss = 0.0058, training acc = 1.00
Batch [600/704] training loss = 0.0155, training acc = 1.00
Valid Test with nat
Test accuracy: 93.78% (4689/5000), Test loss:0.2798
Epoch [84/100], Passed time:[144.312/12122.241]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0048, training acc = 1.00
Batch [200/704] training loss = 0.0424, training acc = 0.98
Batch [400/704] training loss = 0.0055, training acc = 1.00
Batch [600/704] training loss = 0.0024, training acc = 1.00
Valid Test with nat
Test accuracy: 93.76% (4688/5000), Test loss:0.2705
Epoch [85/100], Passed time:[144.364/12270.946]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0028, training acc = 1.00
Batch [200/704] training loss = 0.0042, training acc = 1.00
Batch [400/704] training loss = 0.0611, training acc = 0.97
Batch [600/704] training loss = 0.0979, training acc = 0.97
Valid Test with nat
Test accuracy: 93.66% (4683/5000), Test loss:0.2721
Epoch [86/100], Passed time:[144.463/12423.843]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0023, training acc = 1.00
Batch [200/704] training loss = 0.0066, training acc = 1.00
Batch [400/704] training loss = 0.0021, training acc = 1.00
Batch [600/704] training loss = 0.0074, training acc = 1.00
Valid Test with nat
Test accuracy: 93.78% (4689/5000), Test loss:0.2738
Epoch [87/100], Passed time:[144.524/12573.578]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0059, training acc = 1.00
Batch [200/704] training loss = 0.0016, training acc = 1.00
Batch [400/704] training loss = 0.0096, training acc = 1.00
Batch [600/704] training loss = 0.0287, training acc = 0.98
Valid Test with nat
Test accuracy: 93.66% (4683/5000), Test loss:0.2783
Epoch [88/100], Passed time:[144.599/12724.669]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0412, training acc = 0.98
Batch [200/704] training loss = 0.0184, training acc = 0.98
Batch [400/704] training loss = 0.0045, training acc = 1.00
Batch [600/704] training loss = 0.0038, training acc = 1.00
Valid Test with nat
Test accuracy: 93.64% (4682/5000), Test loss:0.2768
Epoch [89/100], Passed time:[144.666/12875.245]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0049, training acc = 1.00
Batch [200/704] training loss = 0.0180, training acc = 0.98
Batch [400/704] training loss = 0.0051, training acc = 1.00
Batch [600/704] training loss = 0.0014, training acc = 1.00
Valid Test with nat
Test accuracy: 93.66% (4683/5000), Test loss:0.2863
Epoch [90/100], Passed time:[144.705/13023.491]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0197, training acc = 0.98
Batch [200/704] training loss = 0.0079, training acc = 1.00
Batch [400/704] training loss = 0.0187, training acc = 0.98
Batch [600/704] training loss = 0.0019, training acc = 1.00
Valid Test with nat
Test accuracy: 93.80% (4690/5000), Test loss:0.2722
Epoch [91/100], Passed time:[144.729/13170.347]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0018, training acc = 1.00
Batch [200/704] training loss = 0.0155, training acc = 1.00
Batch [400/704] training loss = 0.0117, training acc = 1.00
Batch [600/704] training loss = 0.0136, training acc = 1.00
Valid Test with nat
Test accuracy: 93.70% (4685/5000), Test loss:0.2739
Epoch [92/100], Passed time:[144.788/13320.529]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0045, training acc = 1.00
Batch [200/704] training loss = 0.0129, training acc = 1.00
Batch [400/704] training loss = 0.1268, training acc = 0.95
Batch [600/704] training loss = 0.0878, training acc = 0.95
Valid Test with nat
Test accuracy: 93.50% (4675/5000), Test loss:0.2795
Epoch [93/100], Passed time:[144.816/13467.896]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0365, training acc = 0.98
Batch [200/704] training loss = 0.0051, training acc = 1.00
Batch [400/704] training loss = 0.0147, training acc = 1.00
Batch [600/704] training loss = 0.0016, training acc = 1.00
Valid Test with nat
Test accuracy: 93.78% (4689/5000), Test loss:0.2875
Epoch [94/100], Passed time:[144.872/13618.014]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0839, training acc = 0.97
Batch [200/704] training loss = 0.0066, training acc = 1.00
Batch [400/704] training loss = 0.0046, training acc = 1.00
Batch [600/704] training loss = 0.0134, training acc = 1.00
Valid Test with nat
Test accuracy: 93.64% (4682/5000), Test loss:0.2767
Epoch [95/100], Passed time:[144.956/13770.797]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0107, training acc = 1.00
Batch [200/704] training loss = 0.0330, training acc = 0.98
Batch [400/704] training loss = 0.0025, training acc = 1.00
Batch [600/704] training loss = 0.0229, training acc = 1.00
Valid Test with nat
Test accuracy: 93.62% (4681/5000), Test loss:0.2792
Epoch [96/100], Passed time:[145.012/13921.153]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0075, training acc = 1.00
Batch [200/704] training loss = 0.0115, training acc = 1.00
Batch [400/704] training loss = 0.0188, training acc = 1.00
Batch [600/704] training loss = 0.0034, training acc = 1.00
Valid Test with nat
Test accuracy: 93.62% (4681/5000), Test loss:0.2735
Epoch [97/100], Passed time:[144.982/14063.289]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0085, training acc = 1.00
Batch [200/704] training loss = 0.0122, training acc = 1.00
Batch [400/704] training loss = 0.0054, training acc = 1.00
Batch [600/704] training loss = 0.0089, training acc = 1.00
Valid Test with nat
Test accuracy: 93.94% (4697/5000), Test loss:0.2814
Epoch [98/100], Passed time:[144.814/14191.816]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0053, training acc = 1.00
Batch [200/704] training loss = 0.0443, training acc = 0.98
Batch [400/704] training loss = 0.0059, training acc = 1.00
Batch [600/704] training loss = 0.0360, training acc = 0.98
Valid Test with nat
Test accuracy: 93.66% (4683/5000), Test loss:0.2765
Epoch [99/100], Passed time:[144.694/14324.720]
learning rate: 0.0010000000000000002
Batch [0/704] training loss = 0.0191, training acc = 0.98
Batch [200/704] training loss = 0.0150, training acc = 1.00
Batch [400/704] training loss = 0.0675, training acc = 0.97
Batch [600/704] training loss = 0.0178, training acc = 1.00
Valid Test with nat
Test accuracy: 93.72% (4686/5000), Test loss:0.2798
Training done, model saved in ./trained_models_new/cifar/vgg16/training/nat/train_lr0.1_warmup0.01.pth
Test on test set:
Test accuracy: 93.14% (9314/10000), Test loss:0.2910
