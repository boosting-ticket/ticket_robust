model_type : resnet18
init_type : pure
finetune_method : nat
enhance_method : nat
gpu : 6
model_name : init_enhance_m0.05_warmup0.1
model_width : 8
n_pruning_steps : 1
max_pruning_ratio : 32
train_epochs : 100
enhance_epochs : None
prune_method : unstructured
dataset : cifar
noise_sd : 1.0
trades_beta : 6.0
seed : 7
warmup : True
parallel : False
create_init : False
init_step : 1400
train_method : nat
early_stop : 1000
norm : True
optm : sgd
batch_size : 128
test_batch_size : 100
learning_rate : 0.1
enhance_learning_rate : 0.1
schedule_length : 10
weight_decay : 0.0001
epsilon : 0.03137254901960784
attack_iter : 10
eps_step : 0.00784313725490196
targeted : False
clip_min : 0
clip_max : 1.0
starting_epsilon : 1e-05
interval_weight : 0.1
ft_interval_weight : 50
verbose : 200
resume : 0
model_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r32/init_pure/init_enhance_m0.05_warmup0.1.pth
last_model_path : ./trained_models_new/
mask_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r32/init_pure/pruned_lr0.05_mask_r32.npy
mask_name : pruned_lr0.05_mask_r32
log_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r32/init_pure/init_enhance_m0.05_warmup0.1.log
init_path : ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
results_path : None
n_classes : 10
eval : False
init : True
transfer : False
CUDA enabled.
Enhance training config:
Enhance training method: nat
model will be saved in: ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r32/init_pure/init_enhance_m0.05_warmup0.1.pth
Init model is: ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
Init mask used from: ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r32/init_pure/pruned_lr0.05_mask_r32.npy
Log will be saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r32/init_pure/init_enhance_m0.05_warmup0.1.log
Random seed is: 7

model loading from ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
Epoch [0/100]
learning rate: 0.05
Batch [0/352] training loss = 2.1977, training acc = 0.18
Batch [200/352] training loss = 1.3802, training acc = 0.58
Valid Test with nat
Test accuracy: 60.40% (3020/5000), Test loss:1.2622
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r32/init_pure/init_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 60.51% (6051/10000), Test loss:1.2398
Epoch [1/100], Passed time:[77.163/77.163]
learning rate: 0.055
Batch [0/352] training loss = 0.9507, training acc = 0.64
Batch [200/352] training loss = 0.9065, training acc = 0.66
Valid Test with nat
Test accuracy: 69.96% (3498/5000), Test loss:0.9919
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r32/init_pure/init_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 70.08% (7008/10000), Test loss:0.9293
Epoch [2/100], Passed time:[80.017/160.035]
learning rate: 0.060000000000000005
Batch [0/352] training loss = 0.7676, training acc = 0.73
Batch [200/352] training loss = 0.6638, training acc = 0.77
Valid Test with nat
Test accuracy: 74.14% (3707/5000), Test loss:0.8048
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r32/init_pure/init_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 73.43% (7343/10000), Test loss:0.8318
Epoch [3/100], Passed time:[102.692/308.076]
learning rate: 0.065
Batch [0/352] training loss = 0.5665, training acc = 0.80
Batch [200/352] training loss = 0.5095, training acc = 0.82
Valid Test with nat
Test accuracy: 71.18% (3559/5000), Test loss:0.9717
Epoch [4/100], Passed time:[126.971/507.884]
learning rate: 0.07
Batch [0/352] training loss = 0.6316, training acc = 0.77
Batch [200/352] training loss = 0.5659, training acc = 0.80
Valid Test with nat
Test accuracy: 79.18% (3959/5000), Test loss:0.6214
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r32/init_pure/init_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 79.73% (7973/10000), Test loss:0.6174
Epoch [5/100], Passed time:[144.138/720.691]
learning rate: 0.07500000000000001
Batch [0/352] training loss = 0.4441, training acc = 0.81
Batch [200/352] training loss = 0.5387, training acc = 0.81
Valid Test with nat
Test accuracy: 80.64% (4032/5000), Test loss:0.5725
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r32/init_pure/init_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 81.69% (8169/10000), Test loss:0.5538
Epoch [6/100], Passed time:[153.411/920.466]
learning rate: 0.08000000000000002
Batch [0/352] training loss = 0.2815, training acc = 0.91
Batch [200/352] training loss = 0.4927, training acc = 0.81
Valid Test with nat
Test accuracy: 82.34% (4117/5000), Test loss:0.5682
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r32/init_pure/init_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 83.58% (8358/10000), Test loss:0.5337
Epoch [7/100], Passed time:[159.102/1113.716]
learning rate: 0.085
Batch [0/352] training loss = 0.2899, training acc = 0.88
Batch [200/352] training loss = 0.4674, training acc = 0.87
Valid Test with nat
Test accuracy: 81.82% (4091/5000), Test loss:0.5872
Epoch [8/100], Passed time:[161.995/1295.961]
learning rate: 0.09
Batch [0/352] training loss = 0.3927, training acc = 0.85
Batch [200/352] training loss = 0.5185, training acc = 0.83
Valid Test with nat
Test accuracy: 83.64% (4182/5000), Test loss:0.5219
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r32/init_pure/init_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 83.24% (8324/10000), Test loss:0.5615
Epoch [9/100], Passed time:[164.676/1482.087]
learning rate: 0.095
Batch [0/352] training loss = 0.3356, training acc = 0.88
Batch [200/352] training loss = 0.3786, training acc = 0.86
Valid Test with nat
Test accuracy: 81.72% (4086/5000), Test loss:0.6049
Epoch [10/100], Passed time:[165.714/1657.138]
learning rate: 0.1
Batch [0/352] training loss = 0.2791, training acc = 0.89
Batch [200/352] training loss = 0.2460, training acc = 0.90
Valid Test with nat
Test accuracy: 83.78% (4189/5000), Test loss:0.5140
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r32/init_pure/init_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 83.10% (8310/10000), Test loss:0.5288
Epoch [11/100], Passed time:[168.657/1855.231]
learning rate: 0.1
Batch [0/352] training loss = 0.3215, training acc = 0.91
Batch [200/352] training loss = 0.4651, training acc = 0.85
Valid Test with nat
Test accuracy: 83.84% (4192/5000), Test loss:0.5108
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r32/init_pure/init_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 82.51% (8251/10000), Test loss:0.5478
Epoch [12/100], Passed time:[172.868/2074.421]
learning rate: 0.1
Batch [0/352] training loss = 0.2082, training acc = 0.94
Batch [200/352] training loss = 0.2439, training acc = 0.91
Valid Test with nat
Test accuracy: 87.38% (4369/5000), Test loss:0.4043
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r32/init_pure/init_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 86.74% (8674/10000), Test loss:0.3886
Epoch [13/100], Passed time:[175.287/2278.733]
learning rate: 0.1
Batch [0/352] training loss = 0.3057, training acc = 0.91
Batch [200/352] training loss = 0.2466, training acc = 0.89
Valid Test with nat
Test accuracy: 88.98% (4449/5000), Test loss:0.3493
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r32/init_pure/init_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 87.96% (8796/10000), Test loss:0.3705
Epoch [14/100], Passed time:[177.276/2481.868]
learning rate: 0.1
Batch [0/352] training loss = 0.1646, training acc = 0.93
Batch [200/352] training loss = 0.2986, training acc = 0.91
Valid Test with nat
Test accuracy: 86.74% (4337/5000), Test loss:0.4128
Epoch [15/100], Passed time:[177.626/2664.387]
learning rate: 0.1
Batch [0/352] training loss = 0.2669, training acc = 0.93
Batch [200/352] training loss = 0.2934, training acc = 0.95
Valid Test with nat
Test accuracy: 86.50% (4325/5000), Test loss:0.4641
Epoch [16/100], Passed time:[178.001/2848.014]
learning rate: 0.1
Batch [0/352] training loss = 0.1863, training acc = 0.92
Batch [200/352] training loss = 0.1863, training acc = 0.93
Valid Test with nat
Test accuracy: 87.94% (4397/5000), Test loss:0.4054
Epoch [17/100], Passed time:[178.258/3030.388]
learning rate: 0.1
Batch [0/352] training loss = 0.1299, training acc = 0.95
Batch [200/352] training loss = 0.2813, training acc = 0.91
Valid Test with nat
Test accuracy: 87.58% (4379/5000), Test loss:0.3961
Epoch [18/100], Passed time:[178.364/3210.544]
learning rate: 0.1
Batch [0/352] training loss = 0.1503, training acc = 0.95
Batch [200/352] training loss = 0.1590, training acc = 0.95
Valid Test with nat
Test accuracy: 88.72% (4436/5000), Test loss:0.3738
Epoch [19/100], Passed time:[178.394/3389.477]
learning rate: 0.1
Batch [0/352] training loss = 0.1971, training acc = 0.94
Batch [200/352] training loss = 0.2621, training acc = 0.92
Valid Test with nat
Test accuracy: 88.44% (4422/5000), Test loss:0.3815
Epoch [20/100], Passed time:[178.437/3568.745]
learning rate: 0.1
Batch [0/352] training loss = 0.1859, training acc = 0.92
Batch [200/352] training loss = 0.2407, training acc = 0.92
Valid Test with nat
Test accuracy: 88.92% (4446/5000), Test loss:0.3503
Epoch [21/100], Passed time:[178.269/3743.655]
learning rate: 0.1
Batch [0/352] training loss = 0.3073, training acc = 0.88
Batch [200/352] training loss = 0.1606, training acc = 0.94
Valid Test with nat
Test accuracy: 88.66% (4433/5000), Test loss:0.3817
Epoch [22/100], Passed time:[178.248/3921.464]
learning rate: 0.1
Batch [0/352] training loss = 0.1508, training acc = 0.95
Batch [200/352] training loss = 0.1668, training acc = 0.92
Valid Test with nat
Test accuracy: 88.38% (4419/5000), Test loss:0.3967
Epoch [23/100], Passed time:[178.204/4098.701]
learning rate: 0.1
Batch [0/352] training loss = 0.1291, training acc = 0.96
Batch [200/352] training loss = 0.1542, training acc = 0.95
Valid Test with nat
Test accuracy: 87.14% (4357/5000), Test loss:0.4594
Epoch [24/100], Passed time:[179.191/4300.573]
learning rate: 0.1
Batch [0/352] training loss = 0.1626, training acc = 0.93
Batch [200/352] training loss = 0.2242, training acc = 0.89
Valid Test with nat
Test accuracy: 89.14% (4457/5000), Test loss:0.3847
Epoch [25/100], Passed time:[179.935/4498.385]
learning rate: 0.1
Batch [0/352] training loss = 0.1727, training acc = 0.95
Batch [200/352] training loss = 0.1900, training acc = 0.93
Valid Test with nat
Test accuracy: 84.44% (4222/5000), Test loss:0.5668
Epoch [26/100], Passed time:[180.432/4691.220]
learning rate: 0.1
Batch [0/352] training loss = 0.1154, training acc = 0.97
Batch [200/352] training loss = 0.1482, training acc = 0.95
Valid Test with nat
Test accuracy: 86.92% (4346/5000), Test loss:0.4785
Epoch [27/100], Passed time:[180.445/4872.004]
learning rate: 0.1
Batch [0/352] training loss = 0.1831, training acc = 0.94
Batch [200/352] training loss = 0.2171, training acc = 0.92
Valid Test with nat
Test accuracy: 88.34% (4417/5000), Test loss:0.4325
Epoch [28/100], Passed time:[180.410/5051.466]
learning rate: 0.1
Batch [0/352] training loss = 0.1340, training acc = 0.95
Batch [200/352] training loss = 0.1533, training acc = 0.93
Valid Test with nat
Test accuracy: 88.18% (4409/5000), Test loss:0.4491
Epoch [29/100], Passed time:[180.211/5226.124]
learning rate: 0.1
Batch [0/352] training loss = 0.1440, training acc = 0.95
Batch [200/352] training loss = 0.1800, training acc = 0.94
Valid Test with nat
Test accuracy: 88.36% (4418/5000), Test loss:0.4142
Epoch [30/100], Passed time:[180.046/5401.377]
learning rate: 0.1
Batch [0/352] training loss = 0.1264, training acc = 0.96
Batch [200/352] training loss = 0.1566, training acc = 0.94
Valid Test with nat
Test accuracy: 88.82% (4441/5000), Test loss:0.3954
Epoch [31/100], Passed time:[180.191/5585.925]
learning rate: 0.1
Batch [0/352] training loss = 0.1724, training acc = 0.92
Batch [200/352] training loss = 0.2378, training acc = 0.91
Valid Test with nat
Test accuracy: 89.96% (4498/5000), Test loss:0.3465
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r32/init_pure/init_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 89.43% (8943/10000), Test loss:0.3448
Epoch [32/100], Passed time:[181.277/5800.871]
learning rate: 0.1
Batch [0/352] training loss = 0.2072, training acc = 0.95
Batch [200/352] training loss = 0.1139, training acc = 0.96
Valid Test with nat
Test accuracy: 89.82% (4491/5000), Test loss:0.3353
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r32/init_pure/init_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 89.84% (8984/10000), Test loss:0.3548
Epoch [33/100], Passed time:[182.134/6010.429]
learning rate: 0.1
Batch [0/352] training loss = 0.2185, training acc = 0.92
Batch [200/352] training loss = 0.1550, training acc = 0.95
Valid Test with nat
Test accuracy: 88.80% (4440/5000), Test loss:0.3676
Epoch [34/100], Passed time:[182.336/6199.422]
learning rate: 0.1
Batch [0/352] training loss = 0.1380, training acc = 0.96
Batch [200/352] training loss = 0.1944, training acc = 0.93
Valid Test with nat
Test accuracy: 87.36% (4368/5000), Test loss:0.4892
Epoch [35/100], Passed time:[182.308/6380.791]
learning rate: 0.1
Batch [0/352] training loss = 0.2157, training acc = 0.93
Batch [200/352] training loss = 0.1188, training acc = 0.98
Valid Test with nat
Test accuracy: 88.98% (4449/5000), Test loss:0.3912
Epoch [36/100], Passed time:[182.429/6567.427]
learning rate: 0.1
Batch [0/352] training loss = 0.1342, training acc = 0.97
Batch [200/352] training loss = 0.2381, training acc = 0.93
Valid Test with nat
Test accuracy: 88.20% (4410/5000), Test loss:0.4133
Epoch [37/100], Passed time:[182.301/6745.155]
learning rate: 0.1
Batch [0/352] training loss = 0.1010, training acc = 0.96
Batch [200/352] training loss = 0.0944, training acc = 0.98
Valid Test with nat
Test accuracy: 89.26% (4463/5000), Test loss:0.3760
Epoch [38/100], Passed time:[182.190/6923.234]
learning rate: 0.1
Batch [0/352] training loss = 0.1813, training acc = 0.93
Batch [200/352] training loss = 0.0855, training acc = 0.98
Valid Test with nat
Test accuracy: 89.76% (4488/5000), Test loss:0.3550
Epoch [39/100], Passed time:[181.992/7097.705]
learning rate: 0.1
Batch [0/352] training loss = 0.1030, training acc = 0.96
Batch [200/352] training loss = 0.2610, training acc = 0.91
Valid Test with nat
Test accuracy: 90.64% (4532/5000), Test loss:0.3651
Epoch [40/100], Passed time:[181.840/7273.608]
learning rate: 0.1
Batch [0/352] training loss = 0.1109, training acc = 0.96
Batch [200/352] training loss = 0.1966, training acc = 0.94
Valid Test with nat
Test accuracy: 89.46% (4473/5000), Test loss:0.3935
Epoch [41/100], Passed time:[181.738/7451.261]
learning rate: 0.1
Batch [0/352] training loss = 0.1111, training acc = 0.96
Batch [200/352] training loss = 0.1687, training acc = 0.95
Valid Test with nat
Test accuracy: 86.64% (4332/5000), Test loss:0.5227
Epoch [42/100], Passed time:[182.266/7655.151]
learning rate: 0.1
Batch [0/352] training loss = 0.2236, training acc = 0.95
Batch [200/352] training loss = 0.1669, training acc = 0.95
Valid Test with nat
Test accuracy: 90.10% (4505/5000), Test loss:0.3386
Epoch [43/100], Passed time:[182.703/7856.234]
learning rate: 0.1
Batch [0/352] training loss = 0.1318, training acc = 0.97
Batch [200/352] training loss = 0.1102, training acc = 0.97
Valid Test with nat
Test accuracy: 89.20% (4460/5000), Test loss:0.3881
Epoch [44/100], Passed time:[182.809/8043.592]
learning rate: 0.1
Batch [0/352] training loss = 0.1808, training acc = 0.91
Batch [200/352] training loss = 0.1679, training acc = 0.95
Valid Test with nat
Test accuracy: 88.74% (4437/5000), Test loss:0.3901
Epoch [45/100], Passed time:[182.726/8222.673]
learning rate: 0.1
Batch [0/352] training loss = 0.1088, training acc = 0.96
Batch [200/352] training loss = 0.1858, training acc = 0.91
Valid Test with nat
Test accuracy: 89.66% (4483/5000), Test loss:0.3756
Epoch [46/100], Passed time:[182.824/8409.914]
learning rate: 0.1
Batch [0/352] training loss = 0.0757, training acc = 0.98
Batch [200/352] training loss = 0.2061, training acc = 0.95
Valid Test with nat
Test accuracy: 90.40% (4520/5000), Test loss:0.3414
Epoch [47/100], Passed time:[182.634/8583.811]
learning rate: 0.1
Batch [0/352] training loss = 0.0979, training acc = 0.97
Batch [200/352] training loss = 0.1416, training acc = 0.95
Valid Test with nat
Test accuracy: 89.86% (4493/5000), Test loss:0.3469
Epoch [48/100], Passed time:[182.531/8761.480]
learning rate: 0.1
Batch [0/352] training loss = 0.1812, training acc = 0.94
Batch [200/352] training loss = 0.1046, training acc = 0.97
Valid Test with nat
Test accuracy: 90.48% (4524/5000), Test loss:0.3314
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r32/init_pure/init_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 90.18% (9018/10000), Test loss:0.3491
Epoch [49/100], Passed time:[182.600/8947.382]
learning rate: 0.1
Batch [0/352] training loss = 0.0823, training acc = 0.96
Batch [200/352] training loss = 0.1572, training acc = 0.95
Valid Test with nat
Test accuracy: 89.70% (4485/5000), Test loss:0.3778
Epoch [50/100], Passed time:[182.676/9133.809]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.1074, training acc = 0.97
Batch [200/352] training loss = 0.0689, training acc = 0.98
Valid Test with nat
Test accuracy: 93.72% (4686/5000), Test loss:0.2292
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r32/init_pure/init_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 92.87% (9287/10000), Test loss:0.2470
Epoch [51/100], Passed time:[183.261/9346.313]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0287, training acc = 0.99
Batch [200/352] training loss = 0.0411, training acc = 0.99
Valid Test with nat
Test accuracy: 93.72% (4686/5000), Test loss:0.2305
Epoch [52/100], Passed time:[183.192/9525.966]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0213, training acc = 1.00
Batch [200/352] training loss = 0.0136, training acc = 1.00
Valid Test with nat
Test accuracy: 93.92% (4696/5000), Test loss:0.2256
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r32/init_pure/init_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 93.15% (9315/10000), Test loss:0.2416
Epoch [53/100], Passed time:[183.165/9707.767]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0295, training acc = 0.98
Batch [200/352] training loss = 0.0732, training acc = 0.97
Valid Test with nat
Test accuracy: 93.72% (4686/5000), Test loss:0.2404
Epoch [54/100], Passed time:[182.831/9872.896]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0114, training acc = 1.00
Batch [200/352] training loss = 0.0193, training acc = 1.00
Valid Test with nat
Test accuracy: 94.10% (4705/5000), Test loss:0.2293
Epoch [55/100], Passed time:[182.667/10046.701]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0305, training acc = 0.98
Batch [200/352] training loss = 0.0084, training acc = 1.00
Valid Test with nat
Test accuracy: 94.04% (4702/5000), Test loss:0.2746
Epoch [56/100], Passed time:[182.931/10244.124]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0200, training acc = 0.99
Batch [200/352] training loss = 0.0282, training acc = 0.99
Valid Test with nat
Test accuracy: 93.98% (4699/5000), Test loss:0.2666
Epoch [57/100], Passed time:[183.155/10439.807]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0273, training acc = 0.99
Batch [200/352] training loss = 0.0270, training acc = 0.98
Valid Test with nat
Test accuracy: 93.88% (4694/5000), Test loss:0.2619
Epoch [58/100], Passed time:[183.427/10638.780]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0398, training acc = 0.98
Batch [200/352] training loss = 0.0194, training acc = 0.99
Valid Test with nat
Test accuracy: 93.82% (4691/5000), Test loss:0.2411
Epoch [59/100], Passed time:[183.412/10821.322]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0118, training acc = 1.00
Batch [200/352] training loss = 0.0713, training acc = 0.98
Valid Test with nat
Test accuracy: 93.96% (4698/5000), Test loss:0.2432
Epoch [60/100], Passed time:[183.479/11008.760]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0114, training acc = 1.00
Batch [200/352] training loss = 0.0178, training acc = 0.99
Valid Test with nat
Test accuracy: 93.70% (4685/5000), Test loss:0.2419
Epoch [61/100], Passed time:[183.393/11186.996]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0121, training acc = 1.00
Batch [200/352] training loss = 0.0145, training acc = 0.99
Valid Test with nat
Test accuracy: 93.78% (4689/5000), Test loss:0.2490
Epoch [62/100], Passed time:[183.315/11365.553]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0206, training acc = 1.00
Batch [200/352] training loss = 0.0344, training acc = 0.98
Valid Test with nat
Test accuracy: 94.02% (4701/5000), Test loss:0.2440
Epoch [63/100], Passed time:[183.219/11542.814]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0169, training acc = 0.99
Batch [200/352] training loss = 0.0488, training acc = 0.98
Valid Test with nat
Test accuracy: 93.98% (4699/5000), Test loss:0.2458
Epoch [64/100], Passed time:[183.110/11719.014]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0102, training acc = 0.99
Batch [200/352] training loss = 0.0082, training acc = 1.00
Valid Test with nat
Test accuracy: 93.96% (4698/5000), Test loss:0.2516
Epoch [65/100], Passed time:[183.027/11896.767]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0041, training acc = 1.00
Batch [200/352] training loss = 0.0135, training acc = 0.99
Valid Test with nat
Test accuracy: 93.86% (4693/5000), Test loss:0.2581
Epoch [66/100], Passed time:[183.199/12091.116]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0030, training acc = 1.00
Batch [200/352] training loss = 0.0079, training acc = 1.00
Valid Test with nat
Test accuracy: 94.04% (4702/5000), Test loss:0.2462
Epoch [67/100], Passed time:[183.513/12295.338]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0125, training acc = 1.00
Batch [200/352] training loss = 0.0040, training acc = 1.00
Valid Test with nat
Test accuracy: 94.06% (4703/5000), Test loss:0.2704
Epoch [68/100], Passed time:[183.633/12487.020]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0344, training acc = 0.99
Batch [200/352] training loss = 0.0049, training acc = 1.00
Valid Test with nat
Test accuracy: 94.14% (4707/5000), Test loss:0.2457
Epoch [69/100], Passed time:[183.422/12656.139]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0055, training acc = 1.00
Batch [200/352] training loss = 0.0050, training acc = 1.00
Valid Test with nat
Test accuracy: 94.06% (4703/5000), Test loss:0.2639
Epoch [70/100], Passed time:[183.071/12814.955]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0190, training acc = 0.99
Batch [200/352] training loss = 0.0127, training acc = 1.00
Valid Test with nat
Test accuracy: 94.20% (4710/5000), Test loss:0.2465
Epoch [71/100], Passed time:[182.691/12971.044]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0170, training acc = 0.99
Batch [200/352] training loss = 0.0088, training acc = 1.00
Valid Test with nat
Test accuracy: 93.80% (4690/5000), Test loss:0.2535
Epoch [72/100], Passed time:[182.266/13123.176]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0064, training acc = 1.00
Batch [200/352] training loss = 0.0038, training acc = 1.00
Valid Test with nat
Test accuracy: 94.36% (4718/5000), Test loss:0.2491
Epoch [73/100], Passed time:[182.020/13287.445]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0226, training acc = 0.99
Batch [200/352] training loss = 0.0134, training acc = 1.00
Valid Test with nat
Test accuracy: 94.08% (4704/5000), Test loss:0.2539
Epoch [74/100], Passed time:[182.024/13469.807]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0028, training acc = 1.00
Batch [200/352] training loss = 0.0080, training acc = 1.00
Valid Test with nat
Test accuracy: 93.82% (4691/5000), Test loss:0.2580
Epoch [75/100], Passed time:[181.907/13643.025]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0167, training acc = 0.98
Batch [200/352] training loss = 0.0098, training acc = 0.99
Valid Test with nat
Test accuracy: 93.96% (4698/5000), Test loss:0.2526
Epoch [76/100], Passed time:[181.741/13812.282]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0035, training acc = 1.00
Batch [200/352] training loss = 0.0488, training acc = 0.98
Valid Test with nat
Test accuracy: 93.94% (4697/5000), Test loss:0.2533
Epoch [77/100], Passed time:[181.490/13974.748]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0159, training acc = 0.99
Batch [200/352] training loss = 0.0057, training acc = 1.00
Valid Test with nat
Test accuracy: 93.96% (4698/5000), Test loss:0.2533
Epoch [78/100], Passed time:[181.191/14132.886]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0102, training acc = 0.99
Batch [200/352] training loss = 0.0025, training acc = 1.00
Valid Test with nat
Test accuracy: 94.10% (4705/5000), Test loss:0.2694
Epoch [79/100], Passed time:[180.885/14289.892]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0022, training acc = 1.00
Batch [200/352] training loss = 0.0014, training acc = 1.00
Valid Test with nat
Test accuracy: 94.00% (4700/5000), Test loss:0.2518
Epoch [80/100], Passed time:[180.531/14442.479]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0085, training acc = 1.00
Batch [200/352] training loss = 0.0223, training acc = 0.98
Valid Test with nat
Test accuracy: 93.84% (4692/5000), Test loss:0.2510
Epoch [81/100], Passed time:[180.138/14591.174]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0125, training acc = 0.99
Batch [200/352] training loss = 0.0048, training acc = 1.00
Valid Test with nat
Test accuracy: 94.00% (4700/5000), Test loss:0.2506
Epoch [82/100], Passed time:[179.747/14739.217]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0057, training acc = 1.00
Batch [200/352] training loss = 0.0042, training acc = 1.00
Valid Test with nat
Test accuracy: 93.86% (4693/5000), Test loss:0.2525
Epoch [83/100], Passed time:[179.444/14893.869]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0047, training acc = 1.00
Batch [200/352] training loss = 0.0083, training acc = 1.00
Valid Test with nat
Test accuracy: 94.02% (4701/5000), Test loss:0.2489
Epoch [84/100], Passed time:[179.381/15068.031]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0043, training acc = 1.00
Batch [200/352] training loss = 0.0035, training acc = 1.00
Valid Test with nat
Test accuracy: 93.90% (4695/5000), Test loss:0.2503
Epoch [85/100], Passed time:[179.312/15241.525]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0074, training acc = 1.00
Batch [200/352] training loss = 0.0082, training acc = 1.00
Valid Test with nat
Test accuracy: 93.92% (4696/5000), Test loss:0.2562
Epoch [86/100], Passed time:[179.128/15404.965]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0221, training acc = 0.99
Batch [200/352] training loss = 0.0030, training acc = 1.00
Valid Test with nat
Test accuracy: 93.90% (4695/5000), Test loss:0.2513
Epoch [87/100], Passed time:[178.861/15560.900]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0020, training acc = 1.00
Batch [200/352] training loss = 0.0128, training acc = 0.99
Valid Test with nat
Test accuracy: 93.90% (4695/5000), Test loss:0.2507
Epoch [88/100], Passed time:[178.677/15723.546]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0024, training acc = 1.00
Batch [200/352] training loss = 0.0095, training acc = 0.99
Valid Test with nat
Test accuracy: 93.88% (4694/5000), Test loss:0.2489
Epoch [89/100], Passed time:[178.631/15898.143]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0041, training acc = 1.00
Batch [200/352] training loss = 0.0071, training acc = 1.00
Valid Test with nat
Test accuracy: 93.94% (4697/5000), Test loss:0.2519
Epoch [90/100], Passed time:[178.620/16075.791]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0038, training acc = 1.00
Batch [200/352] training loss = 0.0041, training acc = 1.00
Valid Test with nat
Test accuracy: 93.94% (4697/5000), Test loss:0.2507
Epoch [91/100], Passed time:[178.519/16245.213]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0195, training acc = 0.99
Batch [200/352] training loss = 0.0098, training acc = 0.99
Valid Test with nat
Test accuracy: 94.04% (4702/5000), Test loss:0.2495
Epoch [92/100], Passed time:[178.414/16414.118]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0051, training acc = 1.00
Batch [200/352] training loss = 0.0045, training acc = 1.00
Valid Test with nat
Test accuracy: 94.02% (4701/5000), Test loss:0.2518
Epoch [93/100], Passed time:[178.228/16575.176]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0204, training acc = 0.99
Batch [200/352] training loss = 0.0023, training acc = 1.00
Valid Test with nat
Test accuracy: 93.94% (4697/5000), Test loss:0.2487
Epoch [94/100], Passed time:[177.945/16726.789]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0070, training acc = 0.99
Batch [200/352] training loss = 0.0022, training acc = 1.00
Valid Test with nat
Test accuracy: 94.02% (4701/5000), Test loss:0.2527
Epoch [95/100], Passed time:[177.703/16881.796]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0103, training acc = 1.00
Batch [200/352] training loss = 0.0156, training acc = 0.98
Valid Test with nat
Test accuracy: 94.14% (4707/5000), Test loss:0.2464
Epoch [96/100], Passed time:[177.441/17034.295]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0140, training acc = 0.99
Batch [200/352] training loss = 0.0120, training acc = 0.99
Valid Test with nat
Test accuracy: 93.96% (4698/5000), Test loss:0.2493
Epoch [97/100], Passed time:[177.175/17185.943]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0017, training acc = 1.00
Batch [200/352] training loss = 0.0087, training acc = 0.99
Valid Test with nat
Test accuracy: 94.08% (4704/5000), Test loss:0.2475
Epoch [98/100], Passed time:[176.898/17335.990]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0032, training acc = 1.00
Batch [200/352] training loss = 0.0156, training acc = 0.99
Valid Test with nat
Test accuracy: 94.00% (4700/5000), Test loss:0.2852
Epoch [99/100], Passed time:[176.748/17498.081]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0187, training acc = 0.98
Batch [200/352] training loss = 0.0104, training acc = 0.99
Valid Test with nat
Test accuracy: 93.96% (4698/5000), Test loss:0.2622
Training done, model saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r32/init_pure/init_enhance_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 93.68% (9368/10000), Test loss:0.2660
