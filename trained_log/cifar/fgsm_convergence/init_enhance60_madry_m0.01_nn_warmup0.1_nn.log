eval : False
transfer : False
epsilon : 0.03137254901960784
clip_min : 0
test_batch_size : 100
dataset : cifar
log_path : ./trained_models_new/cifar/vgg16/fgsm/pruned1_epoch100_r80/init_pure/init_enhance60_madry_m0.01_nn_warmup0.1_nn.log
norm : False
ft_interval_weight : 50
results_path : None
weight_decay : 0.0001
attack_iter : 10
interval_weight : 0.1
starting_epsilon : 1e-05
mask_path : ./trained_models_new/cifar/vgg16/fgsm/pruned1_epoch100_r80/init_pure/pruned_lr0.01_nn_mask_r80.npy
schedule_length : 10
eps_step : 0.00784313725490196
model_name : init_enhance60_madry_m0.01_nn_warmup0.1_nn
finetune_method : fgsm
train_epochs : 60
gpu : 1
clip_max : 1.0
max_pruning_ratio : 80
verbose : 200
resume : 0
early_stop : 1000
targeted : False
model_width : 8
model_path : ./trained_models_new/cifar/vgg16/fgsm/pruned1_epoch100_r80/init_pure/init_enhance60_madry_m0.01_nn_warmup0.1_nn.pth
model_type : vgg16
n_pruning_steps : 1
init_step : 1400
enhance_method : madry
prune_method : unstructured
n_classes : 10
learning_rate : 0.1
trades_beta : 6.0
batch_size : 64
warmup : True
enhance_learning_rate : 0.1
noise_sd : 1.0
init_type : pure
last_model_path : ./trained_models_new/
init : True
parallel : False
init_path : ./trained_models_new/cifar/vgg16/init/pure_vgg16_init.pth
enhance_epochs : 60
seed : 7
mask_name : pruned_lr0.01_nn_mask_r80
create_init : False
optm : sgd
train_method : nat
CUDA enabled.
Enhance training config:
Enhance training method: madry
model will be saved in: ./trained_models_new/cifar/vgg16/fgsm/pruned1_epoch100_r80/init_pure/init_enhance60_madry_m0.01_nn_warmup0.1_nn.pth
Init model is: ./trained_models_new/cifar/vgg16/init/pure_vgg16_init.pth
Init mask used from: ./trained_models_new/cifar/vgg16/fgsm/pruned1_epoch100_r80/init_pure/pruned_lr0.01_nn_mask_r80.npy
Log will be saved in ./trained_models_new/cifar/vgg16/fgsm/pruned1_epoch100_r80/init_pure/init_enhance60_madry_m0.01_nn_warmup0.1_nn.log
Random seed is: 7

model loading from ./trained_models_new/cifar/vgg16/init/pure_vgg16_init.pth
Epoch [0/60]
learning rate: 0.010000000000000002
Train with PGD
Batch [0/782] training loss = 2.22403598, training pgd_acc = 0.32812500
Batch [200/782] training loss = 1.84336591, training pgd_acc = 0.23437500
Batch [400/782] training loss = 1.97816288, training pgd_acc = 0.18750000
Batch [600/782] training loss = 1.57987070, training pgd_acc = 0.40625000
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 61.85% (6185/10000)
Adversarial accuracy: 34.48% (3448/10000)
Epoch [1/60], Passed time:[191.306/191.306]
learning rate: 0.020000000000000004
Train with PGD
Batch [0/782] training loss = 1.58654046, training pgd_acc = 0.37500000
Batch [200/782] training loss = 1.58161998, training pgd_acc = 0.39062500
Batch [400/782] training loss = 1.72166419, training pgd_acc = 0.39062500
Batch [600/782] training loss = 1.71630621, training pgd_acc = 0.32812500
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 67.60% (6760/10000)
Adversarial accuracy: 37.01% (3701/10000)
Epoch [2/60], Passed time:[191.271/382.542]
learning rate: 0.030000000000000006
Train with PGD
Batch [0/782] training loss = 1.69998276, training pgd_acc = 0.43750000
Batch [200/782] training loss = 1.77507555, training pgd_acc = 0.28125000
Batch [400/782] training loss = 1.63553393, training pgd_acc = 0.42187500
Batch [600/782] training loss = 1.49145687, training pgd_acc = 0.46875000
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 66.37% (6637/10000)
Adversarial accuracy: 38.51% (3851/10000)
Epoch [3/60], Passed time:[191.333/573.998]
learning rate: 0.04000000000000001
Train with PGD
Batch [0/782] training loss = 1.63937271, training pgd_acc = 0.34375000
Batch [200/782] training loss = 1.48330843, training pgd_acc = 0.46875000
Batch [400/782] training loss = 1.64956820, training pgd_acc = 0.40625000
Batch [600/782] training loss = 1.64390576, training pgd_acc = 0.31250000
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 67.63% (6763/10000)
Adversarial accuracy: 38.62% (3862/10000)
Epoch [4/60], Passed time:[191.358/765.434]
learning rate: 0.05
Train with PGD
Batch [0/782] training loss = 1.38303339, training pgd_acc = 0.54687500
Batch [200/782] training loss = 1.54735601, training pgd_acc = 0.39062500
Batch [400/782] training loss = 1.73925567, training pgd_acc = 0.32812500
Batch [600/782] training loss = 1.69593394, training pgd_acc = 0.31250000
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 66.25% (6625/10000)
Adversarial accuracy: 38.95% (3895/10000)
Epoch [5/60], Passed time:[191.361/956.804]
learning rate: 0.06000000000000001
Train with PGD
Batch [0/782] training loss = 1.73772788, training pgd_acc = 0.42187500
Batch [200/782] training loss = 1.52080238, training pgd_acc = 0.42187500
Batch [400/782] training loss = 1.77583385, training pgd_acc = 0.31250000
Batch [600/782] training loss = 1.48030519, training pgd_acc = 0.40625000
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 68.82% (6882/10000)
Adversarial accuracy: 38.95% (3895/10000)
Epoch [6/60], Passed time:[191.349/1148.095]
learning rate: 0.07
Train with PGD
Batch [0/782] training loss = 1.38765728, training pgd_acc = 0.48437500
Batch [200/782] training loss = 1.49664772, training pgd_acc = 0.46875000
Batch [400/782] training loss = 1.56101549, training pgd_acc = 0.48437500
Batch [600/782] training loss = 1.79213107, training pgd_acc = 0.34375000
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 68.17% (6817/10000)
Adversarial accuracy: 39.52% (3952/10000)
Epoch [7/60], Passed time:[191.329/1339.300]
learning rate: 0.08000000000000002
Train with PGD
Batch [0/782] training loss = 1.43669891, training pgd_acc = 0.51562500
Batch [200/782] training loss = 1.72006726, training pgd_acc = 0.31250000
Batch [400/782] training loss = 1.56255674, training pgd_acc = 0.35937500
Batch [600/782] training loss = 1.54109931, training pgd_acc = 0.43750000
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 65.37% (6537/10000)
Adversarial accuracy: 39.25% (3925/10000)
Epoch [8/60], Passed time:[191.316/1530.524]
learning rate: 0.09000000000000001
Train with PGD
Batch [0/782] training loss = 1.58602262, training pgd_acc = 0.40625000
Batch [200/782] training loss = 1.54591262, training pgd_acc = 0.35937500
Batch [400/782] training loss = 1.69829798, training pgd_acc = 0.32812500
Batch [600/782] training loss = 1.41501367, training pgd_acc = 0.46875000
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 66.44% (6644/10000)
Adversarial accuracy: 39.72% (3972/10000)
Epoch [9/60], Passed time:[191.302/1721.714]
learning rate: 0.1
Train with PGD
Batch [0/782] training loss = 1.56655192, training pgd_acc = 0.45312500
Batch [200/782] training loss = 1.50112295, training pgd_acc = 0.35937500
Batch [400/782] training loss = 1.78963113, training pgd_acc = 0.39062500
Batch [600/782] training loss = 1.56730366, training pgd_acc = 0.34375000
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 66.77% (6677/10000)
Adversarial accuracy: 37.42% (3742/10000)
Epoch [10/60], Passed time:[191.299/1912.990]
learning rate: 0.1
Train with PGD
Batch [0/782] training loss = 1.64660966, training pgd_acc = 0.40625000
Batch [200/782] training loss = 1.50838506, training pgd_acc = 0.43750000
Batch [400/782] training loss = 1.50794983, training pgd_acc = 0.42187500
Batch [600/782] training loss = 1.34064412, training pgd_acc = 0.46875000
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 67.48% (6748/10000)
Adversarial accuracy: 41.54% (4154/10000)
Epoch [11/60], Passed time:[191.309/2104.403]
learning rate: 0.1
Train with PGD
Batch [0/782] training loss = 1.60101640, training pgd_acc = 0.43750000
Batch [200/782] training loss = 1.57537770, training pgd_acc = 0.40625000
Batch [400/782] training loss = 1.45274198, training pgd_acc = 0.48437500
Batch [600/782] training loss = 1.55249500, training pgd_acc = 0.43750000
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 68.81% (6881/10000)
Adversarial accuracy: 39.33% (3933/10000)
Epoch [12/60], Passed time:[191.305/2295.663]
learning rate: 0.1
Train with PGD
Batch [0/782] training loss = 1.47366667, training pgd_acc = 0.40625000
Batch [200/782] training loss = 1.52954578, training pgd_acc = 0.42187500
Batch [400/782] training loss = 1.56141973, training pgd_acc = 0.48437500
Batch [600/782] training loss = 1.28445101, training pgd_acc = 0.50000000
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 69.43% (6943/10000)
Adversarial accuracy: 40.73% (4073/10000)
Epoch [13/60], Passed time:[191.304/2486.953]
learning rate: 0.1
Train with PGD
Batch [0/782] training loss = 1.48280787, training pgd_acc = 0.46875000
Batch [200/782] training loss = 1.51961744, training pgd_acc = 0.40625000
Batch [400/782] training loss = 1.60096765, training pgd_acc = 0.37500000
Batch [600/782] training loss = 1.50078845, training pgd_acc = 0.45312500
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 69.25% (6925/10000)
Adversarial accuracy: 41.34% (4134/10000)
Epoch [14/60], Passed time:[191.304/2678.257]
learning rate: 0.1
Train with PGD
Batch [0/782] training loss = 1.54115784, training pgd_acc = 0.35937500
Batch [200/782] training loss = 1.44383729, training pgd_acc = 0.45312500
Batch [400/782] training loss = 1.40812767, training pgd_acc = 0.48437500
Batch [600/782] training loss = 1.49603343, training pgd_acc = 0.34375000
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 67.35% (6735/10000)
Adversarial accuracy: 40.97% (4097/10000)
Epoch [15/60], Passed time:[191.301/2869.514]
learning rate: 0.1
Train with PGD
Batch [0/782] training loss = 1.78235924, training pgd_acc = 0.35937500
Batch [200/782] training loss = 1.43476307, training pgd_acc = 0.46875000
Batch [400/782] training loss = 1.68106055, training pgd_acc = 0.35937500
Batch [600/782] training loss = 1.41341245, training pgd_acc = 0.60937500
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 67.66% (6766/10000)
Adversarial accuracy: 41.09% (4109/10000)
Epoch [16/60], Passed time:[191.295/3060.723]
learning rate: 0.1
Train with PGD
Batch [0/782] training loss = 1.51841891, training pgd_acc = 0.45312500
Batch [200/782] training loss = 1.54921985, training pgd_acc = 0.37500000
Batch [400/782] training loss = 1.43095207, training pgd_acc = 0.40625000
Batch [600/782] training loss = 1.68879580, training pgd_acc = 0.37500000
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 69.43% (6943/10000)
Adversarial accuracy: 41.07% (4107/10000)
Epoch [17/60], Passed time:[191.299/3252.082]
learning rate: 0.1
Train with PGD
Batch [0/782] training loss = 1.43730557, training pgd_acc = 0.42187500
Batch [200/782] training loss = 1.71863914, training pgd_acc = 0.43750000
Batch [400/782] training loss = 1.39937758, training pgd_acc = 0.37500000
Batch [600/782] training loss = 1.78952098, training pgd_acc = 0.39062500
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 70.02% (7002/10000)
Adversarial accuracy: 39.95% (3995/10000)
Epoch [18/60], Passed time:[191.313/3443.639]
learning rate: 0.1
Train with PGD
Batch [0/782] training loss = 1.43776894, training pgd_acc = 0.40625000
Batch [200/782] training loss = 1.46219432, training pgd_acc = 0.39062500
Batch [400/782] training loss = 1.55632114, training pgd_acc = 0.40625000
Batch [600/782] training loss = 1.43868613, training pgd_acc = 0.50000000
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 68.25% (6825/10000)
Adversarial accuracy: 39.58% (3958/10000)
Epoch [19/60], Passed time:[191.312/3634.925]
learning rate: 0.1
Train with PGD
Batch [0/782] training loss = 1.62370443, training pgd_acc = 0.28125000
Batch [200/782] training loss = 1.50152624, training pgd_acc = 0.53125000
Batch [400/782] training loss = 1.41529548, training pgd_acc = 0.37500000
Batch [600/782] training loss = 1.52785766, training pgd_acc = 0.39062500
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 70.04% (7004/10000)
Adversarial accuracy: 41.65% (4165/10000)
Epoch [20/60], Passed time:[191.307/3826.140]
learning rate: 0.1
Train with PGD
Batch [0/782] training loss = 1.68066192, training pgd_acc = 0.34375000
Batch [200/782] training loss = 1.47434199, training pgd_acc = 0.37500000
Batch [400/782] training loss = 1.58635557, training pgd_acc = 0.42187500
Batch [600/782] training loss = 1.48157907, training pgd_acc = 0.42187500
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 70.70% (7070/10000)
Adversarial accuracy: 41.35% (4135/10000)
Epoch [21/60], Passed time:[191.307/4017.444]
learning rate: 0.1
Train with PGD
Batch [0/782] training loss = 1.38148272, training pgd_acc = 0.50000000
Batch [200/782] training loss = 1.46198392, training pgd_acc = 0.48437500
Batch [400/782] training loss = 1.81140471, training pgd_acc = 0.32812500
Batch [600/782] training loss = 1.59642458, training pgd_acc = 0.35937500
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 69.23% (6923/10000)
Adversarial accuracy: 42.02% (4202/10000)
Epoch [22/60], Passed time:[191.309/4208.800]
learning rate: 0.1
Train with PGD
Batch [0/782] training loss = 1.36670542, training pgd_acc = 0.43750000
Batch [200/782] training loss = 1.61806965, training pgd_acc = 0.40625000
Batch [400/782] training loss = 1.58418524, training pgd_acc = 0.39062500
Batch [600/782] training loss = 1.52253783, training pgd_acc = 0.46875000
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 70.94% (7094/10000)
Adversarial accuracy: 41.91% (4191/10000)
Epoch [23/60], Passed time:[191.309/4400.106]
learning rate: 0.1
Train with PGD
Batch [0/782] training loss = 1.81696236, training pgd_acc = 0.28125000
Batch [200/782] training loss = 1.70266783, training pgd_acc = 0.37500000
Batch [400/782] training loss = 1.61070883, training pgd_acc = 0.42187500
Batch [600/782] training loss = 1.57176375, training pgd_acc = 0.43750000
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 68.66% (6866/10000)
Adversarial accuracy: 41.68% (4168/10000)
Epoch [24/60], Passed time:[191.315/4591.552]
learning rate: 0.1
Train with PGD
Batch [0/782] training loss = 1.46846819, training pgd_acc = 0.48437500
Batch [200/782] training loss = 1.41983783, training pgd_acc = 0.46875000
Batch [400/782] training loss = 1.41645551, training pgd_acc = 0.48437500
Batch [600/782] training loss = 1.36478794, training pgd_acc = 0.56250000
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 71.25% (7125/10000)
Adversarial accuracy: 40.61% (4061/10000)
Epoch [25/60], Passed time:[191.315/4782.881]
learning rate: 0.1
Train with PGD
Batch [0/782] training loss = 1.56268823, training pgd_acc = 0.39062500
Batch [200/782] training loss = 1.81453228, training pgd_acc = 0.31250000
Batch [400/782] training loss = 1.51019800, training pgd_acc = 0.48437500
Batch [600/782] training loss = 1.59192383, training pgd_acc = 0.40625000
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 71.52% (7152/10000)
Adversarial accuracy: 42.12% (4212/10000)
Epoch [26/60], Passed time:[191.313/4974.130]
learning rate: 0.1
Train with PGD
Batch [0/782] training loss = 1.46906102, training pgd_acc = 0.48437500
Batch [200/782] training loss = 1.85182929, training pgd_acc = 0.29687500
Batch [400/782] training loss = 1.37987947, training pgd_acc = 0.48437500
Batch [600/782] training loss = 1.51402760, training pgd_acc = 0.40625000
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 67.28% (6728/10000)
Adversarial accuracy: 41.56% (4156/10000)
Epoch [27/60], Passed time:[191.312/5165.427]
learning rate: 0.1
Train with PGD
Batch [0/782] training loss = 1.54396224, training pgd_acc = 0.40625000
Batch [200/782] training loss = 1.60314500, training pgd_acc = 0.43750000
Batch [400/782] training loss = 1.42623115, training pgd_acc = 0.34375000
Batch [600/782] training loss = 1.50118291, training pgd_acc = 0.46875000
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 71.88% (7188/10000)
Adversarial accuracy: 41.23% (4123/10000)
Epoch [28/60], Passed time:[191.311/5356.704]
learning rate: 0.1
Train with PGD
Batch [0/782] training loss = 1.54408705, training pgd_acc = 0.40625000
Batch [200/782] training loss = 1.69472456, training pgd_acc = 0.34375000
Batch [400/782] training loss = 1.37241542, training pgd_acc = 0.54687500
Batch [600/782] training loss = 1.46376145, training pgd_acc = 0.45312500
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 69.57% (6957/10000)
Adversarial accuracy: 41.84% (4184/10000)
Epoch [29/60], Passed time:[191.310/5547.978]
learning rate: 0.1
Train with PGD
Batch [0/782] training loss = 1.59249616, training pgd_acc = 0.39062500
Batch [200/782] training loss = 1.56096494, training pgd_acc = 0.42187500
Batch [400/782] training loss = 1.67014623, training pgd_acc = 0.31250000
Batch [600/782] training loss = 1.38045835, training pgd_acc = 0.50000000
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 70.15% (7015/10000)
Adversarial accuracy: 41.93% (4193/10000)
Epoch [30/60], Passed time:[191.310/5739.294]
learning rate: 0.010000000000000002
Train with PGD
Batch [0/782] training loss = 1.23555017, training pgd_acc = 0.60937500
Batch [200/782] training loss = 1.20662808, training pgd_acc = 0.56250000
Batch [400/782] training loss = 1.45066619, training pgd_acc = 0.51562500
Batch [600/782] training loss = 1.40959167, training pgd_acc = 0.43750000
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 74.21% (7421/10000)
Adversarial accuracy: 45.06% (4506/10000)
Epoch [31/60], Passed time:[191.312/5930.663]
learning rate: 0.010000000000000002
Train with PGD
Batch [0/782] training loss = 1.26685500, training pgd_acc = 0.51562500
Batch [200/782] training loss = 1.37233984, training pgd_acc = 0.45312500
Batch [400/782] training loss = 1.52036881, training pgd_acc = 0.42187500
Batch [600/782] training loss = 1.60484159, training pgd_acc = 0.32812500
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 74.87% (7487/10000)
Adversarial accuracy: 45.70% (4570/10000)
Epoch [32/60], Passed time:[191.312/6121.974]
learning rate: 0.010000000000000002
Train with PGD
Batch [0/782] training loss = 1.13706625, training pgd_acc = 0.53125000
Batch [200/782] training loss = 1.36231780, training pgd_acc = 0.39062500
Batch [400/782] training loss = 1.31829953, training pgd_acc = 0.50000000
Batch [600/782] training loss = 1.31674612, training pgd_acc = 0.54687500
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 75.01% (7501/10000)
Adversarial accuracy: 45.52% (4552/10000)
Epoch [33/60], Passed time:[191.316/6313.415]
learning rate: 0.010000000000000002
Train with PGD
Batch [0/782] training loss = 1.20641494, training pgd_acc = 0.53125000
Batch [200/782] training loss = 1.16117346, training pgd_acc = 0.45312500
Batch [400/782] training loss = 1.18505287, training pgd_acc = 0.53125000
Batch [600/782] training loss = 1.32315469, training pgd_acc = 0.50000000
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 75.02% (7502/10000)
Adversarial accuracy: 45.36% (4536/10000)
Epoch [34/60], Passed time:[191.317/6504.779]
learning rate: 0.010000000000000002
Train with PGD
Batch [0/782] training loss = 1.06323266, training pgd_acc = 0.70312500
Batch [200/782] training loss = 1.17708337, training pgd_acc = 0.56250000
Batch [400/782] training loss = 1.57055271, training pgd_acc = 0.43750000
Batch [600/782] training loss = 1.15179169, training pgd_acc = 0.51562500
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 75.27% (7527/10000)
Adversarial accuracy: 45.20% (4520/10000)
Epoch [35/60], Passed time:[191.314/6696.006]
learning rate: 0.010000000000000002
Train with PGD
Batch [0/782] training loss = 1.38464200, training pgd_acc = 0.43750000
Batch [200/782] training loss = 1.23918319, training pgd_acc = 0.54687500
Batch [400/782] training loss = 1.22683120, training pgd_acc = 0.57812500
Batch [600/782] training loss = 1.15344298, training pgd_acc = 0.56250000
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 75.11% (7511/10000)
Adversarial accuracy: 45.77% (4577/10000)
Epoch [36/60], Passed time:[191.312/6887.249]
learning rate: 0.010000000000000002
Train with PGD
Batch [0/782] training loss = 1.36669540, training pgd_acc = 0.48437500
Batch [200/782] training loss = 1.31883204, training pgd_acc = 0.43750000
Batch [400/782] training loss = 1.31690943, training pgd_acc = 0.51562500
Batch [600/782] training loss = 1.24230349, training pgd_acc = 0.48437500
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 75.13% (7513/10000)
Adversarial accuracy: 45.55% (4555/10000)
Epoch [37/60], Passed time:[191.314/7078.629]
learning rate: 0.010000000000000002
Train with PGD
Batch [0/782] training loss = 1.32296836, training pgd_acc = 0.48437500
Batch [200/782] training loss = 1.32063365, training pgd_acc = 0.43750000
Batch [400/782] training loss = 1.22135687, training pgd_acc = 0.60937500
Batch [600/782] training loss = 1.34450805, training pgd_acc = 0.48437500
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 76.25% (7625/10000)
Adversarial accuracy: 45.86% (4586/10000)
Epoch [38/60], Passed time:[191.318/7270.083]
learning rate: 0.010000000000000002
Train with PGD
Batch [0/782] training loss = 1.34488356, training pgd_acc = 0.46875000
Batch [200/782] training loss = 1.48197365, training pgd_acc = 0.42187500
Batch [400/782] training loss = 1.30688250, training pgd_acc = 0.54687500
Batch [600/782] training loss = 1.20948792, training pgd_acc = 0.51562500
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 75.43% (7543/10000)
Adversarial accuracy: 45.43% (4543/10000)
Epoch [39/60], Passed time:[191.317/7461.375]
learning rate: 0.010000000000000002
Train with PGD
Batch [0/782] training loss = 1.50979388, training pgd_acc = 0.34375000
Batch [200/782] training loss = 1.25996149, training pgd_acc = 0.51562500
Batch [400/782] training loss = 1.18210149, training pgd_acc = 0.50000000
Batch [600/782] training loss = 1.21411943, training pgd_acc = 0.51562500
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 75.96% (7596/10000)
Adversarial accuracy: 45.63% (4563/10000)
Epoch [40/60], Passed time:[191.321/7652.845]
learning rate: 0.010000000000000002
Train with PGD
Batch [0/782] training loss = 1.15772176, training pgd_acc = 0.53125000
Batch [200/782] training loss = 1.38955581, training pgd_acc = 0.50000000
Batch [400/782] training loss = 1.18644881, training pgd_acc = 0.53125000
Batch [600/782] training loss = 1.47759771, training pgd_acc = 0.48437500
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 75.78% (7578/10000)
Adversarial accuracy: 45.84% (4584/10000)
Epoch [41/60], Passed time:[191.320/7844.117]
learning rate: 0.010000000000000002
Train with PGD
Batch [0/782] training loss = 1.27263808, training pgd_acc = 0.53125000
Batch [200/782] training loss = 1.28353822, training pgd_acc = 0.43750000
Batch [400/782] training loss = 1.40449619, training pgd_acc = 0.50000000
Batch [600/782] training loss = 1.51029408, training pgd_acc = 0.43750000
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 75.64% (7564/10000)
Adversarial accuracy: 45.54% (4554/10000)
Epoch [42/60], Passed time:[191.320/8035.444]
learning rate: 0.010000000000000002
Train with PGD
Batch [0/782] training loss = 1.38905120, training pgd_acc = 0.50000000
Batch [200/782] training loss = 1.21300519, training pgd_acc = 0.50000000
Batch [400/782] training loss = 1.17465270, training pgd_acc = 0.57812500
Batch [600/782] training loss = 1.28134882, training pgd_acc = 0.43750000
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 75.02% (7502/10000)
Adversarial accuracy: 45.25% (4525/10000)
Epoch [43/60], Passed time:[191.320/8226.746]
learning rate: 0.010000000000000002
Train with PGD
Batch [0/782] training loss = 1.26831424, training pgd_acc = 0.50000000
Batch [200/782] training loss = 1.23054910, training pgd_acc = 0.54687500
Batch [400/782] training loss = 1.32566142, training pgd_acc = 0.51562500
Batch [600/782] training loss = 1.33534455, training pgd_acc = 0.46875000
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 75.82% (7582/10000)
Adversarial accuracy: 45.78% (4578/10000)
Epoch [44/60], Passed time:[191.319/8418.038]
learning rate: 0.010000000000000002
Train with PGD
Batch [0/782] training loss = 1.27923751, training pgd_acc = 0.50000000
Batch [200/782] training loss = 1.40657496, training pgd_acc = 0.40625000
Batch [400/782] training loss = 1.28384817, training pgd_acc = 0.51562500
Batch [600/782] training loss = 1.22801697, training pgd_acc = 0.59375000
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 75.64% (7564/10000)
Adversarial accuracy: 45.63% (4563/10000)
Epoch [45/60], Passed time:[191.323/8609.513]
learning rate: 0.0010000000000000002
Train with PGD
Batch [0/782] training loss = 1.15452993, training pgd_acc = 0.54687500
Batch [200/782] training loss = 1.26572800, training pgd_acc = 0.54687500
Batch [400/782] training loss = 1.23762262, training pgd_acc = 0.53125000
Batch [600/782] training loss = 1.25216961, training pgd_acc = 0.50000000
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 76.47% (7647/10000)
Adversarial accuracy: 45.82% (4582/10000)
Epoch [46/60], Passed time:[191.322/8800.828]
learning rate: 0.0010000000000000002
Train with PGD
Batch [0/782] training loss = 1.29071343, training pgd_acc = 0.50000000
Batch [200/782] training loss = 1.00524950, training pgd_acc = 0.57812500
Batch [400/782] training loss = 1.17010343, training pgd_acc = 0.57812500
Batch [600/782] training loss = 1.27755392, training pgd_acc = 0.46875000
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 76.38% (7638/10000)
Adversarial accuracy: 45.75% (4575/10000)
Epoch [47/60], Passed time:[191.324/8992.228]
learning rate: 0.0010000000000000002
Train with PGD
Batch [0/782] training loss = 1.37861657, training pgd_acc = 0.48437500
Batch [200/782] training loss = 1.14352322, training pgd_acc = 0.59375000
Batch [400/782] training loss = 1.24496377, training pgd_acc = 0.50000000
Batch [600/782] training loss = 1.23362112, training pgd_acc = 0.45312500
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 76.71% (7671/10000)
Adversarial accuracy: 45.72% (4572/10000)
Epoch [48/60], Passed time:[191.324/9183.553]
learning rate: 0.0010000000000000002
Train with PGD
Batch [0/782] training loss = 1.25381994, training pgd_acc = 0.51562500
Batch [200/782] training loss = 1.39244294, training pgd_acc = 0.39062500
Batch [400/782] training loss = 1.26635647, training pgd_acc = 0.48437500
Batch [600/782] training loss = 1.35636497, training pgd_acc = 0.50000000
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 76.69% (7669/10000)
Adversarial accuracy: 45.91% (4591/10000)
Epoch [49/60], Passed time:[191.325/9374.932]
learning rate: 0.0010000000000000002
Train with PGD
Batch [0/782] training loss = 1.06636238, training pgd_acc = 0.57812500
Batch [200/782] training loss = 1.21110737, training pgd_acc = 0.54687500
Batch [400/782] training loss = 1.11826110, training pgd_acc = 0.54687500
Batch [600/782] training loss = 1.43606985, training pgd_acc = 0.43750000
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 76.17% (7617/10000)
Adversarial accuracy: 45.89% (4589/10000)
Epoch [50/60], Passed time:[191.325/9566.262]
learning rate: 0.0010000000000000002
Train with PGD
Batch [0/782] training loss = 1.42492473, training pgd_acc = 0.51562500
Batch [200/782] training loss = 1.20073640, training pgd_acc = 0.53125000
Batch [400/782] training loss = 1.30598342, training pgd_acc = 0.50000000
Batch [600/782] training loss = 1.24546099, training pgd_acc = 0.51562500
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 76.78% (7678/10000)
Adversarial accuracy: 45.34% (4534/10000)
Epoch [51/60], Passed time:[191.328/9757.708]
learning rate: 0.0010000000000000002
Train with PGD
Batch [0/782] training loss = 1.17696452, training pgd_acc = 0.50000000
Batch [200/782] training loss = 1.28794789, training pgd_acc = 0.50000000
Batch [400/782] training loss = 0.98187906, training pgd_acc = 0.59375000
Batch [600/782] training loss = 1.28358173, training pgd_acc = 0.51562500
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 76.64% (7664/10000)
Adversarial accuracy: 45.78% (4578/10000)
Epoch [52/60], Passed time:[191.330/9949.162]
learning rate: 0.0010000000000000002
Train with PGD
Batch [0/782] training loss = 1.24919271, training pgd_acc = 0.43750000
Batch [200/782] training loss = 1.30009878, training pgd_acc = 0.53125000
Batch [400/782] training loss = 1.14050853, training pgd_acc = 0.54687500
Batch [600/782] training loss = 1.27857625, training pgd_acc = 0.56250000
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 76.78% (7678/10000)
Adversarial accuracy: 45.44% (4544/10000)
Epoch [53/60], Passed time:[191.330/10140.488]
learning rate: 0.0010000000000000002
Train with PGD
Batch [0/782] training loss = 1.11427462, training pgd_acc = 0.54687500
Batch [200/782] training loss = 1.14564061, training pgd_acc = 0.54687500
Batch [400/782] training loss = 1.18012857, training pgd_acc = 0.64062500
Batch [600/782] training loss = 1.18403363, training pgd_acc = 0.60937500
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 76.48% (7648/10000)
Adversarial accuracy: 45.78% (4578/10000)
Epoch [54/60], Passed time:[191.329/10331.743]
learning rate: 0.0010000000000000002
Train with PGD
Batch [0/782] training loss = 1.32729423, training pgd_acc = 0.45312500
Batch [200/782] training loss = 1.38211644, training pgd_acc = 0.48437500
Batch [400/782] training loss = 1.31420493, training pgd_acc = 0.53125000
Batch [600/782] training loss = 1.24389350, training pgd_acc = 0.56250000
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 76.57% (7657/10000)
Adversarial accuracy: 45.88% (4588/10000)
Epoch [55/60], Passed time:[191.328/10523.029]
learning rate: 0.0010000000000000002
Train with PGD
Batch [0/782] training loss = 1.44374549, training pgd_acc = 0.35937500
Batch [200/782] training loss = 1.19100142, training pgd_acc = 0.53125000
Batch [400/782] training loss = 1.17789912, training pgd_acc = 0.56250000
Batch [600/782] training loss = 1.49157977, training pgd_acc = 0.42187500
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 76.90% (7690/10000)
Adversarial accuracy: 45.88% (4588/10000)
Epoch [56/60], Passed time:[191.327/10714.327]
learning rate: 0.0010000000000000002
Train with PGD
Batch [0/782] training loss = 1.18372500, training pgd_acc = 0.57812500
Batch [200/782] training loss = 1.09674644, training pgd_acc = 0.57812500
Batch [400/782] training loss = 1.36333394, training pgd_acc = 0.42187500
Batch [600/782] training loss = 1.11389279, training pgd_acc = 0.57812500
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 76.81% (7681/10000)
Adversarial accuracy: 45.60% (4560/10000)
Epoch [57/60], Passed time:[191.325/10905.497]
learning rate: 0.0010000000000000002
Train with PGD
Batch [0/782] training loss = 1.25540221, training pgd_acc = 0.53125000
Batch [200/782] training loss = 1.34321773, training pgd_acc = 0.45312500
Batch [400/782] training loss = 1.24598706, training pgd_acc = 0.50000000
Batch [600/782] training loss = 0.98004961, training pgd_acc = 0.62500000
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 76.49% (7649/10000)
Adversarial accuracy: 45.45% (4545/10000)
Epoch [58/60], Passed time:[191.326/11096.921]
learning rate: 0.0010000000000000002
Train with PGD
Batch [0/782] training loss = 1.23861539, training pgd_acc = 0.51562500
Batch [200/782] training loss = 1.23937750, training pgd_acc = 0.59375000
Batch [400/782] training loss = 1.10809326, training pgd_acc = 0.59375000
Batch [600/782] training loss = 1.23058915, training pgd_acc = 0.48437500
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 76.62% (7662/10000)
Adversarial accuracy: 45.88% (4588/10000)
Epoch [59/60], Passed time:[191.325/11288.150]
learning rate: 0.0010000000000000002
Train with PGD
Batch [0/782] training loss = 1.15622449, training pgd_acc = 0.51562500
Batch [200/782] training loss = 1.06731021, training pgd_acc = 0.54687500
Batch [400/782] training loss = 1.19540215, training pgd_acc = 0.51562500
Batch [600/782] training loss = 1.31102645, training pgd_acc = 0.45312500
Valid Test with PGD
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 76.48% (7648/10000)
Adversarial accuracy: 45.73% (4573/10000)
Training done, model saved in ./trained_models_new/cifar/vgg16/fgsm/pruned1_epoch100_r80/init_pure/init_enhance60_madry_m0.01_nn_warmup0.1_nn.pth
Test on test set:
Evaluating with pgd untargeted attack,eps=0.031373, iters=10, attack_steps=0.007843
Clean accuracy: 76.48% (7648/10000)
Adversarial accuracy: 45.73% (4573/10000)
