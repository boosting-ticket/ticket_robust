model_type : resnet18
init_type : pure
finetune_method : nat
enhance_method : nat
gpu : 7
model_name : init_enhance20_m0.005_warmup0.1
model_width : 8
n_pruning_steps : 1
max_pruning_ratio : 80
train_epochs : 20
enhance_epochs : 20
prune_method : unstructured
dataset : cifar
noise_sd : 1.0
trades_beta : 6.0
seed : 7
warmup : True
parallel : False
create_init : False
init_step : 1400
train_method : nat
early_stop : 1000
norm : True
optm : sgd
batch_size : 128
test_batch_size : 100
learning_rate : 0.1
enhance_learning_rate : 0.1
schedule_length : 10
weight_decay : 0.0001
epsilon : 0.03137254901960784
attack_iter : 10
eps_step : 0.00784313725490196
targeted : False
clip_min : 0
clip_max : 1.0
starting_epsilon : 1e-05
interval_weight : 0.1
ft_interval_weight : 50
verbose : 200
resume : 0
model_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.005_warmup0.1.pth
last_model_path : ./trained_models_new/
mask_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/pruned_lr0.005_mask_r80.npy
mask_name : pruned_lr0.005_mask_r80
log_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.005_warmup0.1.log
init_path : ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
results_path : None
n_classes : 10
eval : False
init : True
transfer : False
CUDA enabled.
Enhance training config:
Enhance training method: nat
model will be saved in: ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.005_warmup0.1.pth
Init model is: ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
Init mask used from: ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/pruned_lr0.005_mask_r80.npy
Log will be saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.005_warmup0.1.log
Random seed is: 7

model loading from ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
Epoch [0/20]
learning rate: 0.05
Batch [0/352] training loss = 2.2624, training acc = 0.12
Batch [200/352] training loss = 0.8212, training acc = 0.73
Valid Test with nat
Test accuracy: 71.92% (3596/5000), Test loss:0.8643
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.005_warmup0.1.pth
Test on test set:
Test accuracy: 72.92% (7292/10000), Test loss:0.7991
Epoch [1/20], Passed time:[96.643/96.643]
learning rate: 0.055
Batch [0/352] training loss = 0.7277, training acc = 0.73
Batch [200/352] training loss = 0.7351, training acc = 0.73
Valid Test with nat
Test accuracy: 73.80% (3690/5000), Test loss:0.8859
Epoch [2/20], Passed time:[93.739/187.477]
learning rate: 0.060000000000000005
Batch [0/352] training loss = 0.5330, training acc = 0.82
Batch [200/352] training loss = 0.4879, training acc = 0.84
Valid Test with nat
Test accuracy: 76.42% (3821/5000), Test loss:0.7872
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.005_warmup0.1.pth
Test on test set:
Test accuracy: 75.97% (7597/10000), Test loss:0.7933
Epoch [3/20], Passed time:[95.342/286.026]
learning rate: 0.065
Batch [0/352] training loss = 0.5399, training acc = 0.85
Batch [200/352] training loss = 0.5568, training acc = 0.76
Valid Test with nat
Test accuracy: 75.38% (3769/5000), Test loss:0.8668
Epoch [4/20], Passed time:[94.866/379.462]
learning rate: 0.07
Batch [0/352] training loss = 0.2327, training acc = 0.93
Batch [200/352] training loss = 0.4019, training acc = 0.87
Valid Test with nat
Test accuracy: 79.94% (3997/5000), Test loss:0.6528
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.005_warmup0.1.pth
Test on test set:
Test accuracy: 79.65% (7965/10000), Test loss:0.6492
Epoch [5/20], Passed time:[95.511/477.554]
learning rate: 0.07500000000000001
Batch [0/352] training loss = 0.4181, training acc = 0.84
Batch [200/352] training loss = 0.4991, training acc = 0.82
Valid Test with nat
Test accuracy: 81.08% (4054/5000), Test loss:0.6032
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.005_warmup0.1.pth
Test on test set:
Test accuracy: 79.59% (7959/10000), Test loss:0.6684
Epoch [6/20], Passed time:[95.837/575.020]
learning rate: 0.08000000000000002
Batch [0/352] training loss = 0.3165, training acc = 0.87
Batch [200/352] training loss = 0.4000, training acc = 0.83
Valid Test with nat
Test accuracy: 82.84% (4142/5000), Test loss:0.5455
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.005_warmup0.1.pth
Test on test set:
Test accuracy: 81.51% (8151/10000), Test loss:0.5737
Epoch [7/20], Passed time:[94.938/664.567]
learning rate: 0.085
Batch [0/352] training loss = 0.3317, training acc = 0.86
Batch [200/352] training loss = 0.4115, training acc = 0.85
Valid Test with nat
Test accuracy: 82.74% (4137/5000), Test loss:0.5363
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.005_warmup0.1.pth
Test on test set:
Test accuracy: 84.05% (8405/10000), Test loss:0.5050
Epoch [8/20], Passed time:[93.388/747.103]
learning rate: 0.09
Batch [0/352] training loss = 0.2985, training acc = 0.89
Batch [200/352] training loss = 0.4001, training acc = 0.85
Valid Test with nat
Test accuracy: 81.46% (4073/5000), Test loss:0.6169
Epoch [9/20], Passed time:[92.789/835.103]
learning rate: 0.095
Batch [0/352] training loss = 0.2492, training acc = 0.92
Batch [200/352] training loss = 0.2502, training acc = 0.91
Valid Test with nat
Test accuracy: 83.30% (4165/5000), Test loss:0.5334
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.005_warmup0.1.pth
Test on test set:
Test accuracy: 83.46% (8346/10000), Test loss:0.5323
Epoch [10/20], Passed time:[93.074/930.742]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.3172, training acc = 0.87
Batch [200/352] training loss = 0.2730, training acc = 0.90
Valid Test with nat
Test accuracy: 89.78% (4489/5000), Test loss:0.3107
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.005_warmup0.1.pth
Test on test set:
Test accuracy: 89.84% (8984/10000), Test loss:0.3185
Epoch [11/20], Passed time:[93.617/1029.787]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.3417, training acc = 0.90
Batch [200/352] training loss = 0.2016, training acc = 0.92
Valid Test with nat
Test accuracy: 90.50% (4525/5000), Test loss:0.3076
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.005_warmup0.1.pth
Test on test set:
Test accuracy: 90.15% (9015/10000), Test loss:0.3117
Epoch [12/20], Passed time:[93.666/1123.990]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.1564, training acc = 0.95
Batch [200/352] training loss = 0.1588, training acc = 0.96
Valid Test with nat
Test accuracy: 90.36% (4518/5000), Test loss:0.3117
Epoch [13/20], Passed time:[93.238/1212.099]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.2080, training acc = 0.91
Batch [200/352] training loss = 0.2222, training acc = 0.91
Valid Test with nat
Test accuracy: 90.62% (4531/5000), Test loss:0.3010
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.005_warmup0.1.pth
Test on test set:
Test accuracy: 90.59% (9059/10000), Test loss:0.3059
Epoch [14/20], Passed time:[93.709/1311.923]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.1819, training acc = 0.95
Batch [200/352] training loss = 0.1689, training acc = 0.90
Valid Test with nat
Test accuracy: 90.54% (4527/5000), Test loss:0.2934
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.005_warmup0.1.pth
Test on test set:
Test accuracy: 90.69% (9069/10000), Test loss:0.3052
Epoch [15/20], Passed time:[93.985/1409.769]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.1827, training acc = 0.96
Batch [200/352] training loss = 0.1544, training acc = 0.94
Valid Test with nat
Test accuracy: 91.08% (4554/5000), Test loss:0.2847
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.005_warmup0.1.pth
Test on test set:
Test accuracy: 90.89% (9089/10000), Test loss:0.2981
Epoch [16/20], Passed time:[94.258/1508.123]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0694, training acc = 0.98
Batch [200/352] training loss = 0.1969, training acc = 0.91
Valid Test with nat
Test accuracy: 91.02% (4551/5000), Test loss:0.2844
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.005_warmup0.1.pth
Test on test set:
Test accuracy: 90.71% (9071/10000), Test loss:0.3007
Epoch [17/20], Passed time:[94.335/1603.689]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.1490, training acc = 0.93
Batch [200/352] training loss = 0.0853, training acc = 0.96
Valid Test with nat
Test accuracy: 90.94% (4547/5000), Test loss:0.2939
Epoch [18/20], Passed time:[94.381/1698.864]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.1769, training acc = 0.95
Batch [200/352] training loss = 0.1686, training acc = 0.95
Valid Test with nat
Test accuracy: 91.14% (4557/5000), Test loss:0.2867
Epoch [19/20], Passed time:[94.508/1795.652]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.1681, training acc = 0.93
Batch [200/352] training loss = 0.1325, training acc = 0.95
Valid Test with nat
Test accuracy: 91.12% (4556/5000), Test loss:0.2909
Training done, model saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.005_warmup0.1.pth
Test on test set:
Test accuracy: 90.80% (9080/10000), Test loss:0.2975
