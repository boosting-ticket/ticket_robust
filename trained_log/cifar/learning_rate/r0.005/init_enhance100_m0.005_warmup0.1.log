model_type : resnet18
init_type : pure
finetune_method : nat
enhance_method : nat
gpu : 9
model_name : init_enhance100_m0.005_warmup0.1
model_width : 8
n_pruning_steps : 1
max_pruning_ratio : 80
train_epochs : 100
enhance_epochs : 100
prune_method : unstructured
dataset : cifar
noise_sd : 1.0
trades_beta : 6.0
seed : 7
warmup : True
parallel : False
create_init : False
init_step : 1400
train_method : nat
early_stop : 1000
norm : True
optm : sgd
batch_size : 128
test_batch_size : 100
learning_rate : 0.1
enhance_learning_rate : 0.1
schedule_length : 10
weight_decay : 0.0001
epsilon : 0.03137254901960784
attack_iter : 10
eps_step : 0.00784313725490196
targeted : False
clip_min : 0
clip_max : 1.0
starting_epsilon : 1e-05
interval_weight : 0.1
ft_interval_weight : 50
verbose : 200
resume : 0
model_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance100_m0.005_warmup0.1.pth
last_model_path : ./trained_models_new/
mask_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/pruned_lr0.005_mask_r80.npy
mask_name : pruned_lr0.005_mask_r80
log_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance100_m0.005_warmup0.1.log
init_path : ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
results_path : None
n_classes : 10
eval : False
init : True
transfer : False
CUDA enabled.
Enhance training config:
Enhance training method: nat
model will be saved in: ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance100_m0.005_warmup0.1.pth
Init model is: ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
Init mask used from: ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/pruned_lr0.005_mask_r80.npy
Log will be saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance100_m0.005_warmup0.1.log
Random seed is: 7

model loading from ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
Epoch [0/100]
learning rate: 0.05
Batch [0/352] training loss = 2.2624, training acc = 0.12
Batch [200/352] training loss = 0.8212, training acc = 0.73
Valid Test with nat
Test accuracy: 71.92% (3596/5000), Test loss:0.8643
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance100_m0.005_warmup0.1.pth
Test on test set:
Test accuracy: 72.92% (7292/10000), Test loss:0.7991
Epoch [1/100], Passed time:[98.787/98.787]
learning rate: 0.055
Batch [0/352] training loss = 0.7277, training acc = 0.73
Batch [200/352] training loss = 0.7351, training acc = 0.73
Valid Test with nat
Test accuracy: 73.80% (3690/5000), Test loss:0.8859
Epoch [2/100], Passed time:[98.126/196.252]
learning rate: 0.060000000000000005
Batch [0/352] training loss = 0.5330, training acc = 0.82
Batch [200/352] training loss = 0.4879, training acc = 0.84
Valid Test with nat
Test accuracy: 76.42% (3821/5000), Test loss:0.7872
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance100_m0.005_warmup0.1.pth
Test on test set:
Test accuracy: 75.97% (7597/10000), Test loss:0.7933
Epoch [3/100], Passed time:[97.133/291.400]
learning rate: 0.065
Batch [0/352] training loss = 0.5399, training acc = 0.85
Batch [200/352] training loss = 0.5568, training acc = 0.76
Valid Test with nat
Test accuracy: 75.38% (3769/5000), Test loss:0.8668
Epoch [4/100], Passed time:[94.466/377.865]
learning rate: 0.07
Batch [0/352] training loss = 0.2327, training acc = 0.93
Batch [200/352] training loss = 0.4019, training acc = 0.87
Valid Test with nat
Test accuracy: 79.94% (3997/5000), Test loss:0.6528
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance100_m0.005_warmup0.1.pth
Test on test set:
Test accuracy: 79.65% (7965/10000), Test loss:0.6492
Epoch [5/100], Passed time:[93.798/468.992]
learning rate: 0.07500000000000001
Batch [0/352] training loss = 0.4181, training acc = 0.84
Batch [200/352] training loss = 0.4991, training acc = 0.82
Valid Test with nat
Test accuracy: 81.08% (4054/5000), Test loss:0.6032
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance100_m0.005_warmup0.1.pth
Test on test set:
Test accuracy: 79.59% (7959/10000), Test loss:0.6684
Epoch [6/100], Passed time:[93.288/559.725]
learning rate: 0.08000000000000002
Batch [0/352] training loss = 0.3165, training acc = 0.87
Batch [200/352] training loss = 0.4000, training acc = 0.83
Valid Test with nat
Test accuracy: 82.84% (4142/5000), Test loss:0.5455
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance100_m0.005_warmup0.1.pth
Test on test set:
Test accuracy: 81.51% (8151/10000), Test loss:0.5737
Epoch [7/100], Passed time:[92.847/649.931]
learning rate: 0.085
Batch [0/352] training loss = 0.3317, training acc = 0.86
Batch [200/352] training loss = 0.4115, training acc = 0.85
Valid Test with nat
Test accuracy: 82.74% (4137/5000), Test loss:0.5363
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance100_m0.005_warmup0.1.pth
Test on test set:
Test accuracy: 84.05% (8405/10000), Test loss:0.5050
Epoch [8/100], Passed time:[92.790/742.320]
learning rate: 0.09
Batch [0/352] training loss = 0.2985, training acc = 0.89
Batch [200/352] training loss = 0.4001, training acc = 0.85
Valid Test with nat
Test accuracy: 81.46% (4073/5000), Test loss:0.6169
Epoch [9/100], Passed time:[92.531/832.776]
learning rate: 0.095
Batch [0/352] training loss = 0.2492, training acc = 0.92
Batch [200/352] training loss = 0.2502, training acc = 0.91
Valid Test with nat
Test accuracy: 83.30% (4165/5000), Test loss:0.5334
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance100_m0.005_warmup0.1.pth
Test on test set:
Test accuracy: 83.46% (8346/10000), Test loss:0.5323
Epoch [10/100], Passed time:[92.846/928.460]
learning rate: 0.1
Batch [0/352] training loss = 0.3172, training acc = 0.87
Batch [200/352] training loss = 0.4798, training acc = 0.85
Valid Test with nat
Test accuracy: 83.26% (4163/5000), Test loss:0.5680
Epoch [11/100], Passed time:[92.850/1021.346]
learning rate: 0.1
Batch [0/352] training loss = 0.3708, training acc = 0.85
Batch [200/352] training loss = 0.3549, training acc = 0.89
Valid Test with nat
Test accuracy: 85.56% (4278/5000), Test loss:0.4430
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance100_m0.005_warmup0.1.pth
Test on test set:
Test accuracy: 83.99% (8399/10000), Test loss:0.5055
Epoch [12/100], Passed time:[92.913/1114.960]
learning rate: 0.1
Batch [0/352] training loss = 0.2554, training acc = 0.90
Batch [200/352] training loss = 0.2902, training acc = 0.89
Valid Test with nat
Test accuracy: 85.60% (4280/5000), Test loss:0.4883
Epoch [13/100], Passed time:[92.584/1203.595]
learning rate: 0.1
Batch [0/352] training loss = 0.3179, training acc = 0.89
Batch [200/352] training loss = 0.2639, training acc = 0.92
Valid Test with nat
Test accuracy: 86.28% (4314/5000), Test loss:0.4408
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance100_m0.005_warmup0.1.pth
Test on test set:
Test accuracy: 84.78% (8478/10000), Test loss:0.4772
Epoch [14/100], Passed time:[92.315/1292.415]
learning rate: 0.1
Batch [0/352] training loss = 0.2441, training acc = 0.93
Batch [200/352] training loss = 0.3504, training acc = 0.90
Valid Test with nat
Test accuracy: 85.96% (4298/5000), Test loss:0.4530
Epoch [15/100], Passed time:[91.605/1374.080]
learning rate: 0.1
Batch [0/352] training loss = 0.2113, training acc = 0.90
Batch [200/352] training loss = 0.3475, training acc = 0.85
Valid Test with nat
Test accuracy: 87.04% (4352/5000), Test loss:0.4330
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance100_m0.005_warmup0.1.pth
Test on test set:
Test accuracy: 86.55% (8655/10000), Test loss:0.4447
Epoch [16/100], Passed time:[90.943/1455.088]
learning rate: 0.1
Batch [0/352] training loss = 0.2512, training acc = 0.90
Batch [200/352] training loss = 0.1997, training acc = 0.91
Valid Test with nat
Test accuracy: 86.28% (4314/5000), Test loss:0.4505
Epoch [17/100], Passed time:[90.301/1535.113]
learning rate: 0.1
Batch [0/352] training loss = 0.3361, training acc = 0.89
Batch [200/352] training loss = 0.3874, training acc = 0.86
Valid Test with nat
Test accuracy: 85.88% (4294/5000), Test loss:0.4778
Epoch [18/100], Passed time:[89.693/1614.477]
learning rate: 0.1
Batch [0/352] training loss = 0.1578, training acc = 0.96
Batch [200/352] training loss = 0.2671, training acc = 0.90
Valid Test with nat
Test accuracy: 87.68% (4384/5000), Test loss:0.3829
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance100_m0.005_warmup0.1.pth
Test on test set:
Test accuracy: 87.84% (8784/10000), Test loss:0.3709
Epoch [19/100], Passed time:[89.221/1695.191]
learning rate: 0.1
Batch [0/352] training loss = 0.2149, training acc = 0.94
Batch [200/352] training loss = 0.2418, training acc = 0.91
Valid Test with nat
Test accuracy: 87.12% (4356/5000), Test loss:0.3915
Epoch [20/100], Passed time:[88.760/1775.206]
learning rate: 0.1
Batch [0/352] training loss = 0.2262, training acc = 0.91
Batch [200/352] training loss = 0.2767, training acc = 0.89
Valid Test with nat
Test accuracy: 85.76% (4288/5000), Test loss:0.4754
Epoch [21/100], Passed time:[88.387/1856.134]
learning rate: 0.1
Batch [0/352] training loss = 0.3521, training acc = 0.88
Batch [200/352] training loss = 0.3114, training acc = 0.88
Valid Test with nat
Test accuracy: 86.40% (4320/5000), Test loss:0.5062
Epoch [22/100], Passed time:[88.021/1936.461]
learning rate: 0.1
Batch [0/352] training loss = 0.3196, training acc = 0.91
Batch [200/352] training loss = 0.2000, training acc = 0.95
Valid Test with nat
Test accuracy: 85.44% (4272/5000), Test loss:0.4975
Epoch [23/100], Passed time:[87.597/2014.724]
learning rate: 0.1
Batch [0/352] training loss = 0.2667, training acc = 0.91
Batch [200/352] training loss = 0.3362, training acc = 0.87
Valid Test with nat
Test accuracy: 87.50% (4375/5000), Test loss:0.4074
Epoch [24/100], Passed time:[87.329/2095.886]
learning rate: 0.1
Batch [0/352] training loss = 0.2178, training acc = 0.91
Batch [200/352] training loss = 0.2136, training acc = 0.92
Valid Test with nat
Test accuracy: 85.82% (4291/5000), Test loss:0.4781
Epoch [25/100], Passed time:[86.961/2174.016]
learning rate: 0.1
Batch [0/352] training loss = 0.1764, training acc = 0.95
Batch [200/352] training loss = 0.2906, training acc = 0.91
Valid Test with nat
Test accuracy: 84.48% (4224/5000), Test loss:0.5282
Epoch [26/100], Passed time:[86.644/2252.739]
learning rate: 0.1
Batch [0/352] training loss = 0.2035, training acc = 0.94
Batch [200/352] training loss = 0.3720, training acc = 0.89
Valid Test with nat
Test accuracy: 84.52% (4226/5000), Test loss:0.5182
Epoch [27/100], Passed time:[86.438/2333.835]
learning rate: 0.1
Batch [0/352] training loss = 0.2031, training acc = 0.92
Batch [200/352] training loss = 0.1838, training acc = 0.94
Valid Test with nat
Test accuracy: 88.02% (4401/5000), Test loss:0.3851
Epoch [28/100], Passed time:[86.138/2411.854]
learning rate: 0.1
Batch [0/352] training loss = 0.2044, training acc = 0.93
Batch [200/352] training loss = 0.2448, training acc = 0.92
Valid Test with nat
Test accuracy: 86.94% (4347/5000), Test loss:0.4361
Epoch [29/100], Passed time:[86.012/2494.362]
learning rate: 0.1
Batch [0/352] training loss = 0.1952, training acc = 0.94
Batch [200/352] training loss = 0.3120, training acc = 0.90
Valid Test with nat
Test accuracy: 86.08% (4304/5000), Test loss:0.4794
Epoch [30/100], Passed time:[85.691/2570.744]
learning rate: 0.1
Batch [0/352] training loss = 0.2016, training acc = 0.94
Batch [200/352] training loss = 0.2023, training acc = 0.94
Valid Test with nat
Test accuracy: 81.86% (4093/5000), Test loss:0.6713
Epoch [31/100], Passed time:[85.412/2647.777]
learning rate: 0.1
Batch [0/352] training loss = 0.1210, training acc = 0.96
Batch [200/352] training loss = 0.1694, training acc = 0.92
Valid Test with nat
Test accuracy: 85.32% (4266/5000), Test loss:0.5117
Epoch [32/100], Passed time:[85.238/2727.619]
learning rate: 0.1
Batch [0/352] training loss = 0.1982, training acc = 0.93
Batch [200/352] training loss = 0.2149, training acc = 0.95
Valid Test with nat
Test accuracy: 85.72% (4286/5000), Test loss:0.5024
Epoch [33/100], Passed time:[85.050/2806.640]
learning rate: 0.1
Batch [0/352] training loss = 0.2488, training acc = 0.94
Batch [200/352] training loss = 0.3442, training acc = 0.88
Valid Test with nat
Test accuracy: 87.04% (4352/5000), Test loss:0.4215
Epoch [34/100], Passed time:[84.681/2879.146]
learning rate: 0.1
Batch [0/352] training loss = 0.2421, training acc = 0.89
Batch [200/352] training loss = 0.3292, training acc = 0.89
Valid Test with nat
Test accuracy: 87.92% (4396/5000), Test loss:0.4098
Epoch [35/100], Passed time:[84.474/2956.575]
learning rate: 0.1
Batch [0/352] training loss = 0.3113, training acc = 0.90
Batch [200/352] training loss = 0.2286, training acc = 0.91
Valid Test with nat
Test accuracy: 88.18% (4409/5000), Test loss:0.4325
Epoch [36/100], Passed time:[84.237/3032.516]
learning rate: 0.1
Batch [0/352] training loss = 0.1772, training acc = 0.92
Batch [200/352] training loss = 0.2607, training acc = 0.91
Valid Test with nat
Test accuracy: 87.64% (4382/5000), Test loss:0.4220
Epoch [37/100], Passed time:[84.029/3109.074]
learning rate: 0.1
Batch [0/352] training loss = 0.1858, training acc = 0.92
Batch [200/352] training loss = 0.2117, training acc = 0.94
Valid Test with nat
Test accuracy: 88.60% (4430/5000), Test loss:0.4101
Epoch [38/100], Passed time:[83.883/3187.564]
learning rate: 0.1
Batch [0/352] training loss = 0.1800, training acc = 0.93
Batch [200/352] training loss = 0.3478, training acc = 0.88
Valid Test with nat
Test accuracy: 84.90% (4245/5000), Test loss:0.5186
Epoch [39/100], Passed time:[83.814/3268.747]
learning rate: 0.1
Batch [0/352] training loss = 0.1562, training acc = 0.94
Batch [200/352] training loss = 0.1955, training acc = 0.93
Valid Test with nat
Test accuracy: 87.14% (4357/5000), Test loss:0.4530
Epoch [40/100], Passed time:[83.553/3342.112]
learning rate: 0.1
Batch [0/352] training loss = 0.1673, training acc = 0.95
Batch [200/352] training loss = 0.1467, training acc = 0.95
Valid Test with nat
Test accuracy: 84.84% (4242/5000), Test loss:0.5466
Epoch [41/100], Passed time:[83.204/3411.359]
learning rate: 0.1
Batch [0/352] training loss = 0.1952, training acc = 0.92
Batch [200/352] training loss = 0.1895, training acc = 0.93
Valid Test with nat
Test accuracy: 86.36% (4318/5000), Test loss:0.4806
Epoch [42/100], Passed time:[82.860/3480.112]
learning rate: 0.1
Batch [0/352] training loss = 0.1911, training acc = 0.95
Batch [200/352] training loss = 0.1751, training acc = 0.92
Valid Test with nat
Test accuracy: 87.94% (4397/5000), Test loss:0.4210
Epoch [43/100], Passed time:[82.494/3547.231]
learning rate: 0.1
Batch [0/352] training loss = 0.2005, training acc = 0.94
Batch [200/352] training loss = 0.3984, training acc = 0.89
Valid Test with nat
Test accuracy: 87.38% (4369/5000), Test loss:0.4197
Epoch [44/100], Passed time:[82.187/3616.234]
learning rate: 0.1
Batch [0/352] training loss = 0.2852, training acc = 0.91
Batch [200/352] training loss = 0.1854, training acc = 0.92
Valid Test with nat
Test accuracy: 88.82% (4441/5000), Test loss:0.3665
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance100_m0.005_warmup0.1.pth
Test on test set:
Test accuracy: 88.70% (8870/10000), Test loss:0.3801
Epoch [45/100], Passed time:[81.905/3685.732]
learning rate: 0.1
Batch [0/352] training loss = 0.1430, training acc = 0.95
Batch [200/352] training loss = 0.1444, training acc = 0.96
Valid Test with nat
Test accuracy: 88.90% (4445/5000), Test loss:0.3845
Epoch [46/100], Passed time:[81.637/3755.300]
learning rate: 0.1
Batch [0/352] training loss = 0.1230, training acc = 0.96
Batch [200/352] training loss = 0.1994, training acc = 0.94
Valid Test with nat
Test accuracy: 88.62% (4431/5000), Test loss:0.3689
Epoch [47/100], Passed time:[81.366/3824.213]
learning rate: 0.1
Batch [0/352] training loss = 0.1926, training acc = 0.91
Batch [200/352] training loss = 0.1878, training acc = 0.95
Valid Test with nat
Test accuracy: 86.52% (4326/5000), Test loss:0.4597
Epoch [48/100], Passed time:[81.204/3897.776]
learning rate: 0.1
Batch [0/352] training loss = 0.2256, training acc = 0.93
Batch [200/352] training loss = 0.1427, training acc = 0.94
Valid Test with nat
Test accuracy: 87.66% (4383/5000), Test loss:0.4081
Epoch [49/100], Passed time:[80.948/3966.459]
learning rate: 0.1
Batch [0/352] training loss = 0.2309, training acc = 0.92
Batch [200/352] training loss = 0.2017, training acc = 0.94
Valid Test with nat
Test accuracy: 84.46% (4223/5000), Test loss:0.5345
Epoch [50/100], Passed time:[80.771/4038.536]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.1681, training acc = 0.95
Batch [200/352] training loss = 0.0936, training acc = 0.98
Valid Test with nat
Test accuracy: 92.26% (4613/5000), Test loss:0.2465
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance100_m0.005_warmup0.1.pth
Test on test set:
Test accuracy: 92.07% (9207/10000), Test loss:0.2574
Epoch [51/100], Passed time:[80.647/4113.014]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0600, training acc = 0.98
Batch [200/352] training loss = 0.0543, training acc = 0.99
Valid Test with nat
Test accuracy: 92.60% (4630/5000), Test loss:0.2421
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance100_m0.005_warmup0.1.pth
Test on test set:
Test accuracy: 92.48% (9248/10000), Test loss:0.2506
Epoch [52/100], Passed time:[80.509/4186.453]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.1147, training acc = 0.96
Batch [200/352] training loss = 0.0808, training acc = 0.97
Valid Test with nat
Test accuracy: 92.56% (4628/5000), Test loss:0.2553
Epoch [53/100], Passed time:[80.284/4255.034]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0976, training acc = 0.97
Batch [200/352] training loss = 0.0481, training acc = 0.98
Valid Test with nat
Test accuracy: 92.64% (4632/5000), Test loss:0.2633
Epoch [54/100], Passed time:[80.124/4326.685]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0653, training acc = 0.98
Batch [200/352] training loss = 0.0597, training acc = 0.98
Valid Test with nat
Test accuracy: 92.74% (4637/5000), Test loss:0.2499
Epoch [55/100], Passed time:[79.932/4396.255]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0621, training acc = 0.98
Batch [200/352] training loss = 0.1095, training acc = 0.95
Valid Test with nat
Test accuracy: 93.12% (4656/5000), Test loss:0.2464
Epoch [56/100], Passed time:[79.684/4462.307]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0343, training acc = 0.98
Batch [200/352] training loss = 0.0526, training acc = 0.98
Valid Test with nat
Test accuracy: 93.08% (4654/5000), Test loss:0.2519
Epoch [57/100], Passed time:[79.548/4534.209]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0228, training acc = 0.99
Batch [200/352] training loss = 0.1163, training acc = 0.95
Valid Test with nat
Test accuracy: 92.82% (4641/5000), Test loss:0.2503
Epoch [58/100], Passed time:[79.341/4601.778]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0340, training acc = 0.99
Batch [200/352] training loss = 0.0317, training acc = 0.99
Valid Test with nat
Test accuracy: 92.92% (4646/5000), Test loss:0.2641
Epoch [59/100], Passed time:[79.114/4667.745]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0764, training acc = 0.98
Batch [200/352] training loss = 0.0288, training acc = 1.00
Valid Test with nat
Test accuracy: 93.12% (4656/5000), Test loss:0.2784
Epoch [60/100], Passed time:[78.974/4738.467]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0478, training acc = 0.98
Batch [200/352] training loss = 0.0284, training acc = 0.99
Valid Test with nat
Test accuracy: 93.08% (4654/5000), Test loss:0.2577
Epoch [61/100], Passed time:[78.826/4808.372]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0593, training acc = 0.98
Batch [200/352] training loss = 0.0211, training acc = 0.99
Valid Test with nat
Test accuracy: 92.98% (4649/5000), Test loss:0.2614
Epoch [62/100], Passed time:[78.699/4879.331]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0664, training acc = 0.98
Batch [200/352] training loss = 0.0414, training acc = 0.98
Valid Test with nat
Test accuracy: 92.88% (4644/5000), Test loss:0.2696
Epoch [63/100], Passed time:[78.585/4950.857]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0409, training acc = 0.98
Batch [200/352] training loss = 0.0287, training acc = 0.99
Valid Test with nat
Test accuracy: 93.02% (4651/5000), Test loss:0.2617
Epoch [64/100], Passed time:[78.404/5017.863]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0584, training acc = 0.98
Batch [200/352] training loss = 0.0359, training acc = 0.99
Valid Test with nat
Test accuracy: 93.44% (4672/5000), Test loss:0.2624
Epoch [65/100], Passed time:[78.277/5087.998]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0537, training acc = 0.98
Batch [200/352] training loss = 0.0246, training acc = 0.99
Valid Test with nat
Test accuracy: 93.08% (4654/5000), Test loss:0.2606
Epoch [66/100], Passed time:[78.143/5157.446]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0477, training acc = 0.98
Batch [200/352] training loss = 0.0412, training acc = 0.98
Valid Test with nat
Test accuracy: 93.10% (4655/5000), Test loss:0.2668
Epoch [67/100], Passed time:[78.031/5228.090]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0214, training acc = 0.98
Batch [200/352] training loss = 0.0702, training acc = 0.97
Valid Test with nat
Test accuracy: 93.00% (4650/5000), Test loss:0.2959
Epoch [68/100], Passed time:[77.951/5300.683]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0862, training acc = 0.95
Batch [200/352] training loss = 0.0435, training acc = 0.98
Valid Test with nat
Test accuracy: 93.26% (4663/5000), Test loss:0.2652
Epoch [69/100], Passed time:[77.812/5369.008]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0190, training acc = 0.98
Batch [200/352] training loss = 0.0197, training acc = 0.99
Valid Test with nat
Test accuracy: 93.14% (4657/5000), Test loss:0.2753
Epoch [70/100], Passed time:[77.715/5440.031]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0298, training acc = 0.98
Batch [200/352] training loss = 0.0482, training acc = 0.98
Valid Test with nat
Test accuracy: 93.02% (4651/5000), Test loss:0.2748
Epoch [71/100], Passed time:[77.621/5511.116]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0281, training acc = 0.99
Batch [200/352] training loss = 0.0483, training acc = 0.98
Valid Test with nat
Test accuracy: 93.34% (4667/5000), Test loss:0.2689
Epoch [72/100], Passed time:[77.497/5579.796]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0470, training acc = 0.98
Batch [200/352] training loss = 0.0149, training acc = 0.99
Valid Test with nat
Test accuracy: 93.44% (4672/5000), Test loss:0.2932
Epoch [73/100], Passed time:[77.391/5649.574]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0082, training acc = 1.00
Batch [200/352] training loss = 0.0188, training acc = 0.99
Valid Test with nat
Test accuracy: 93.14% (4657/5000), Test loss:0.2776
Epoch [74/100], Passed time:[77.304/5720.483]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0203, training acc = 0.99
Batch [200/352] training loss = 0.0287, training acc = 0.99
Valid Test with nat
Test accuracy: 93.24% (4662/5000), Test loss:0.2838
Epoch [75/100], Passed time:[77.209/5790.658]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0177, training acc = 1.00
Batch [200/352] training loss = 0.0323, training acc = 0.98
Valid Test with nat
Test accuracy: 93.38% (4669/5000), Test loss:0.2737
Epoch [76/100], Passed time:[76.989/5851.138]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0273, training acc = 0.99
Batch [200/352] training loss = 0.0132, training acc = 1.00
Valid Test with nat
Test accuracy: 93.36% (4668/5000), Test loss:0.2750
Epoch [77/100], Passed time:[76.607/5898.727]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0238, training acc = 0.99
Batch [200/352] training loss = 0.0206, training acc = 0.98
Valid Test with nat
Test accuracy: 93.30% (4665/5000), Test loss:0.2700
Epoch [78/100], Passed time:[76.228/5945.804]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0129, training acc = 1.00
Batch [200/352] training loss = 0.0080, training acc = 1.00
Valid Test with nat
Test accuracy: 93.52% (4676/5000), Test loss:0.2791
Epoch [79/100], Passed time:[75.854/5992.504]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0105, training acc = 1.00
Batch [200/352] training loss = 0.0084, training acc = 1.00
Valid Test with nat
Test accuracy: 93.38% (4669/5000), Test loss:0.2682
Epoch [80/100], Passed time:[75.478/6038.270]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0389, training acc = 0.98
Batch [200/352] training loss = 0.0353, training acc = 0.99
Valid Test with nat
Test accuracy: 93.56% (4678/5000), Test loss:0.2670
Epoch [81/100], Passed time:[75.057/6079.592]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0135, training acc = 1.00
Batch [200/352] training loss = 0.0053, training acc = 1.00
Valid Test with nat
Test accuracy: 93.40% (4670/5000), Test loss:0.2663
Epoch [82/100], Passed time:[74.759/6130.247]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0231, training acc = 0.99
Batch [200/352] training loss = 0.0115, training acc = 1.00
Valid Test with nat
Test accuracy: 93.42% (4671/5000), Test loss:0.2691
Epoch [83/100], Passed time:[74.488/6182.505]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0190, training acc = 1.00
Batch [200/352] training loss = 0.0301, training acc = 0.99
Valid Test with nat
Test accuracy: 93.38% (4669/5000), Test loss:0.2745
Epoch [84/100], Passed time:[74.218/6234.300]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0433, training acc = 0.98
Batch [200/352] training loss = 0.0308, training acc = 0.99
Valid Test with nat
Test accuracy: 93.48% (4674/5000), Test loss:0.2692
Epoch [85/100], Passed time:[73.958/6286.393]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0377, training acc = 0.99
Batch [200/352] training loss = 0.0158, training acc = 0.99
Valid Test with nat
Test accuracy: 93.36% (4668/5000), Test loss:0.2672
Epoch [86/100], Passed time:[73.689/6337.251]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0180, training acc = 0.99
Batch [200/352] training loss = 0.0253, training acc = 1.00
Valid Test with nat
Test accuracy: 93.32% (4666/5000), Test loss:0.2875
Epoch [87/100], Passed time:[73.435/6388.830]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0147, training acc = 1.00
Batch [200/352] training loss = 0.0369, training acc = 0.98
Valid Test with nat
Test accuracy: 93.44% (4672/5000), Test loss:0.2685
Epoch [88/100], Passed time:[73.167/6438.712]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0358, training acc = 0.99
Batch [200/352] training loss = 0.0442, training acc = 0.99
Valid Test with nat
Test accuracy: 93.44% (4672/5000), Test loss:0.2700
Epoch [89/100], Passed time:[72.925/6490.355]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0156, training acc = 0.99
Batch [200/352] training loss = 0.0321, training acc = 0.99
Valid Test with nat
Test accuracy: 93.48% (4674/5000), Test loss:0.2923
Epoch [90/100], Passed time:[72.748/6547.348]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0492, training acc = 0.97
Batch [200/352] training loss = 0.0445, training acc = 0.99
Valid Test with nat
Test accuracy: 93.50% (4675/5000), Test loss:0.2671
Epoch [91/100], Passed time:[72.539/6601.046]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0091, training acc = 1.00
Batch [200/352] training loss = 0.0161, training acc = 1.00
Valid Test with nat
Test accuracy: 93.34% (4667/5000), Test loss:0.2702
Epoch [92/100], Passed time:[72.349/6656.125]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0129, training acc = 0.99
Batch [200/352] training loss = 0.0140, training acc = 0.99
Valid Test with nat
Test accuracy: 93.58% (4679/5000), Test loss:0.2677
Epoch [93/100], Passed time:[72.126/6707.681]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0291, training acc = 0.98
Batch [200/352] training loss = 0.0412, training acc = 0.98
Valid Test with nat
Test accuracy: 93.42% (4671/5000), Test loss:0.2727
Epoch [94/100], Passed time:[71.910/6759.555]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0179, training acc = 1.00
Batch [200/352] training loss = 0.0167, training acc = 0.99
Valid Test with nat
Test accuracy: 93.42% (4671/5000), Test loss:0.2706
Epoch [95/100], Passed time:[71.681/6809.720]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0036, training acc = 1.00
Batch [200/352] training loss = 0.0070, training acc = 1.00
Valid Test with nat
Test accuracy: 93.48% (4674/5000), Test loss:0.2672
Epoch [96/100], Passed time:[71.460/6860.180]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0183, training acc = 1.00
Batch [200/352] training loss = 0.0207, training acc = 0.98
Valid Test with nat
Test accuracy: 93.34% (4667/5000), Test loss:0.2837
Epoch [97/100], Passed time:[71.289/6915.057]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0552, training acc = 0.98
Batch [200/352] training loss = 0.0077, training acc = 1.00
Valid Test with nat
Test accuracy: 93.56% (4678/5000), Test loss:0.2682
Epoch [98/100], Passed time:[71.094/6967.173]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0027, training acc = 1.00
Batch [200/352] training loss = 0.0041, training acc = 1.00
Valid Test with nat
Test accuracy: 93.44% (4672/5000), Test loss:0.2703
Epoch [99/100], Passed time:[70.901/7019.202]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0623, training acc = 0.97
Batch [200/352] training loss = 0.0077, training acc = 1.00
Valid Test with nat
Test accuracy: 93.40% (4670/5000), Test loss:0.2709
Training done, model saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance100_m0.005_warmup0.1.pth
Test on test set:
Test accuracy: 92.87% (9287/10000), Test loss:0.2964
