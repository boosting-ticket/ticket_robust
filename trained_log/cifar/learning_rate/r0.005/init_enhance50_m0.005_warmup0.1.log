model_type : resnet18
init_type : pure
finetune_method : nat
enhance_method : nat
gpu : 7
model_name : init_enhance50_m0.005_warmup0.1
model_width : 8
n_pruning_steps : 1
max_pruning_ratio : 80
train_epochs : 50
enhance_epochs : 50
prune_method : unstructured
dataset : cifar
noise_sd : 1.0
trades_beta : 6.0
seed : 7
warmup : True
parallel : False
create_init : False
init_step : 1400
train_method : nat
early_stop : 1000
norm : True
optm : sgd
batch_size : 128
test_batch_size : 100
learning_rate : 0.1
enhance_learning_rate : 0.1
schedule_length : 10
weight_decay : 0.0001
epsilon : 0.03137254901960784
attack_iter : 10
eps_step : 0.00784313725490196
targeted : False
clip_min : 0
clip_max : 1.0
starting_epsilon : 1e-05
interval_weight : 0.1
ft_interval_weight : 50
verbose : 200
resume : 0
model_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance50_m0.005_warmup0.1.pth
last_model_path : ./trained_models_new/
mask_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/pruned_lr0.005_mask_r80.npy
mask_name : pruned_lr0.005_mask_r80
log_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance50_m0.005_warmup0.1.log
init_path : ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
results_path : None
n_classes : 10
eval : False
init : True
transfer : False
CUDA enabled.
Enhance training config:
Enhance training method: nat
model will be saved in: ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance50_m0.005_warmup0.1.pth
Init model is: ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
Init mask used from: ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/pruned_lr0.005_mask_r80.npy
Log will be saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance50_m0.005_warmup0.1.log
Random seed is: 7

model loading from ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
Epoch [0/50]
learning rate: 0.05
Batch [0/352] training loss = 2.2624, training acc = 0.12
Batch [200/352] training loss = 0.8212, training acc = 0.73
Valid Test with nat
Test accuracy: 71.92% (3596/5000), Test loss:0.8643
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance50_m0.005_warmup0.1.pth
Test on test set:
Test accuracy: 72.92% (7292/10000), Test loss:0.7991
Epoch [1/50], Passed time:[96.324/96.324]
learning rate: 0.055
Batch [0/352] training loss = 0.7277, training acc = 0.73
Batch [200/352] training loss = 0.7351, training acc = 0.73
Valid Test with nat
Test accuracy: 73.80% (3690/5000), Test loss:0.8859
Epoch [2/50], Passed time:[93.149/186.299]
learning rate: 0.060000000000000005
Batch [0/352] training loss = 0.5330, training acc = 0.82
Batch [200/352] training loss = 0.4879, training acc = 0.84
Valid Test with nat
Test accuracy: 76.42% (3821/5000), Test loss:0.7872
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance50_m0.005_warmup0.1.pth
Test on test set:
Test accuracy: 75.97% (7597/10000), Test loss:0.7933
Epoch [3/50], Passed time:[92.315/276.944]
learning rate: 0.065
Batch [0/352] training loss = 0.5399, training acc = 0.85
Batch [200/352] training loss = 0.5568, training acc = 0.76
Valid Test with nat
Test accuracy: 75.38% (3769/5000), Test loss:0.8668
Epoch [4/50], Passed time:[91.820/367.280]
learning rate: 0.07
Batch [0/352] training loss = 0.2327, training acc = 0.93
Batch [200/352] training loss = 0.4019, training acc = 0.87
Valid Test with nat
Test accuracy: 79.94% (3997/5000), Test loss:0.6528
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance50_m0.005_warmup0.1.pth
Test on test set:
Test accuracy: 79.65% (7965/10000), Test loss:0.6492
Epoch [5/50], Passed time:[92.225/461.126]
learning rate: 0.07500000000000001
Batch [0/352] training loss = 0.4181, training acc = 0.84
Batch [200/352] training loss = 0.4991, training acc = 0.82
Valid Test with nat
Test accuracy: 81.08% (4054/5000), Test loss:0.6032
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance50_m0.005_warmup0.1.pth
Test on test set:
Test accuracy: 79.59% (7959/10000), Test loss:0.6684
Epoch [6/50], Passed time:[91.230/547.378]
learning rate: 0.08000000000000002
Batch [0/352] training loss = 0.3165, training acc = 0.87
Batch [200/352] training loss = 0.4000, training acc = 0.83
Valid Test with nat
Test accuracy: 82.84% (4142/5000), Test loss:0.5455
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance50_m0.005_warmup0.1.pth
Test on test set:
Test accuracy: 81.51% (8151/10000), Test loss:0.5737
Epoch [7/50], Passed time:[91.122/637.855]
learning rate: 0.085
Batch [0/352] training loss = 0.3317, training acc = 0.86
Batch [200/352] training loss = 0.4115, training acc = 0.85
Valid Test with nat
Test accuracy: 82.74% (4137/5000), Test loss:0.5363
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance50_m0.005_warmup0.1.pth
Test on test set:
Test accuracy: 84.05% (8405/10000), Test loss:0.5050
Epoch [8/50], Passed time:[91.802/734.414]
learning rate: 0.09
Batch [0/352] training loss = 0.2985, training acc = 0.89
Batch [200/352] training loss = 0.4001, training acc = 0.85
Valid Test with nat
Test accuracy: 81.46% (4073/5000), Test loss:0.6169
Epoch [9/50], Passed time:[91.663/824.965]
learning rate: 0.095
Batch [0/352] training loss = 0.2492, training acc = 0.92
Batch [200/352] training loss = 0.2502, training acc = 0.91
Valid Test with nat
Test accuracy: 83.30% (4165/5000), Test loss:0.5334
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance50_m0.005_warmup0.1.pth
Test on test set:
Test accuracy: 83.46% (8346/10000), Test loss:0.5323
Epoch [10/50], Passed time:[92.242/922.416]
learning rate: 0.1
Batch [0/352] training loss = 0.3172, training acc = 0.87
Batch [200/352] training loss = 0.4798, training acc = 0.85
Valid Test with nat
Test accuracy: 83.26% (4163/5000), Test loss:0.5680
Epoch [11/50], Passed time:[92.129/1013.421]
learning rate: 0.1
Batch [0/352] training loss = 0.3708, training acc = 0.85
Batch [200/352] training loss = 0.3549, training acc = 0.89
Valid Test with nat
Test accuracy: 85.56% (4278/5000), Test loss:0.4430
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance50_m0.005_warmup0.1.pth
Test on test set:
Test accuracy: 83.99% (8399/10000), Test loss:0.5055
Epoch [12/50], Passed time:[91.220/1094.634]
learning rate: 0.1
Batch [0/352] training loss = 0.2554, training acc = 0.90
Batch [200/352] training loss = 0.2902, training acc = 0.89
Valid Test with nat
Test accuracy: 85.60% (4280/5000), Test loss:0.4883
Epoch [13/50], Passed time:[90.066/1170.861]
learning rate: 0.1
Batch [0/352] training loss = 0.3179, training acc = 0.89
Batch [200/352] training loss = 0.2639, training acc = 0.92
Valid Test with nat
Test accuracy: 86.28% (4314/5000), Test loss:0.4408
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance50_m0.005_warmup0.1.pth
Test on test set:
Test accuracy: 84.78% (8478/10000), Test loss:0.4772
Epoch [14/50], Passed time:[89.806/1257.281]
learning rate: 0.1
Batch [0/352] training loss = 0.2441, training acc = 0.93
Batch [200/352] training loss = 0.3504, training acc = 0.90
Valid Test with nat
Test accuracy: 85.96% (4298/5000), Test loss:0.4530
Epoch [15/50], Passed time:[89.957/1349.352]
learning rate: 0.1
Batch [0/352] training loss = 0.2113, training acc = 0.90
Batch [200/352] training loss = 0.3475, training acc = 0.85
Valid Test with nat
Test accuracy: 87.04% (4352/5000), Test loss:0.4330
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance50_m0.005_warmup0.1.pth
Test on test set:
Test accuracy: 86.55% (8655/10000), Test loss:0.4447
Epoch [16/50], Passed time:[90.181/1442.901]
learning rate: 0.1
Batch [0/352] training loss = 0.2512, training acc = 0.90
Batch [200/352] training loss = 0.1997, training acc = 0.91
Valid Test with nat
Test accuracy: 86.28% (4314/5000), Test loss:0.4505
Epoch [17/50], Passed time:[90.077/1531.301]
learning rate: 0.1
Batch [0/352] training loss = 0.3361, training acc = 0.89
Batch [200/352] training loss = 0.3874, training acc = 0.86
Valid Test with nat
Test accuracy: 85.88% (4294/5000), Test loss:0.4778
Epoch [18/50], Passed time:[89.896/1618.120]
learning rate: 0.1
Batch [0/352] training loss = 0.1578, training acc = 0.96
Batch [200/352] training loss = 0.2671, training acc = 0.90
Valid Test with nat
Test accuracy: 87.68% (4384/5000), Test loss:0.3829
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance50_m0.005_warmup0.1.pth
Test on test set:
Test accuracy: 87.84% (8784/10000), Test loss:0.3709
Epoch [19/50], Passed time:[89.806/1706.310]
learning rate: 0.1
Batch [0/352] training loss = 0.2149, training acc = 0.94
Batch [200/352] training loss = 0.2418, training acc = 0.91
Valid Test with nat
Test accuracy: 87.12% (4356/5000), Test loss:0.3915
Epoch [20/50], Passed time:[89.708/1794.162]
learning rate: 0.1
Batch [0/352] training loss = 0.2262, training acc = 0.91
Batch [200/352] training loss = 0.2767, training acc = 0.89
Valid Test with nat
Test accuracy: 85.76% (4288/5000), Test loss:0.4754
Epoch [21/50], Passed time:[89.547/1880.477]
learning rate: 0.1
Batch [0/352] training loss = 0.3521, training acc = 0.88
Batch [200/352] training loss = 0.3114, training acc = 0.88
Valid Test with nat
Test accuracy: 86.40% (4320/5000), Test loss:0.5062
Epoch [22/50], Passed time:[89.494/1968.872]
learning rate: 0.1
Batch [0/352] training loss = 0.3196, training acc = 0.91
Batch [200/352] training loss = 0.2000, training acc = 0.95
Valid Test with nat
Test accuracy: 85.44% (4272/5000), Test loss:0.4975
Epoch [23/50], Passed time:[89.490/2058.264]
learning rate: 0.1
Batch [0/352] training loss = 0.2667, training acc = 0.91
Batch [200/352] training loss = 0.3362, training acc = 0.87
Valid Test with nat
Test accuracy: 87.50% (4375/5000), Test loss:0.4074
Epoch [24/50], Passed time:[89.603/2150.469]
learning rate: 0.1
Batch [0/352] training loss = 0.2178, training acc = 0.91
Batch [200/352] training loss = 0.2136, training acc = 0.92
Valid Test with nat
Test accuracy: 85.82% (4291/5000), Test loss:0.4781
Epoch [25/50], Passed time:[89.535/2238.384]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.1764, training acc = 0.95
Batch [200/352] training loss = 0.1671, training acc = 0.94
Valid Test with nat
Test accuracy: 91.34% (4567/5000), Test loss:0.2833
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance50_m0.005_warmup0.1.pth
Test on test set:
Test accuracy: 91.41% (9141/10000), Test loss:0.2695
Epoch [26/50], Passed time:[89.434/2325.292]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.1313, training acc = 0.97
Batch [200/352] training loss = 0.1318, training acc = 0.95
Valid Test with nat
Test accuracy: 92.24% (4612/5000), Test loss:0.2502
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance50_m0.005_warmup0.1.pth
Test on test set:
Test accuracy: 91.67% (9167/10000), Test loss:0.2598
Epoch [27/50], Passed time:[89.592/2418.991]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0771, training acc = 0.97
Batch [200/352] training loss = 0.1265, training acc = 0.94
Valid Test with nat
Test accuracy: 92.16% (4608/5000), Test loss:0.2528
Epoch [28/50], Passed time:[89.727/2512.361]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0909, training acc = 0.97
Batch [200/352] training loss = 0.1213, training acc = 0.93
Valid Test with nat
Test accuracy: 91.88% (4594/5000), Test loss:0.2596
Epoch [29/50], Passed time:[89.622/2599.049]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0937, training acc = 0.96
Batch [200/352] training loss = 0.1282, training acc = 0.96
Valid Test with nat
Test accuracy: 92.12% (4606/5000), Test loss:0.2563
Epoch [30/50], Passed time:[89.613/2688.392]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.1034, training acc = 0.97
Batch [200/352] training loss = 0.0951, training acc = 0.97
Valid Test with nat
Test accuracy: 92.24% (4612/5000), Test loss:0.2576
Epoch [31/50], Passed time:[89.551/2776.085]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.1776, training acc = 0.91
Batch [200/352] training loss = 0.0875, training acc = 0.97
Valid Test with nat
Test accuracy: 92.14% (4607/5000), Test loss:0.2662
Epoch [32/50], Passed time:[89.662/2869.171]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0477, training acc = 0.99
Batch [200/352] training loss = 0.1214, training acc = 0.97
Valid Test with nat
Test accuracy: 92.18% (4609/5000), Test loss:0.2823
Epoch [33/50], Passed time:[89.590/2956.473]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.1400, training acc = 0.95
Batch [200/352] training loss = 0.0970, training acc = 0.97
Valid Test with nat
Test accuracy: 92.62% (4631/5000), Test loss:0.2644
Epoch [34/50], Passed time:[89.593/3046.160]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0596, training acc = 0.96
Batch [200/352] training loss = 0.1757, training acc = 0.92
Valid Test with nat
Test accuracy: 92.32% (4616/5000), Test loss:0.2872
Epoch [35/50], Passed time:[89.591/3135.685]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0314, training acc = 1.00
Batch [200/352] training loss = 0.0607, training acc = 0.98
Valid Test with nat
Test accuracy: 92.42% (4621/5000), Test loss:0.2672
Epoch [36/50], Passed time:[89.664/3227.895]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0612, training acc = 0.98
Batch [200/352] training loss = 0.0692, training acc = 0.98
Valid Test with nat
Test accuracy: 92.56% (4628/5000), Test loss:0.2686
Epoch [37/50], Passed time:[89.698/3318.813]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0344, training acc = 0.99
Batch [200/352] training loss = 0.0420, training acc = 0.98
Valid Test with nat
Test accuracy: 92.50% (4625/5000), Test loss:0.2787
Epoch [38/50], Passed time:[89.767/3411.149]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0319, training acc = 0.99
Batch [200/352] training loss = 0.0318, training acc = 0.99
Valid Test with nat
Test accuracy: 92.74% (4637/5000), Test loss:0.2694
Epoch [39/50], Passed time:[89.677/3497.416]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.1161, training acc = 0.95
Batch [200/352] training loss = 0.0256, training acc = 1.00
Valid Test with nat
Test accuracy: 92.70% (4635/5000), Test loss:0.2690
Epoch [40/50], Passed time:[89.765/3590.609]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0717, training acc = 0.97
Batch [200/352] training loss = 0.0331, training acc = 0.99
Valid Test with nat
Test accuracy: 92.66% (4633/5000), Test loss:0.2650
Epoch [41/50], Passed time:[89.753/3679.877]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0713, training acc = 0.98
Batch [200/352] training loss = 0.0303, training acc = 0.99
Valid Test with nat
Test accuracy: 92.64% (4632/5000), Test loss:0.2675
Epoch [42/50], Passed time:[89.810/3772.021]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0450, training acc = 0.98
Batch [200/352] training loss = 0.0531, training acc = 0.98
Valid Test with nat
Test accuracy: 92.74% (4637/5000), Test loss:0.2677
Epoch [43/50], Passed time:[89.841/3863.142]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0692, training acc = 0.98
Batch [200/352] training loss = 0.0552, training acc = 0.98
Valid Test with nat
Test accuracy: 92.66% (4633/5000), Test loss:0.2730
Epoch [44/50], Passed time:[89.909/3955.992]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0420, training acc = 0.98
Batch [200/352] training loss = 0.0382, training acc = 0.99
Valid Test with nat
Test accuracy: 92.76% (4638/5000), Test loss:0.2695
Epoch [45/50], Passed time:[89.894/4045.229]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0479, training acc = 0.98
Batch [200/352] training loss = 0.0554, training acc = 0.98
Valid Test with nat
Test accuracy: 92.72% (4636/5000), Test loss:0.2676
Epoch [46/50], Passed time:[89.903/4135.541]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0390, training acc = 0.98
Batch [200/352] training loss = 0.0451, training acc = 0.99
Valid Test with nat
Test accuracy: 92.66% (4633/5000), Test loss:0.2666
Epoch [47/50], Passed time:[89.990/4229.535]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0397, training acc = 0.99
Batch [200/352] training loss = 0.0798, training acc = 0.97
Valid Test with nat
Test accuracy: 92.66% (4633/5000), Test loss:0.2712
Epoch [48/50], Passed time:[90.022/4321.047]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0957, training acc = 0.97
Batch [200/352] training loss = 0.0701, training acc = 0.97
Valid Test with nat
Test accuracy: 92.66% (4633/5000), Test loss:0.2679
Epoch [49/50], Passed time:[90.079/4413.882]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0306, training acc = 0.99
Batch [200/352] training loss = 0.0319, training acc = 0.99
Valid Test with nat
Test accuracy: 92.56% (4628/5000), Test loss:0.2680
Training done, model saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance50_m0.005_warmup0.1.pth
Test on test set:
Test accuracy: 92.22% (9222/10000), Test loss:0.2794
