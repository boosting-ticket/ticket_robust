model_type : resnet18
init_type : pure
finetune_method : nat
enhance_method : nat
gpu : 9
model_name : init_enhance40_m0.01_warmup0.1
model_width : 8
n_pruning_steps : 1
max_pruning_ratio : 80
train_epochs : 40
enhance_epochs : 40
prune_method : unstructured
dataset : cifar
noise_sd : 1.0
trades_beta : 6.0
seed : 7
warmup : True
parallel : False
create_init : False
init_step : 1400
train_method : nat
early_stop : 1000
norm : True
optm : sgd
batch_size : 128
test_batch_size : 100
learning_rate : 0.1
enhance_learning_rate : 0.1
schedule_length : 10
weight_decay : 0.0001
epsilon : 0.03137254901960784
attack_iter : 10
eps_step : 0.00784313725490196
targeted : False
clip_min : 0
clip_max : 1.0
starting_epsilon : 1e-05
interval_weight : 0.1
ft_interval_weight : 50
verbose : 200
resume : 0
model_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance40_m0.01_warmup0.1.pth
last_model_path : ./trained_models_new/
mask_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/pruned_lr0.01_mask_r80.npy
mask_name : pruned_lr0.01_mask_r80
log_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance40_m0.01_warmup0.1.log
init_path : ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
results_path : None
n_classes : 10
eval : False
init : True
transfer : False
CUDA enabled.
Enhance training config:
Enhance training method: nat
model will be saved in: ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance40_m0.01_warmup0.1.pth
Init model is: ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
Init mask used from: ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/pruned_lr0.01_mask_r80.npy
Log will be saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance40_m0.01_warmup0.1.log
Random seed is: 7

model loading from ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
Epoch [0/40]
learning rate: 0.05
Batch [0/352] training loss = 2.1179, training acc = 0.23
Batch [200/352] training loss = 0.6676, training acc = 0.77
Valid Test with nat
Test accuracy: 72.68% (3634/5000), Test loss:0.9600
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance40_m0.01_warmup0.1.pth
Test on test set:
Test accuracy: 74.04% (7404/10000), Test loss:0.8575
Epoch [1/40], Passed time:[94.560/94.560]
learning rate: 0.055
Batch [0/352] training loss = 0.4729, training acc = 0.85
Batch [200/352] training loss = 0.6203, training acc = 0.78
Valid Test with nat
Test accuracy: 77.80% (3890/5000), Test loss:0.7583
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance40_m0.01_warmup0.1.pth
Test on test set:
Test accuracy: 77.70% (7770/10000), Test loss:0.7648
Epoch [2/40], Passed time:[94.031/188.061]
learning rate: 0.060000000000000005
Batch [0/352] training loss = 0.3539, training acc = 0.89
Batch [200/352] training loss = 0.4191, training acc = 0.84
Valid Test with nat
Test accuracy: 79.92% (3996/5000), Test loss:0.6425
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance40_m0.01_warmup0.1.pth
Test on test set:
Test accuracy: 78.10% (7810/10000), Test loss:0.7054
Epoch [3/40], Passed time:[91.918/275.754]
learning rate: 0.065
Batch [0/352] training loss = 0.2878, training acc = 0.90
Batch [200/352] training loss = 0.3844, training acc = 0.88
Valid Test with nat
Test accuracy: 80.22% (4011/5000), Test loss:0.6885
Epoch [4/40], Passed time:[89.928/359.710]
learning rate: 0.07
Batch [0/352] training loss = 0.3675, training acc = 0.87
Batch [200/352] training loss = 0.3744, training acc = 0.87
Valid Test with nat
Test accuracy: 83.86% (4193/5000), Test loss:0.5233
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance40_m0.01_warmup0.1.pth
Test on test set:
Test accuracy: 84.62% (8462/10000), Test loss:0.5041
Epoch [5/40], Passed time:[88.979/444.894]
learning rate: 0.07500000000000001
Batch [0/352] training loss = 0.4602, training acc = 0.87
Batch [200/352] training loss = 0.3780, training acc = 0.84
Valid Test with nat
Test accuracy: 86.10% (4305/5000), Test loss:0.4457
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance40_m0.01_warmup0.1.pth
Test on test set:
Test accuracy: 86.31% (8631/10000), Test loss:0.4301
Epoch [6/40], Passed time:[88.209/529.255]
learning rate: 0.08000000000000002
Batch [0/352] training loss = 0.3296, training acc = 0.85
Batch [200/352] training loss = 0.3134, training acc = 0.92
Valid Test with nat
Test accuracy: 85.82% (4291/5000), Test loss:0.4694
Epoch [7/40], Passed time:[88.044/616.307]
learning rate: 0.085
Batch [0/352] training loss = 0.2803, training acc = 0.91
Batch [200/352] training loss = 0.4740, training acc = 0.80
Valid Test with nat
Test accuracy: 84.26% (4213/5000), Test loss:0.5435
Epoch [8/40], Passed time:[87.766/702.126]
learning rate: 0.09
Batch [0/352] training loss = 0.2052, training acc = 0.94
Batch [200/352] training loss = 0.3141, training acc = 0.85
Valid Test with nat
Test accuracy: 83.90% (4195/5000), Test loss:0.5623
Epoch [9/40], Passed time:[86.919/782.271]
learning rate: 0.095
Batch [0/352] training loss = 0.3061, training acc = 0.91
Batch [200/352] training loss = 0.3716, training acc = 0.85
Valid Test with nat
Test accuracy: 86.34% (4317/5000), Test loss:0.4473
Epoch [10/40], Passed time:[86.159/861.588]
learning rate: 0.1
Batch [0/352] training loss = 0.2585, training acc = 0.91
Batch [200/352] training loss = 0.5216, training acc = 0.83
Valid Test with nat
Test accuracy: 86.62% (4331/5000), Test loss:0.4453
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance40_m0.01_warmup0.1.pth
Test on test set:
Test accuracy: 86.67% (8667/10000), Test loss:0.4368
Epoch [11/40], Passed time:[86.206/948.271]
learning rate: 0.1
Batch [0/352] training loss = 0.1871, training acc = 0.93
Batch [200/352] training loss = 0.2826, training acc = 0.90
Valid Test with nat
Test accuracy: 84.76% (4238/5000), Test loss:0.5063
Epoch [12/40], Passed time:[85.185/1022.219]
learning rate: 0.1
Batch [0/352] training loss = 0.2187, training acc = 0.91
Batch [200/352] training loss = 0.2955, training acc = 0.88
Valid Test with nat
Test accuracy: 80.94% (4047/5000), Test loss:0.6551
Epoch [13/40], Passed time:[84.447/1097.806]
learning rate: 0.1
Batch [0/352] training loss = 0.3229, training acc = 0.88
Batch [200/352] training loss = 0.2443, training acc = 0.91
Valid Test with nat
Test accuracy: 87.94% (4397/5000), Test loss:0.4048
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance40_m0.01_warmup0.1.pth
Test on test set:
Test accuracy: 87.41% (8741/10000), Test loss:0.4127
Epoch [14/40], Passed time:[84.276/1179.864]
learning rate: 0.1
Batch [0/352] training loss = 0.2536, training acc = 0.91
Batch [200/352] training loss = 0.3934, training acc = 0.87
Valid Test with nat
Test accuracy: 86.68% (4334/5000), Test loss:0.4341
Epoch [15/40], Passed time:[83.988/1259.815]
learning rate: 0.1
Batch [0/352] training loss = 0.1661, training acc = 0.97
Batch [200/352] training loss = 0.2839, training acc = 0.91
Valid Test with nat
Test accuracy: 84.66% (4233/5000), Test loss:0.5365
Epoch [16/40], Passed time:[83.655/1338.481]
learning rate: 0.1
Batch [0/352] training loss = 0.2231, training acc = 0.91
Batch [200/352] training loss = 0.2320, training acc = 0.90
Valid Test with nat
Test accuracy: 84.12% (4206/5000), Test loss:0.6023
Epoch [17/40], Passed time:[83.420/1418.146]
learning rate: 0.1
Batch [0/352] training loss = 0.3065, training acc = 0.89
Batch [200/352] training loss = 0.1742, training acc = 0.93
Valid Test with nat
Test accuracy: 88.02% (4401/5000), Test loss:0.3965
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance40_m0.01_warmup0.1.pth
Test on test set:
Test accuracy: 87.13% (8713/10000), Test loss:0.4073
Epoch [18/40], Passed time:[83.413/1501.429]
learning rate: 0.1
Batch [0/352] training loss = 0.1933, training acc = 0.93
Batch [200/352] training loss = 0.2274, training acc = 0.94
Valid Test with nat
Test accuracy: 87.28% (4364/5000), Test loss:0.4257
Epoch [19/40], Passed time:[83.302/1582.735]
learning rate: 0.1
Batch [0/352] training loss = 0.2466, training acc = 0.90
Batch [200/352] training loss = 0.1623, training acc = 0.95
Valid Test with nat
Test accuracy: 85.20% (4260/5000), Test loss:0.4975
Epoch [20/40], Passed time:[83.392/1667.836]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.2102, training acc = 0.94
Batch [200/352] training loss = 0.1719, training acc = 0.94
Valid Test with nat
Test accuracy: 91.98% (4599/5000), Test loss:0.2910
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance40_m0.01_warmup0.1.pth
Test on test set:
Test accuracy: 91.35% (9135/10000), Test loss:0.2820
Epoch [21/40], Passed time:[83.045/1743.955]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0797, training acc = 0.96
Batch [200/352] training loss = 0.0792, training acc = 0.98
Valid Test with nat
Test accuracy: 92.22% (4611/5000), Test loss:0.2636
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance40_m0.01_warmup0.1.pth
Test on test set:
Test accuracy: 91.58% (9158/10000), Test loss:0.2771
Epoch [22/40], Passed time:[83.171/1829.772]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0914, training acc = 0.97
Batch [200/352] training loss = 0.0598, training acc = 0.98
Valid Test with nat
Test accuracy: 92.34% (4617/5000), Test loss:0.2810
Epoch [23/40], Passed time:[83.089/1911.047]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0537, training acc = 0.98
Batch [200/352] training loss = 0.0766, training acc = 0.98
Valid Test with nat
Test accuracy: 92.40% (4620/5000), Test loss:0.2660
Epoch [24/40], Passed time:[82.969/1991.249]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0729, training acc = 0.98
Batch [200/352] training loss = 0.1158, training acc = 0.97
Valid Test with nat
Test accuracy: 92.34% (4617/5000), Test loss:0.2667
Epoch [25/40], Passed time:[82.767/2069.167]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0683, training acc = 0.97
Batch [200/352] training loss = 0.0593, training acc = 0.97
Valid Test with nat
Test accuracy: 92.40% (4620/5000), Test loss:0.2848
Epoch [26/40], Passed time:[82.321/2140.358]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0611, training acc = 0.98
Batch [200/352] training loss = 0.1199, training acc = 0.96
Valid Test with nat
Test accuracy: 92.86% (4643/5000), Test loss:0.2789
Epoch [27/40], Passed time:[82.301/2222.133]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0737, training acc = 0.98
Batch [200/352] training loss = 0.0379, training acc = 0.99
Valid Test with nat
Test accuracy: 92.42% (4621/5000), Test loss:0.3090
Epoch [28/40], Passed time:[82.091/2298.540]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0669, training acc = 0.98
Batch [200/352] training loss = 0.0556, training acc = 0.98
Valid Test with nat
Test accuracy: 92.58% (4629/5000), Test loss:0.2841
Epoch [29/40], Passed time:[81.868/2374.168]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0537, training acc = 0.99
Batch [200/352] training loss = 0.0662, training acc = 0.98
Valid Test with nat
Test accuracy: 92.46% (4623/5000), Test loss:0.2840
Epoch [30/40], Passed time:[81.807/2454.215]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0927, training acc = 0.98
Batch [200/352] training loss = 0.0687, training acc = 0.97
Valid Test with nat
Test accuracy: 92.66% (4633/5000), Test loss:0.2773
Epoch [31/40], Passed time:[81.619/2530.203]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0459, training acc = 0.99
Batch [200/352] training loss = 0.0450, training acc = 0.98
Valid Test with nat
Test accuracy: 92.70% (4635/5000), Test loss:0.2834
Epoch [32/40], Passed time:[81.327/2602.467]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0743, training acc = 0.97
Batch [200/352] training loss = 0.0485, training acc = 0.98
Valid Test with nat
Test accuracy: 92.88% (4644/5000), Test loss:0.3073
Epoch [33/40], Passed time:[81.382/2685.607]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0689, training acc = 0.97
Batch [200/352] training loss = 0.0847, training acc = 0.97
Valid Test with nat
Test accuracy: 92.74% (4637/5000), Test loss:0.2768
Epoch [34/40], Passed time:[81.278/2763.451]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0710, training acc = 0.98
Batch [200/352] training loss = 0.0272, training acc = 1.00
Valid Test with nat
Test accuracy: 92.98% (4649/5000), Test loss:0.2751
Epoch [35/40], Passed time:[81.127/2839.438]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0483, training acc = 0.98
Batch [200/352] training loss = 0.0628, training acc = 0.98
Valid Test with nat
Test accuracy: 92.98% (4649/5000), Test loss:0.2929
Epoch [36/40], Passed time:[80.939/2913.809]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0534, training acc = 0.98
Batch [200/352] training loss = 0.0814, training acc = 0.98
Valid Test with nat
Test accuracy: 92.68% (4634/5000), Test loss:0.2786
Epoch [37/40], Passed time:[80.884/2992.717]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0292, training acc = 0.99
Batch [200/352] training loss = 0.0259, training acc = 1.00
Valid Test with nat
Test accuracy: 92.88% (4644/5000), Test loss:0.2749
Epoch [38/40], Passed time:[80.753/3068.597]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0560, training acc = 0.98
Batch [200/352] training loss = 0.0561, training acc = 0.97
Valid Test with nat
Test accuracy: 93.00% (4650/5000), Test loss:0.2721
Epoch [39/40], Passed time:[80.753/3149.369]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0264, training acc = 1.00
Batch [200/352] training loss = 0.0772, training acc = 0.97
Valid Test with nat
Test accuracy: 92.82% (4641/5000), Test loss:0.2832
Training done, model saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance40_m0.01_warmup0.1.pth
Test on test set:
Test accuracy: 91.91% (9191/10000), Test loss:0.2958
