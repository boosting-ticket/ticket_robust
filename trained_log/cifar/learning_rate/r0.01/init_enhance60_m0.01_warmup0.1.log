model_type : resnet18
init_type : pure
finetune_method : nat
enhance_method : nat
gpu : 9
model_name : init_enhance60_m0.01_warmup0.1
model_width : 8
n_pruning_steps : 1
max_pruning_ratio : 80
train_epochs : 60
enhance_epochs : 60
prune_method : unstructured
dataset : cifar
noise_sd : 1.0
trades_beta : 6.0
seed : 7
warmup : True
parallel : False
create_init : False
init_step : 1400
train_method : nat
early_stop : 1000
norm : True
optm : sgd
batch_size : 128
test_batch_size : 100
learning_rate : 0.1
enhance_learning_rate : 0.1
schedule_length : 10
weight_decay : 0.0001
epsilon : 0.03137254901960784
attack_iter : 10
eps_step : 0.00784313725490196
targeted : False
clip_min : 0
clip_max : 1.0
starting_epsilon : 1e-05
interval_weight : 0.1
ft_interval_weight : 50
verbose : 200
resume : 0
model_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance60_m0.01_warmup0.1.pth
last_model_path : ./trained_models_new/
mask_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/pruned_lr0.01_mask_r80.npy
mask_name : pruned_lr0.01_mask_r80
log_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance60_m0.01_warmup0.1.log
init_path : ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
results_path : None
n_classes : 10
eval : False
init : True
transfer : False
CUDA enabled.
Enhance training config:
Enhance training method: nat
model will be saved in: ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance60_m0.01_warmup0.1.pth
Init model is: ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
Init mask used from: ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/pruned_lr0.01_mask_r80.npy
Log will be saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance60_m0.01_warmup0.1.log
Random seed is: 7

model loading from ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
Epoch [0/60]
learning rate: 0.05
Batch [0/352] training loss = 2.1179, training acc = 0.23
Batch [200/352] training loss = 0.6676, training acc = 0.77
Valid Test with nat
Test accuracy: 72.68% (3634/5000), Test loss:0.9600
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance60_m0.01_warmup0.1.pth
Test on test set:
Test accuracy: 74.04% (7404/10000), Test loss:0.8575
Epoch [1/60], Passed time:[82.986/82.986]
learning rate: 0.055
Batch [0/352] training loss = 0.4729, training acc = 0.85
Batch [200/352] training loss = 0.6203, training acc = 0.78
Valid Test with nat
Test accuracy: 77.80% (3890/5000), Test loss:0.7583
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance60_m0.01_warmup0.1.pth
Test on test set:
Test accuracy: 77.70% (7770/10000), Test loss:0.7648
Epoch [2/60], Passed time:[81.398/162.797]
learning rate: 0.060000000000000005
Batch [0/352] training loss = 0.3539, training acc = 0.89
Batch [200/352] training loss = 0.4191, training acc = 0.84
Valid Test with nat
Test accuracy: 79.92% (3996/5000), Test loss:0.6425
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance60_m0.01_warmup0.1.pth
Test on test set:
Test accuracy: 78.10% (7810/10000), Test loss:0.7054
Epoch [3/60], Passed time:[81.647/244.941]
learning rate: 0.065
Batch [0/352] training loss = 0.2878, training acc = 0.90
Batch [200/352] training loss = 0.3844, training acc = 0.88
Valid Test with nat
Test accuracy: 80.22% (4011/5000), Test loss:0.6885
Epoch [4/60], Passed time:[79.647/318.588]
learning rate: 0.07
Batch [0/352] training loss = 0.3675, training acc = 0.87
Batch [200/352] training loss = 0.3744, training acc = 0.87
Valid Test with nat
Test accuracy: 83.86% (4193/5000), Test loss:0.5233
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance60_m0.01_warmup0.1.pth
Test on test set:
Test accuracy: 84.62% (8462/10000), Test loss:0.5041
Epoch [5/60], Passed time:[80.996/404.980]
learning rate: 0.07500000000000001
Batch [0/352] training loss = 0.4602, training acc = 0.87
Batch [200/352] training loss = 0.3780, training acc = 0.84
Valid Test with nat
Test accuracy: 86.10% (4305/5000), Test loss:0.4457
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance60_m0.01_warmup0.1.pth
Test on test set:
Test accuracy: 86.31% (8631/10000), Test loss:0.4301
Epoch [6/60], Passed time:[82.128/492.770]
learning rate: 0.08000000000000002
Batch [0/352] training loss = 0.3296, training acc = 0.85
Batch [200/352] training loss = 0.3134, training acc = 0.92
Valid Test with nat
Test accuracy: 85.82% (4291/5000), Test loss:0.4694
Epoch [7/60], Passed time:[81.900/573.299]
learning rate: 0.085
Batch [0/352] training loss = 0.2803, training acc = 0.91
Batch [200/352] training loss = 0.4740, training acc = 0.80
Valid Test with nat
Test accuracy: 84.26% (4213/5000), Test loss:0.5435
Epoch [8/60], Passed time:[82.532/660.257]
learning rate: 0.09
Batch [0/352] training loss = 0.2052, training acc = 0.94
Batch [200/352] training loss = 0.3141, training acc = 0.85
Valid Test with nat
Test accuracy: 83.90% (4195/5000), Test loss:0.5623
Epoch [9/60], Passed time:[82.585/743.264]
learning rate: 0.095
Batch [0/352] training loss = 0.3061, training acc = 0.91
Batch [200/352] training loss = 0.3716, training acc = 0.85
Valid Test with nat
Test accuracy: 86.34% (4317/5000), Test loss:0.4473
Epoch [10/60], Passed time:[82.763/827.630]
learning rate: 0.1
Batch [0/352] training loss = 0.2585, training acc = 0.91
Batch [200/352] training loss = 0.5216, training acc = 0.83
Valid Test with nat
Test accuracy: 86.62% (4331/5000), Test loss:0.4453
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance60_m0.01_warmup0.1.pth
Test on test set:
Test accuracy: 86.67% (8667/10000), Test loss:0.4368
Epoch [11/60], Passed time:[82.795/910.743]
learning rate: 0.1
Batch [0/352] training loss = 0.1871, training acc = 0.93
Batch [200/352] training loss = 0.2826, training acc = 0.90
Valid Test with nat
Test accuracy: 84.76% (4238/5000), Test loss:0.5063
Epoch [12/60], Passed time:[82.591/991.091]
learning rate: 0.1
Batch [0/352] training loss = 0.2187, training acc = 0.91
Batch [200/352] training loss = 0.2955, training acc = 0.88
Valid Test with nat
Test accuracy: 80.94% (4047/5000), Test loss:0.6551
Epoch [13/60], Passed time:[82.460/1071.984]
learning rate: 0.1
Batch [0/352] training loss = 0.3229, training acc = 0.88
Batch [200/352] training loss = 0.2443, training acc = 0.91
Valid Test with nat
Test accuracy: 87.94% (4397/5000), Test loss:0.4048
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance60_m0.01_warmup0.1.pth
Test on test set:
Test accuracy: 87.41% (8741/10000), Test loss:0.4127
Epoch [14/60], Passed time:[82.647/1157.053]
learning rate: 0.1
Batch [0/352] training loss = 0.2536, training acc = 0.91
Batch [200/352] training loss = 0.3934, training acc = 0.87
Valid Test with nat
Test accuracy: 86.68% (4334/5000), Test loss:0.4341
Epoch [15/60], Passed time:[82.678/1240.169]
learning rate: 0.1
Batch [0/352] training loss = 0.1661, training acc = 0.97
Batch [200/352] training loss = 0.2839, training acc = 0.91
Valid Test with nat
Test accuracy: 84.66% (4233/5000), Test loss:0.5365
Epoch [16/60], Passed time:[82.607/1321.705]
learning rate: 0.1
Batch [0/352] training loss = 0.2231, training acc = 0.91
Batch [200/352] training loss = 0.2320, training acc = 0.90
Valid Test with nat
Test accuracy: 84.12% (4206/5000), Test loss:0.6023
Epoch [17/60], Passed time:[82.398/1400.758]
learning rate: 0.1
Batch [0/352] training loss = 0.3065, training acc = 0.89
Batch [200/352] training loss = 0.1742, training acc = 0.93
Valid Test with nat
Test accuracy: 88.02% (4401/5000), Test loss:0.3965
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance60_m0.01_warmup0.1.pth
Test on test set:
Test accuracy: 87.13% (8713/10000), Test loss:0.4073
Epoch [18/60], Passed time:[82.261/1480.697]
learning rate: 0.1
Batch [0/352] training loss = 0.1933, training acc = 0.93
Batch [200/352] training loss = 0.2274, training acc = 0.94
Valid Test with nat
Test accuracy: 87.28% (4364/5000), Test loss:0.4257
Epoch [19/60], Passed time:[82.267/1563.080]
learning rate: 0.1
Batch [0/352] training loss = 0.2466, training acc = 0.90
Batch [200/352] training loss = 0.1623, training acc = 0.95
Valid Test with nat
Test accuracy: 85.20% (4260/5000), Test loss:0.4975
Epoch [20/60], Passed time:[82.313/1646.269]
learning rate: 0.1
Batch [0/352] training loss = 0.2102, training acc = 0.94
Batch [200/352] training loss = 0.2508, training acc = 0.91
Valid Test with nat
Test accuracy: 87.32% (4366/5000), Test loss:0.3998
Epoch [21/60], Passed time:[82.240/1727.047]
learning rate: 0.1
Batch [0/352] training loss = 0.2434, training acc = 0.95
Batch [200/352] training loss = 0.2214, training acc = 0.92
Valid Test with nat
Test accuracy: 88.10% (4405/5000), Test loss:0.3789
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance60_m0.01_warmup0.1.pth
Test on test set:
Test accuracy: 87.09% (8709/10000), Test loss:0.4320
Epoch [22/60], Passed time:[82.226/1808.977]
learning rate: 0.1
Batch [0/352] training loss = 0.1384, training acc = 0.96
Batch [200/352] training loss = 0.1585, training acc = 0.95
Valid Test with nat
Test accuracy: 86.16% (4308/5000), Test loss:0.4794
Epoch [23/60], Passed time:[82.113/1888.610]
learning rate: 0.1
Batch [0/352] training loss = 0.1617, training acc = 0.94
Batch [200/352] training loss = 0.1118, training acc = 0.98
Valid Test with nat
Test accuracy: 86.78% (4339/5000), Test loss:0.4659
Epoch [24/60], Passed time:[82.187/1972.495]
learning rate: 0.1
Batch [0/352] training loss = 0.1071, training acc = 0.98
Batch [200/352] training loss = 0.1801, training acc = 0.94
Valid Test with nat
Test accuracy: 87.42% (4371/5000), Test loss:0.4568
Epoch [25/60], Passed time:[82.257/2056.427]
learning rate: 0.1
Batch [0/352] training loss = 0.1728, training acc = 0.94
Batch [200/352] training loss = 0.1565, training acc = 0.95
Valid Test with nat
Test accuracy: 87.28% (4364/5000), Test loss:0.4293
Epoch [26/60], Passed time:[82.167/2136.332]
learning rate: 0.1
Batch [0/352] training loss = 0.1948, training acc = 0.94
Batch [200/352] training loss = 0.1931, training acc = 0.95
Valid Test with nat
Test accuracy: 86.26% (4313/5000), Test loss:0.4686
Epoch [27/60], Passed time:[82.305/2222.236]
learning rate: 0.1
Batch [0/352] training loss = 0.2187, training acc = 0.95
Batch [200/352] training loss = 0.2284, training acc = 0.92
Valid Test with nat
Test accuracy: 87.92% (4396/5000), Test loss:0.4106
Epoch [28/60], Passed time:[82.518/2310.516]
learning rate: 0.1
Batch [0/352] training loss = 0.1673, training acc = 0.95
Batch [200/352] training loss = 0.1790, training acc = 0.91
Valid Test with nat
Test accuracy: 88.98% (4449/5000), Test loss:0.3848
Epoch [29/60], Passed time:[82.398/2389.531]
learning rate: 0.1
Batch [0/352] training loss = 0.2005, training acc = 0.94
Batch [200/352] training loss = 0.1458, training acc = 0.95
Valid Test with nat
Test accuracy: 89.90% (4495/5000), Test loss:0.3523
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance60_m0.01_warmup0.1.pth
Test on test set:
Test accuracy: 88.69% (8869/10000), Test loss:0.3692
Epoch [30/60], Passed time:[82.585/2477.549]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.1807, training acc = 0.95
Batch [200/352] training loss = 0.1327, training acc = 0.95
Valid Test with nat
Test accuracy: 92.40% (4620/5000), Test loss:0.2584
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance60_m0.01_warmup0.1.pth
Test on test set:
Test accuracy: 91.47% (9147/10000), Test loss:0.2736
Epoch [31/60], Passed time:[82.891/2569.620]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0855, training acc = 0.97
Batch [200/352] training loss = 0.1065, training acc = 0.96
Valid Test with nat
Test accuracy: 92.50% (4625/5000), Test loss:0.2565
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance60_m0.01_warmup0.1.pth
Test on test set:
Test accuracy: 91.88% (9188/10000), Test loss:0.2733
Epoch [32/60], Passed time:[83.153/2660.888]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0926, training acc = 0.97
Batch [200/352] training loss = 0.0422, training acc = 0.98
Valid Test with nat
Test accuracy: 92.62% (4631/5000), Test loss:0.2909
Epoch [33/60], Passed time:[83.227/2746.488]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0946, training acc = 0.96
Batch [200/352] training loss = 0.0454, training acc = 0.98
Valid Test with nat
Test accuracy: 92.50% (4625/5000), Test loss:0.2606
Epoch [34/60], Passed time:[83.251/2830.521]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0817, training acc = 0.96
Batch [200/352] training loss = 0.0561, training acc = 0.98
Valid Test with nat
Test accuracy: 92.74% (4637/5000), Test loss:0.2716
Epoch [35/60], Passed time:[83.312/2915.908]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0689, training acc = 0.98
Batch [200/352] training loss = 0.0487, training acc = 0.98
Valid Test with nat
Test accuracy: 92.76% (4638/5000), Test loss:0.2686
Epoch [36/60], Passed time:[83.556/3007.999]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0310, training acc = 1.00
Batch [200/352] training loss = 0.0566, training acc = 0.98
Valid Test with nat
Test accuracy: 92.44% (4622/5000), Test loss:0.2694
Epoch [37/60], Passed time:[83.746/3098.616]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0766, training acc = 0.98
Batch [200/352] training loss = 0.0645, training acc = 0.97
Valid Test with nat
Test accuracy: 92.50% (4625/5000), Test loss:0.2709
Epoch [38/60], Passed time:[83.860/3186.690]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0697, training acc = 0.98
Batch [200/352] training loss = 0.1113, training acc = 0.98
Valid Test with nat
Test accuracy: 92.56% (4628/5000), Test loss:0.2779
Epoch [39/60], Passed time:[83.888/3271.630]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.1038, training acc = 0.96
Batch [200/352] training loss = 0.0559, training acc = 0.98
Valid Test with nat
Test accuracy: 92.80% (4640/5000), Test loss:0.2777
Epoch [40/60], Passed time:[83.980/3359.208]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0193, training acc = 0.99
Batch [200/352] training loss = 0.0294, training acc = 0.99
Valid Test with nat
Test accuracy: 92.60% (4630/5000), Test loss:0.2904
Epoch [41/60], Passed time:[84.025/3445.015]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0269, training acc = 0.99
Batch [200/352] training loss = 0.0563, training acc = 0.98
Valid Test with nat
Test accuracy: 92.76% (4638/5000), Test loss:0.2791
Epoch [42/60], Passed time:[84.119/3533.012]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0328, training acc = 0.99
Batch [200/352] training loss = 0.0556, training acc = 0.98
Valid Test with nat
Test accuracy: 92.58% (4629/5000), Test loss:0.2811
Epoch [43/60], Passed time:[84.188/3620.084]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0454, training acc = 0.98
Batch [200/352] training loss = 0.0226, training acc = 0.99
Valid Test with nat
Test accuracy: 92.84% (4642/5000), Test loss:0.2892
Epoch [44/60], Passed time:[84.307/3709.488]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.1249, training acc = 0.97
Batch [200/352] training loss = 0.0515, training acc = 0.98
Valid Test with nat
Test accuracy: 92.70% (4635/5000), Test loss:0.2951
Epoch [45/60], Passed time:[84.439/3799.734]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0362, training acc = 0.99
Batch [200/352] training loss = 0.0222, training acc = 0.99
Valid Test with nat
Test accuracy: 92.88% (4644/5000), Test loss:0.2989
Epoch [46/60], Passed time:[84.492/3886.625]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0110, training acc = 1.00
Batch [200/352] training loss = 0.0271, training acc = 0.99
Valid Test with nat
Test accuracy: 92.76% (4638/5000), Test loss:0.2925
Epoch [47/60], Passed time:[84.426/3968.000]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0378, training acc = 0.98
Batch [200/352] training loss = 0.0059, training acc = 1.00
Valid Test with nat
Test accuracy: 92.82% (4641/5000), Test loss:0.2828
Epoch [48/60], Passed time:[84.294/4046.115]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0218, training acc = 0.99
Batch [200/352] training loss = 0.0386, training acc = 0.98
Valid Test with nat
Test accuracy: 92.72% (4636/5000), Test loss:0.2834
Epoch [49/60], Passed time:[84.040/4117.968]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0195, training acc = 1.00
Batch [200/352] training loss = 0.0154, training acc = 0.99
Valid Test with nat
Test accuracy: 92.80% (4640/5000), Test loss:0.2800
Epoch [50/60], Passed time:[84.001/4200.032]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0267, training acc = 0.99
Batch [200/352] training loss = 0.0255, training acc = 0.99
Valid Test with nat
Test accuracy: 92.84% (4642/5000), Test loss:0.2917
Epoch [51/60], Passed time:[83.944/4281.155]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0215, training acc = 0.99
Batch [200/352] training loss = 0.0333, training acc = 0.99
Valid Test with nat
Test accuracy: 93.04% (4652/5000), Test loss:0.2867
Epoch [52/60], Passed time:[83.944/4365.074]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0403, training acc = 0.98
Batch [200/352] training loss = 0.0302, training acc = 0.98
Valid Test with nat
Test accuracy: 92.78% (4639/5000), Test loss:0.2901
Epoch [53/60], Passed time:[83.910/4447.210]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0292, training acc = 0.99
Batch [200/352] training loss = 0.0769, training acc = 0.99
Valid Test with nat
Test accuracy: 92.84% (4642/5000), Test loss:0.3337
Epoch [54/60], Passed time:[83.860/4528.419]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0297, training acc = 0.99
Batch [200/352] training loss = 0.0124, training acc = 1.00
Valid Test with nat
Test accuracy: 92.84% (4642/5000), Test loss:0.2870
Epoch [55/60], Passed time:[83.879/4613.339]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0246, training acc = 0.99
Batch [200/352] training loss = 0.0486, training acc = 0.98
Valid Test with nat
Test accuracy: 92.78% (4639/5000), Test loss:0.2923
Epoch [56/60], Passed time:[83.923/4699.705]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0295, training acc = 0.99
Batch [200/352] training loss = 0.0171, training acc = 1.00
Valid Test with nat
Test accuracy: 92.82% (4641/5000), Test loss:0.2965
Epoch [57/60], Passed time:[83.961/4785.762]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0536, training acc = 0.97
Batch [200/352] training loss = 0.0409, training acc = 0.98
Valid Test with nat
Test accuracy: 92.80% (4640/5000), Test loss:0.2868
Epoch [58/60], Passed time:[83.980/4870.813]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0385, training acc = 1.00
Batch [200/352] training loss = 0.0207, training acc = 0.99
Valid Test with nat
Test accuracy: 92.94% (4647/5000), Test loss:0.2892
Epoch [59/60], Passed time:[83.955/4953.365]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0351, training acc = 0.99
Batch [200/352] training loss = 0.0209, training acc = 0.99
Valid Test with nat
Test accuracy: 92.78% (4639/5000), Test loss:0.2887
Training done, model saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance60_m0.01_warmup0.1.pth
Test on test set:
Test accuracy: 92.34% (9234/10000), Test loss:0.2974
