model_type : resnet18
init_type : pure
finetune_method : nat
enhance_method : nat
gpu : 9
model_name : init_enhance100_m0.01_warmup0.1
model_width : 8
n_pruning_steps : 1
max_pruning_ratio : 80
train_epochs : 100
enhance_epochs : 100
prune_method : unstructured
dataset : cifar
noise_sd : 1.0
trades_beta : 6.0
seed : 7
warmup : True
parallel : False
create_init : False
init_step : 1400
train_method : nat
early_stop : 1000
norm : True
optm : sgd
batch_size : 128
test_batch_size : 100
learning_rate : 0.1
enhance_learning_rate : 0.1
schedule_length : 10
weight_decay : 0.0001
epsilon : 0.03137254901960784
attack_iter : 10
eps_step : 0.00784313725490196
targeted : False
clip_min : 0
clip_max : 1.0
starting_epsilon : 1e-05
interval_weight : 0.1
ft_interval_weight : 50
verbose : 200
resume : 0
model_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance100_m0.01_warmup0.1.pth
last_model_path : ./trained_models_new/
mask_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/pruned_lr0.01_mask_r80.npy
mask_name : pruned_lr0.01_mask_r80
log_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance100_m0.01_warmup0.1.log
init_path : ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
results_path : None
n_classes : 10
eval : False
init : True
transfer : False
CUDA enabled.
Enhance training config:
Enhance training method: nat
model will be saved in: ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance100_m0.01_warmup0.1.pth
Init model is: ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
Init mask used from: ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/pruned_lr0.01_mask_r80.npy
Log will be saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance100_m0.01_warmup0.1.log
Random seed is: 7

model loading from ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
Epoch [0/100]
learning rate: 0.05
Batch [0/352] training loss = 2.1179, training acc = 0.23
Batch [200/352] training loss = 0.6676, training acc = 0.77
Valid Test with nat
Test accuracy: 72.68% (3634/5000), Test loss:0.9600
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance100_m0.01_warmup0.1.pth
Test on test set:
Test accuracy: 74.04% (7404/10000), Test loss:0.8575
Epoch [1/100], Passed time:[97.344/97.344]
learning rate: 0.055
Batch [0/352] training loss = 0.4729, training acc = 0.85
Batch [200/352] training loss = 0.6203, training acc = 0.78
Valid Test with nat
Test accuracy: 77.80% (3890/5000), Test loss:0.7583
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance100_m0.01_warmup0.1.pth
Test on test set:
Test accuracy: 77.70% (7770/10000), Test loss:0.7648
Epoch [2/100], Passed time:[95.943/191.886]
learning rate: 0.060000000000000005
Batch [0/352] training loss = 0.3539, training acc = 0.89
Batch [200/352] training loss = 0.4191, training acc = 0.84
Valid Test with nat
Test accuracy: 79.92% (3996/5000), Test loss:0.6425
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance100_m0.01_warmup0.1.pth
Test on test set:
Test accuracy: 78.10% (7810/10000), Test loss:0.7054
Epoch [3/100], Passed time:[95.801/287.404]
learning rate: 0.065
Batch [0/352] training loss = 0.2878, training acc = 0.90
Batch [200/352] training loss = 0.3844, training acc = 0.88
Valid Test with nat
Test accuracy: 80.22% (4011/5000), Test loss:0.6885
Epoch [4/100], Passed time:[94.640/378.559]
learning rate: 0.07
Batch [0/352] training loss = 0.3675, training acc = 0.87
Batch [200/352] training loss = 0.3744, training acc = 0.87
Valid Test with nat
Test accuracy: 83.86% (4193/5000), Test loss:0.5233
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance100_m0.01_warmup0.1.pth
Test on test set:
Test accuracy: 84.62% (8462/10000), Test loss:0.5041
Epoch [5/100], Passed time:[95.398/476.991]
learning rate: 0.07500000000000001
Batch [0/352] training loss = 0.4602, training acc = 0.87
Batch [200/352] training loss = 0.3780, training acc = 0.84
Valid Test with nat
Test accuracy: 86.10% (4305/5000), Test loss:0.4457
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance100_m0.01_warmup0.1.pth
Test on test set:
Test accuracy: 86.31% (8631/10000), Test loss:0.4301
Epoch [6/100], Passed time:[95.458/572.749]
learning rate: 0.08000000000000002
Batch [0/352] training loss = 0.3296, training acc = 0.85
Batch [200/352] training loss = 0.3134, training acc = 0.92
Valid Test with nat
Test accuracy: 85.82% (4291/5000), Test loss:0.4694
Epoch [7/100], Passed time:[94.558/661.908]
learning rate: 0.085
Batch [0/352] training loss = 0.2803, training acc = 0.91
Batch [200/352] training loss = 0.4740, training acc = 0.80
Valid Test with nat
Test accuracy: 84.26% (4213/5000), Test loss:0.5435
Epoch [8/100], Passed time:[94.125/752.996]
learning rate: 0.09
Batch [0/352] training loss = 0.2052, training acc = 0.94
Batch [200/352] training loss = 0.3141, training acc = 0.85
Valid Test with nat
Test accuracy: 83.90% (4195/5000), Test loss:0.5623
Epoch [9/100], Passed time:[93.682/843.138]
learning rate: 0.095
Batch [0/352] training loss = 0.3061, training acc = 0.91
Batch [200/352] training loss = 0.3716, training acc = 0.85
Valid Test with nat
Test accuracy: 86.34% (4317/5000), Test loss:0.4473
Epoch [10/100], Passed time:[93.699/936.994]
learning rate: 0.1
Batch [0/352] training loss = 0.2585, training acc = 0.91
Batch [200/352] training loss = 0.5216, training acc = 0.83
Valid Test with nat
Test accuracy: 86.62% (4331/5000), Test loss:0.4453
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance100_m0.01_warmup0.1.pth
Test on test set:
Test accuracy: 86.67% (8667/10000), Test loss:0.4368
Epoch [11/100], Passed time:[93.701/1030.715]
learning rate: 0.1
Batch [0/352] training loss = 0.1871, training acc = 0.93
Batch [200/352] training loss = 0.2826, training acc = 0.90
Valid Test with nat
Test accuracy: 84.76% (4238/5000), Test loss:0.5063
Epoch [12/100], Passed time:[93.490/1121.877]
learning rate: 0.1
Batch [0/352] training loss = 0.2187, training acc = 0.91
Batch [200/352] training loss = 0.2955, training acc = 0.88
Valid Test with nat
Test accuracy: 80.94% (4047/5000), Test loss:0.6551
Epoch [13/100], Passed time:[93.052/1209.677]
learning rate: 0.1
Batch [0/352] training loss = 0.3229, training acc = 0.88
Batch [200/352] training loss = 0.2443, training acc = 0.91
Valid Test with nat
Test accuracy: 87.94% (4397/5000), Test loss:0.4048
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance100_m0.01_warmup0.1.pth
Test on test set:
Test accuracy: 87.41% (8741/10000), Test loss:0.4127
Epoch [14/100], Passed time:[92.960/1301.442]
learning rate: 0.1
Batch [0/352] training loss = 0.2536, training acc = 0.91
Batch [200/352] training loss = 0.3934, training acc = 0.87
Valid Test with nat
Test accuracy: 86.68% (4334/5000), Test loss:0.4341
Epoch [15/100], Passed time:[92.955/1394.318]
learning rate: 0.1
Batch [0/352] training loss = 0.1661, training acc = 0.97
Batch [200/352] training loss = 0.2839, training acc = 0.91
Valid Test with nat
Test accuracy: 84.66% (4233/5000), Test loss:0.5365
Epoch [16/100], Passed time:[92.872/1485.952]
learning rate: 0.1
Batch [0/352] training loss = 0.2231, training acc = 0.91
Batch [200/352] training loss = 0.2320, training acc = 0.90
Valid Test with nat
Test accuracy: 84.12% (4206/5000), Test loss:0.6023
Epoch [17/100], Passed time:[92.744/1576.650]
learning rate: 0.1
Batch [0/352] training loss = 0.3065, training acc = 0.89
Batch [200/352] training loss = 0.1742, training acc = 0.93
Valid Test with nat
Test accuracy: 88.02% (4401/5000), Test loss:0.3965
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance100_m0.01_warmup0.1.pth
Test on test set:
Test accuracy: 87.13% (8713/10000), Test loss:0.4073
Epoch [18/100], Passed time:[92.913/1672.425]
learning rate: 0.1
Batch [0/352] training loss = 0.1933, training acc = 0.93
Batch [200/352] training loss = 0.2274, training acc = 0.94
Valid Test with nat
Test accuracy: 87.28% (4364/5000), Test loss:0.4257
Epoch [19/100], Passed time:[92.688/1761.075]
learning rate: 0.1
Batch [0/352] training loss = 0.2466, training acc = 0.90
Batch [200/352] training loss = 0.1623, training acc = 0.95
Valid Test with nat
Test accuracy: 85.20% (4260/5000), Test loss:0.4975
Epoch [20/100], Passed time:[92.599/1851.981]
learning rate: 0.1
Batch [0/352] training loss = 0.2102, training acc = 0.94
Batch [200/352] training loss = 0.2508, training acc = 0.91
Valid Test with nat
Test accuracy: 87.32% (4366/5000), Test loss:0.3998
Epoch [21/100], Passed time:[92.339/1939.116]
learning rate: 0.1
Batch [0/352] training loss = 0.2434, training acc = 0.95
Batch [200/352] training loss = 0.2214, training acc = 0.92
Valid Test with nat
Test accuracy: 88.10% (4405/5000), Test loss:0.3789
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance100_m0.01_warmup0.1.pth
Test on test set:
Test accuracy: 87.09% (8709/10000), Test loss:0.4320
Epoch [22/100], Passed time:[92.449/2033.882]
learning rate: 0.1
Batch [0/352] training loss = 0.1384, training acc = 0.96
Batch [200/352] training loss = 0.1585, training acc = 0.95
Valid Test with nat
Test accuracy: 86.16% (4308/5000), Test loss:0.4794
Epoch [23/100], Passed time:[92.359/2124.246]
learning rate: 0.1
Batch [0/352] training loss = 0.1617, training acc = 0.94
Batch [200/352] training loss = 0.1118, training acc = 0.98
Valid Test with nat
Test accuracy: 86.78% (4339/5000), Test loss:0.4659
Epoch [24/100], Passed time:[92.336/2216.071]
learning rate: 0.1
Batch [0/352] training loss = 0.1071, training acc = 0.98
Batch [200/352] training loss = 0.1801, training acc = 0.94
Valid Test with nat
Test accuracy: 87.42% (4371/5000), Test loss:0.4568
Epoch [25/100], Passed time:[92.364/2309.107]
learning rate: 0.1
Batch [0/352] training loss = 0.1728, training acc = 0.94
Batch [200/352] training loss = 0.1565, training acc = 0.95
Valid Test with nat
Test accuracy: 87.28% (4364/5000), Test loss:0.4293
Epoch [26/100], Passed time:[92.353/2401.174]
learning rate: 0.1
Batch [0/352] training loss = 0.1948, training acc = 0.94
Batch [200/352] training loss = 0.1931, training acc = 0.95
Valid Test with nat
Test accuracy: 86.26% (4313/5000), Test loss:0.4686
Epoch [27/100], Passed time:[92.273/2491.370]
learning rate: 0.1
Batch [0/352] training loss = 0.2187, training acc = 0.95
Batch [200/352] training loss = 0.2284, training acc = 0.92
Valid Test with nat
Test accuracy: 87.92% (4396/5000), Test loss:0.4106
Epoch [28/100], Passed time:[92.262/2583.343]
learning rate: 0.1
Batch [0/352] training loss = 0.1673, training acc = 0.95
Batch [200/352] training loss = 0.1790, training acc = 0.91
Valid Test with nat
Test accuracy: 88.98% (4449/5000), Test loss:0.3848
Epoch [29/100], Passed time:[92.268/2675.770]
learning rate: 0.1
Batch [0/352] training loss = 0.2005, training acc = 0.94
Batch [200/352] training loss = 0.1458, training acc = 0.95
Valid Test with nat
Test accuracy: 89.90% (4495/5000), Test loss:0.3523
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance100_m0.01_warmup0.1.pth
Test on test set:
Test accuracy: 88.69% (8869/10000), Test loss:0.3692
Epoch [30/100], Passed time:[92.464/2773.908]
learning rate: 0.1
Batch [0/352] training loss = 0.1807, training acc = 0.95
Batch [200/352] training loss = 0.2270, training acc = 0.93
Valid Test with nat
Test accuracy: 85.06% (4253/5000), Test loss:0.5405
Epoch [31/100], Passed time:[92.448/2865.900]
learning rate: 0.1
Batch [0/352] training loss = 0.2268, training acc = 0.92
Batch [200/352] training loss = 0.2339, training acc = 0.91
Valid Test with nat
Test accuracy: 87.02% (4351/5000), Test loss:0.5016
Epoch [32/100], Passed time:[92.484/2959.501]
learning rate: 0.1
Batch [0/352] training loss = 0.1692, training acc = 0.95
Batch [200/352] training loss = 0.1025, training acc = 0.98
Valid Test with nat
Test accuracy: 86.26% (4313/5000), Test loss:0.5228
Epoch [33/100], Passed time:[92.505/3052.660]
learning rate: 0.1
Batch [0/352] training loss = 0.2137, training acc = 0.91
Batch [200/352] training loss = 0.2734, training acc = 0.89
Valid Test with nat
Test accuracy: 86.56% (4328/5000), Test loss:0.4649
Epoch [34/100], Passed time:[92.498/3144.943]
learning rate: 0.1
Batch [0/352] training loss = 0.1130, training acc = 0.98
Batch [200/352] training loss = 0.1031, training acc = 0.97
Valid Test with nat
Test accuracy: 88.28% (4414/5000), Test loss:0.4283
Epoch [35/100], Passed time:[92.509/3237.813]
learning rate: 0.1
Batch [0/352] training loss = 0.1186, training acc = 0.95
Batch [200/352] training loss = 0.1319, training acc = 0.95
Valid Test with nat
Test accuracy: 84.40% (4220/5000), Test loss:0.6011
Epoch [36/100], Passed time:[92.382/3325.759]
learning rate: 0.1
Batch [0/352] training loss = 0.1773, training acc = 0.95
Batch [200/352] training loss = 0.2135, training acc = 0.94
Valid Test with nat
Test accuracy: 88.94% (4447/5000), Test loss:0.3699
Epoch [37/100], Passed time:[92.126/3408.656]
learning rate: 0.1
Batch [0/352] training loss = 0.1345, training acc = 0.95
Batch [200/352] training loss = 0.1020, training acc = 0.95
Valid Test with nat
Test accuracy: 87.26% (4363/5000), Test loss:0.4503
Epoch [38/100], Passed time:[91.863/3490.799]
learning rate: 0.1
Batch [0/352] training loss = 0.2023, training acc = 0.95
Batch [200/352] training loss = 0.1864, training acc = 0.94
Valid Test with nat
Test accuracy: 89.86% (4493/5000), Test loss:0.3482
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance100_m0.01_warmup0.1.pth
Test on test set:
Test accuracy: 89.31% (8931/10000), Test loss:0.3561
Epoch [39/100], Passed time:[91.827/3581.272]
learning rate: 0.1
Batch [0/352] training loss = 0.0787, training acc = 0.97
Batch [200/352] training loss = 0.2711, training acc = 0.90
Valid Test with nat
Test accuracy: 88.20% (4410/5000), Test loss:0.4012
Epoch [40/100], Passed time:[91.663/3666.520]
learning rate: 0.1
Batch [0/352] training loss = 0.1418, training acc = 0.95
Batch [200/352] training loss = 0.1532, training acc = 0.95
Valid Test with nat
Test accuracy: 87.00% (4350/5000), Test loss:0.4842
Epoch [41/100], Passed time:[91.485/3750.902]
learning rate: 0.1
Batch [0/352] training loss = 0.1523, training acc = 0.94
Batch [200/352] training loss = 0.1936, training acc = 0.93
Valid Test with nat
Test accuracy: 88.12% (4406/5000), Test loss:0.4272
Epoch [42/100], Passed time:[91.315/3835.250]
learning rate: 0.1
Batch [0/352] training loss = 0.1468, training acc = 0.96
Batch [200/352] training loss = 0.1787, training acc = 0.92
Valid Test with nat
Test accuracy: 87.78% (4389/5000), Test loss:0.4830
Epoch [43/100], Passed time:[91.005/3913.221]
learning rate: 0.1
Batch [0/352] training loss = 0.1043, training acc = 0.97
Batch [200/352] training loss = 0.2887, training acc = 0.93
Valid Test with nat
Test accuracy: 86.82% (4341/5000), Test loss:0.4972
Epoch [44/100], Passed time:[90.763/3993.550]
learning rate: 0.1
Batch [0/352] training loss = 0.1382, training acc = 0.96
Batch [200/352] training loss = 0.2341, training acc = 0.92
Valid Test with nat
Test accuracy: 87.66% (4383/5000), Test loss:0.4687
Epoch [45/100], Passed time:[90.594/4076.715]
learning rate: 0.1
Batch [0/352] training loss = 0.2135, training acc = 0.94
Batch [200/352] training loss = 0.2397, training acc = 0.89
Valid Test with nat
Test accuracy: 87.28% (4364/5000), Test loss:0.4589
Epoch [46/100], Passed time:[90.585/4166.913]
learning rate: 0.1
Batch [0/352] training loss = 0.2086, training acc = 0.92
Batch [200/352] training loss = 0.1980, training acc = 0.95
Valid Test with nat
Test accuracy: 88.54% (4427/5000), Test loss:0.4338
Epoch [47/100], Passed time:[90.666/4261.288]
learning rate: 0.1
Batch [0/352] training loss = 0.1039, training acc = 0.98
Batch [200/352] training loss = 0.2212, training acc = 0.95
Valid Test with nat
Test accuracy: 88.48% (4424/5000), Test loss:0.4325
Epoch [48/100], Passed time:[90.708/4354.001]
learning rate: 0.1
Batch [0/352] training loss = 0.1491, training acc = 0.95
Batch [200/352] training loss = 0.1348, training acc = 0.95
Valid Test with nat
Test accuracy: 88.82% (4441/5000), Test loss:0.3836
Epoch [49/100], Passed time:[90.785/4448.464]
learning rate: 0.1
Batch [0/352] training loss = 0.1749, training acc = 0.95
Batch [200/352] training loss = 0.2857, training acc = 0.89
Valid Test with nat
Test accuracy: 87.60% (4380/5000), Test loss:0.5222
Epoch [50/100], Passed time:[90.817/4540.875]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.2386, training acc = 0.95
Batch [200/352] training loss = 0.1213, training acc = 0.95
Valid Test with nat
Test accuracy: 92.36% (4618/5000), Test loss:0.2577
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance100_m0.01_warmup0.1.pth
Test on test set:
Test accuracy: 92.03% (9203/10000), Test loss:0.2662
Epoch [51/100], Passed time:[90.925/4637.187]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0794, training acc = 0.97
Batch [200/352] training loss = 0.0865, training acc = 0.95
Valid Test with nat
Test accuracy: 92.70% (4635/5000), Test loss:0.2608
Epoch [52/100], Passed time:[90.960/4729.922]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0776, training acc = 0.98
Batch [200/352] training loss = 0.1048, training acc = 0.97
Valid Test with nat
Test accuracy: 92.94% (4647/5000), Test loss:0.2627
Epoch [53/100], Passed time:[91.027/4824.455]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0551, training acc = 0.99
Batch [200/352] training loss = 0.1613, training acc = 0.95
Valid Test with nat
Test accuracy: 92.66% (4633/5000), Test loss:0.3017
Epoch [54/100], Passed time:[91.038/4916.073]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0512, training acc = 0.99
Batch [200/352] training loss = 0.0274, training acc = 1.00
Valid Test with nat
Test accuracy: 92.64% (4632/5000), Test loss:0.2693
Epoch [55/100], Passed time:[90.976/5003.681]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0273, training acc = 0.99
Batch [200/352] training loss = 0.0633, training acc = 0.98
Valid Test with nat
Test accuracy: 92.58% (4629/5000), Test loss:0.2754
Epoch [56/100], Passed time:[90.903/5090.569]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0306, training acc = 0.98
Batch [200/352] training loss = 0.0272, training acc = 1.00
Valid Test with nat
Test accuracy: 92.84% (4642/5000), Test loss:0.2831
Epoch [57/100], Passed time:[90.841/5177.959]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0293, training acc = 0.99
Batch [200/352] training loss = 0.0298, training acc = 0.99
Valid Test with nat
Test accuracy: 92.94% (4647/5000), Test loss:0.2686
Epoch [58/100], Passed time:[90.758/5263.973]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0808, training acc = 0.97
Batch [200/352] training loss = 0.0267, training acc = 0.99
Valid Test with nat
Test accuracy: 92.84% (4642/5000), Test loss:0.2776
Epoch [59/100], Passed time:[90.669/5349.453]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0395, training acc = 0.98
Batch [200/352] training loss = 0.0292, training acc = 0.99
Valid Test with nat
Test accuracy: 92.82% (4641/5000), Test loss:0.2831
Epoch [60/100], Passed time:[90.602/5436.121]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0118, training acc = 1.00
Batch [200/352] training loss = 0.0543, training acc = 0.98
Valid Test with nat
Test accuracy: 92.78% (4639/5000), Test loss:0.2819
Epoch [61/100], Passed time:[90.532/5522.471]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0308, training acc = 0.98
Batch [200/352] training loss = 0.0435, training acc = 0.98
Valid Test with nat
Test accuracy: 93.24% (4662/5000), Test loss:0.2765
Epoch [62/100], Passed time:[90.429/5606.594]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0612, training acc = 0.97
Batch [200/352] training loss = 0.0469, training acc = 0.98
Valid Test with nat
Test accuracy: 92.94% (4647/5000), Test loss:0.2899
Epoch [63/100], Passed time:[90.342/5691.568]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0209, training acc = 0.99
Batch [200/352] training loss = 0.0132, training acc = 1.00
Valid Test with nat
Test accuracy: 92.68% (4634/5000), Test loss:0.2775
Epoch [64/100], Passed time:[90.327/5780.944]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0496, training acc = 0.98
Batch [200/352] training loss = 0.0118, training acc = 1.00
Valid Test with nat
Test accuracy: 92.74% (4637/5000), Test loss:0.2925
Epoch [65/100], Passed time:[90.382/5874.845]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0110, training acc = 1.00
Batch [200/352] training loss = 0.0487, training acc = 0.98
Valid Test with nat
Test accuracy: 92.94% (4647/5000), Test loss:0.2859
Epoch [66/100], Passed time:[90.427/5968.166]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0158, training acc = 1.00
Batch [200/352] training loss = 0.0083, training acc = 1.00
Valid Test with nat
Test accuracy: 92.96% (4648/5000), Test loss:0.2861
Epoch [67/100], Passed time:[90.350/6053.420]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0163, training acc = 0.99
Batch [200/352] training loss = 0.0460, training acc = 0.98
Valid Test with nat
Test accuracy: 93.18% (4659/5000), Test loss:0.2877
Epoch [68/100], Passed time:[90.273/6138.537]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0201, training acc = 0.99
Batch [200/352] training loss = 0.0165, training acc = 1.00
Valid Test with nat
Test accuracy: 92.90% (4645/5000), Test loss:0.2954
Epoch [69/100], Passed time:[90.195/6223.457]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0157, training acc = 1.00
Batch [200/352] training loss = 0.0182, training acc = 1.00
Valid Test with nat
Test accuracy: 92.84% (4642/5000), Test loss:0.2965
Epoch [70/100], Passed time:[90.169/6311.804]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0916, training acc = 0.98
Batch [200/352] training loss = 0.0348, training acc = 0.98
Valid Test with nat
Test accuracy: 92.98% (4649/5000), Test loss:0.2948
Epoch [71/100], Passed time:[90.077/6395.453]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0171, training acc = 1.00
Batch [200/352] training loss = 0.0272, training acc = 0.98
Valid Test with nat
Test accuracy: 92.98% (4649/5000), Test loss:0.2935
Epoch [72/100], Passed time:[90.004/6480.281]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0115, training acc = 0.99
Batch [200/352] training loss = 0.0131, training acc = 1.00
Valid Test with nat
Test accuracy: 93.04% (4652/5000), Test loss:0.3219
Epoch [73/100], Passed time:[89.927/6564.648]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0070, training acc = 1.00
Batch [200/352] training loss = 0.0379, training acc = 0.99
Valid Test with nat
Test accuracy: 92.98% (4649/5000), Test loss:0.2920
Epoch [74/100], Passed time:[89.846/6648.616]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0148, training acc = 1.00
Batch [200/352] training loss = 0.0048, training acc = 1.00
Valid Test with nat
Test accuracy: 93.08% (4654/5000), Test loss:0.3030
Epoch [75/100], Passed time:[89.747/6731.036]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0083, training acc = 1.00
Batch [200/352] training loss = 0.0192, training acc = 1.00
Valid Test with nat
Test accuracy: 93.12% (4656/5000), Test loss:0.2982
Epoch [76/100], Passed time:[89.679/6815.622]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0527, training acc = 0.98
Batch [200/352] training loss = 0.0128, training acc = 0.99
Valid Test with nat
Test accuracy: 93.28% (4664/5000), Test loss:0.3244
Epoch [77/100], Passed time:[89.585/6898.063]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0332, training acc = 0.98
Batch [200/352] training loss = 0.0227, training acc = 0.99
Valid Test with nat
Test accuracy: 93.36% (4668/5000), Test loss:0.2912
Epoch [78/100], Passed time:[89.535/6983.722]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0328, training acc = 0.98
Batch [200/352] training loss = 0.0134, training acc = 0.99
Valid Test with nat
Test accuracy: 93.38% (4669/5000), Test loss:0.2935
Epoch [79/100], Passed time:[89.461/7067.449]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0064, training acc = 1.00
Batch [200/352] training loss = 0.0039, training acc = 1.00
Valid Test with nat
Test accuracy: 93.32% (4666/5000), Test loss:0.3176
Epoch [80/100], Passed time:[89.421/7153.661]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0111, training acc = 0.99
Batch [200/352] training loss = 0.0089, training acc = 1.00
Valid Test with nat
Test accuracy: 93.28% (4664/5000), Test loss:0.3035
Epoch [81/100], Passed time:[89.370/7238.933]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0345, training acc = 0.98
Batch [200/352] training loss = 0.0059, training acc = 1.00
Valid Test with nat
Test accuracy: 93.26% (4663/5000), Test loss:0.2932
Epoch [82/100], Passed time:[89.323/7324.515]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0077, training acc = 1.00
Batch [200/352] training loss = 0.0287, training acc = 0.99
Valid Test with nat
Test accuracy: 93.18% (4659/5000), Test loss:0.2995
Epoch [83/100], Passed time:[89.273/7409.662]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0060, training acc = 1.00
Batch [200/352] training loss = 0.0038, training acc = 1.00
Valid Test with nat
Test accuracy: 93.22% (4661/5000), Test loss:0.2984
Epoch [84/100], Passed time:[89.229/7495.242]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0511, training acc = 0.97
Batch [200/352] training loss = 0.0191, training acc = 1.00
Valid Test with nat
Test accuracy: 93.32% (4666/5000), Test loss:0.3107
Epoch [85/100], Passed time:[89.184/7580.681]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0151, training acc = 1.00
Batch [200/352] training loss = 0.0069, training acc = 1.00
Valid Test with nat
Test accuracy: 93.24% (4662/5000), Test loss:0.3115
Epoch [86/100], Passed time:[89.132/7665.376]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0244, training acc = 0.99
Batch [200/352] training loss = 0.0110, training acc = 0.99
Valid Test with nat
Test accuracy: 93.24% (4662/5000), Test loss:0.2925
Epoch [87/100], Passed time:[89.173/7758.051]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0144, training acc = 0.99
Batch [200/352] training loss = 0.0038, training acc = 1.00
Valid Test with nat
Test accuracy: 93.30% (4665/5000), Test loss:0.3030
Epoch [88/100], Passed time:[89.212/7850.661]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0128, training acc = 1.00
Batch [200/352] training loss = 0.0438, training acc = 0.99
Valid Test with nat
Test accuracy: 93.40% (4670/5000), Test loss:0.2913
Epoch [89/100], Passed time:[89.263/7944.436]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0248, training acc = 0.99
Batch [200/352] training loss = 0.0295, training acc = 0.99
Valid Test with nat
Test accuracy: 93.26% (4663/5000), Test loss:0.2916
Epoch [90/100], Passed time:[89.271/8034.345]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0066, training acc = 1.00
Batch [200/352] training loss = 0.0523, training acc = 0.98
Valid Test with nat
Test accuracy: 93.34% (4667/5000), Test loss:0.2989
Epoch [91/100], Passed time:[89.290/8125.381]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0230, training acc = 0.99
Batch [200/352] training loss = 0.0190, training acc = 0.99
Valid Test with nat
Test accuracy: 93.24% (4662/5000), Test loss:0.2915
Epoch [92/100], Passed time:[89.343/8219.532]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0066, training acc = 1.00
Batch [200/352] training loss = 0.0040, training acc = 1.00
Valid Test with nat
Test accuracy: 93.30% (4665/5000), Test loss:0.2907
Epoch [93/100], Passed time:[89.382/8312.560]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0091, training acc = 1.00
Batch [200/352] training loss = 0.0140, training acc = 0.99
Valid Test with nat
Test accuracy: 93.30% (4665/5000), Test loss:0.2934
Epoch [94/100], Passed time:[89.425/8405.992]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0077, training acc = 1.00
Batch [200/352] training loss = 0.0306, training acc = 0.98
Valid Test with nat
Test accuracy: 93.20% (4660/5000), Test loss:0.2910
Epoch [95/100], Passed time:[89.465/8499.217]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0057, training acc = 1.00
Batch [200/352] training loss = 0.0441, training acc = 0.98
Valid Test with nat
Test accuracy: 93.34% (4667/5000), Test loss:0.2926
Epoch [96/100], Passed time:[89.484/8590.493]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0283, training acc = 0.98
Batch [200/352] training loss = 0.0201, training acc = 0.99
Valid Test with nat
Test accuracy: 93.18% (4659/5000), Test loss:0.2903
Epoch [97/100], Passed time:[89.497/8681.203]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0342, training acc = 0.98
Batch [200/352] training loss = 0.0143, training acc = 1.00
Valid Test with nat
Test accuracy: 93.40% (4670/5000), Test loss:0.3058
Epoch [98/100], Passed time:[89.532/8774.182]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0091, training acc = 1.00
Batch [200/352] training loss = 0.0410, training acc = 0.98
Valid Test with nat
Test accuracy: 93.32% (4666/5000), Test loss:0.3095
Epoch [99/100], Passed time:[89.542/8864.694]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0220, training acc = 0.99
Batch [200/352] training loss = 0.0199, training acc = 0.99
Valid Test with nat
Test accuracy: 93.22% (4661/5000), Test loss:0.2969
Training done, model saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance100_m0.01_warmup0.1.pth
Test on test set:
Test accuracy: 92.98% (9298/10000), Test loss:0.2991
