model_type : resnet18
init_type : pure
finetune_method : nat
enhance_method : nat
gpu : 5
model_name : init_enhance30_m0.01_warmup0.1
model_width : 8
n_pruning_steps : 1
max_pruning_ratio : 80
train_epochs : 30
enhance_epochs : 30
prune_method : unstructured
dataset : cifar
noise_sd : 1.0
trades_beta : 6.0
seed : 7
warmup : True
parallel : False
create_init : False
init_step : 1400
train_method : nat
early_stop : 1000
norm : True
optm : sgd
batch_size : 128
test_batch_size : 100
learning_rate : 0.1
enhance_learning_rate : 0.1
schedule_length : 10
weight_decay : 0.0001
epsilon : 0.03137254901960784
attack_iter : 10
eps_step : 0.00784313725490196
targeted : False
clip_min : 0
clip_max : 1.0
starting_epsilon : 1e-05
interval_weight : 0.1
ft_interval_weight : 50
verbose : 200
resume : 0
model_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.01_warmup0.1.pth
last_model_path : ./trained_models_new/
mask_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/pruned_lr0.01_mask_r80.npy
mask_name : pruned_lr0.01_mask_r80
log_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.01_warmup0.1.log
init_path : ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
results_path : None
n_classes : 10
eval : False
init : True
transfer : False
CUDA enabled.
Enhance training config:
Enhance training method: nat
model will be saved in: ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.01_warmup0.1.pth
Init model is: ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
Init mask used from: ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/pruned_lr0.01_mask_r80.npy
Log will be saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.01_warmup0.1.log
Random seed is: 7

model loading from ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
Epoch [0/30]
learning rate: 0.05
Batch [0/352] training loss = 2.1179, training acc = 0.23
Batch [200/352] training loss = 0.6676, training acc = 0.77
Valid Test with nat
Test accuracy: 72.68% (3634/5000), Test loss:0.9600
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.01_warmup0.1.pth
Test on test set:
Test accuracy: 74.04% (7404/10000), Test loss:0.8575
Epoch [1/30], Passed time:[93.280/93.280]
learning rate: 0.055
Batch [0/352] training loss = 0.4729, training acc = 0.85
Batch [200/352] training loss = 0.6203, training acc = 0.78
Valid Test with nat
Test accuracy: 77.80% (3890/5000), Test loss:0.7583
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.01_warmup0.1.pth
Test on test set:
Test accuracy: 77.70% (7770/10000), Test loss:0.7648
Epoch [2/30], Passed time:[92.937/185.874]
learning rate: 0.060000000000000005
Batch [0/352] training loss = 0.3539, training acc = 0.89
Batch [200/352] training loss = 0.4191, training acc = 0.84
Valid Test with nat
Test accuracy: 79.92% (3996/5000), Test loss:0.6425
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.01_warmup0.1.pth
Test on test set:
Test accuracy: 78.10% (7810/10000), Test loss:0.7054
Epoch [3/30], Passed time:[92.947/278.840]
learning rate: 0.065
Batch [0/352] training loss = 0.2878, training acc = 0.90
Batch [200/352] training loss = 0.3844, training acc = 0.88
Valid Test with nat
Test accuracy: 80.22% (4011/5000), Test loss:0.6885
Epoch [4/30], Passed time:[91.405/365.619]
learning rate: 0.07
Batch [0/352] training loss = 0.3675, training acc = 0.87
Batch [200/352] training loss = 0.3744, training acc = 0.87
Valid Test with nat
Test accuracy: 83.86% (4193/5000), Test loss:0.5233
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.01_warmup0.1.pth
Test on test set:
Test accuracy: 84.62% (8462/10000), Test loss:0.5041
Epoch [5/30], Passed time:[91.538/457.689]
learning rate: 0.07500000000000001
Batch [0/352] training loss = 0.4602, training acc = 0.87
Batch [200/352] training loss = 0.3780, training acc = 0.84
Valid Test with nat
Test accuracy: 86.10% (4305/5000), Test loss:0.4457
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.01_warmup0.1.pth
Test on test set:
Test accuracy: 86.31% (8631/10000), Test loss:0.4301
Epoch [6/30], Passed time:[91.415/548.489]
learning rate: 0.08000000000000002
Batch [0/352] training loss = 0.3296, training acc = 0.85
Batch [200/352] training loss = 0.3134, training acc = 0.92
Valid Test with nat
Test accuracy: 85.82% (4291/5000), Test loss:0.4694
Epoch [7/30], Passed time:[91.012/637.081]
learning rate: 0.085
Batch [0/352] training loss = 0.2803, training acc = 0.91
Batch [200/352] training loss = 0.4740, training acc = 0.80
Valid Test with nat
Test accuracy: 84.26% (4213/5000), Test loss:0.5435
Epoch [8/30], Passed time:[90.595/724.758]
learning rate: 0.09
Batch [0/352] training loss = 0.2052, training acc = 0.94
Batch [200/352] training loss = 0.3141, training acc = 0.85
Valid Test with nat
Test accuracy: 83.90% (4195/5000), Test loss:0.5623
Epoch [9/30], Passed time:[90.491/814.421]
learning rate: 0.095
Batch [0/352] training loss = 0.3061, training acc = 0.91
Batch [200/352] training loss = 0.3716, training acc = 0.85
Valid Test with nat
Test accuracy: 86.34% (4317/5000), Test loss:0.4473
Epoch [10/30], Passed time:[90.465/904.650]
learning rate: 0.1
Batch [0/352] training loss = 0.2585, training acc = 0.91
Batch [200/352] training loss = 0.5216, training acc = 0.83
Valid Test with nat
Test accuracy: 86.62% (4331/5000), Test loss:0.4453
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.01_warmup0.1.pth
Test on test set:
Test accuracy: 86.67% (8667/10000), Test loss:0.4368
Epoch [11/30], Passed time:[90.442/994.866]
learning rate: 0.1
Batch [0/352] training loss = 0.1871, training acc = 0.93
Batch [200/352] training loss = 0.2826, training acc = 0.90
Valid Test with nat
Test accuracy: 84.76% (4238/5000), Test loss:0.5063
Epoch [12/30], Passed time:[90.136/1081.627]
learning rate: 0.1
Batch [0/352] training loss = 0.2187, training acc = 0.91
Batch [200/352] training loss = 0.2955, training acc = 0.88
Valid Test with nat
Test accuracy: 80.94% (4047/5000), Test loss:0.6551
Epoch [13/30], Passed time:[89.840/1167.915]
learning rate: 0.1
Batch [0/352] training loss = 0.3229, training acc = 0.88
Batch [200/352] training loss = 0.2443, training acc = 0.91
Valid Test with nat
Test accuracy: 87.94% (4397/5000), Test loss:0.4048
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.01_warmup0.1.pth
Test on test set:
Test accuracy: 87.41% (8741/10000), Test loss:0.4127
Epoch [14/30], Passed time:[89.812/1257.373]
learning rate: 0.1
Batch [0/352] training loss = 0.2536, training acc = 0.91
Batch [200/352] training loss = 0.3934, training acc = 0.87
Valid Test with nat
Test accuracy: 86.68% (4334/5000), Test loss:0.4341
Epoch [15/30], Passed time:[89.613/1344.190]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.1661, training acc = 0.97
Batch [200/352] training loss = 0.1793, training acc = 0.95
Valid Test with nat
Test accuracy: 91.56% (4578/5000), Test loss:0.2893
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.01_warmup0.1.pth
Test on test set:
Test accuracy: 91.26% (9126/10000), Test loss:0.2695
Epoch [16/30], Passed time:[89.662/1434.587]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.1000, training acc = 0.98
Batch [200/352] training loss = 0.1386, training acc = 0.95
Valid Test with nat
Test accuracy: 92.02% (4601/5000), Test loss:0.2753
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.01_warmup0.1.pth
Test on test set:
Test accuracy: 91.45% (9145/10000), Test loss:0.2684
Epoch [17/30], Passed time:[89.653/1524.101]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.1180, training acc = 0.95
Batch [200/352] training loss = 0.0707, training acc = 0.98
Valid Test with nat
Test accuracy: 92.18% (4609/5000), Test loss:0.2735
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.01_warmup0.1.pth
Test on test set:
Test accuracy: 91.54% (9154/10000), Test loss:0.2765
Epoch [18/30], Passed time:[89.712/1614.821]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0437, training acc = 0.99
Batch [200/352] training loss = 0.1047, training acc = 0.97
Valid Test with nat
Test accuracy: 92.30% (4615/5000), Test loss:0.2770
Epoch [19/30], Passed time:[89.407/1698.724]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.1013, training acc = 0.96
Batch [200/352] training loss = 0.1164, training acc = 0.95
Valid Test with nat
Test accuracy: 92.12% (4606/5000), Test loss:0.2788
Epoch [20/30], Passed time:[89.303/1786.067]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0581, training acc = 0.98
Batch [200/352] training loss = 0.1238, training acc = 0.97
Valid Test with nat
Test accuracy: 91.74% (4587/5000), Test loss:0.2847
Epoch [21/30], Passed time:[89.237/1873.981]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.1313, training acc = 0.94
Batch [200/352] training loss = 0.0462, training acc = 0.98
Valid Test with nat
Test accuracy: 92.04% (4602/5000), Test loss:0.2832
Epoch [22/30], Passed time:[89.227/1962.999]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0454, training acc = 0.98
Batch [200/352] training loss = 0.0407, training acc = 0.99
Valid Test with nat
Test accuracy: 92.42% (4621/5000), Test loss:0.2920
Epoch [23/30], Passed time:[88.947/2045.780]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0484, training acc = 0.98
Batch [200/352] training loss = 0.0334, training acc = 0.99
Valid Test with nat
Test accuracy: 92.44% (4622/5000), Test loss:0.2708
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.01_warmup0.1.pth
Test on test set:
Test accuracy: 91.92% (9192/10000), Test loss:0.2804
Epoch [24/30], Passed time:[88.938/2134.523]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.1041, training acc = 0.97
Batch [200/352] training loss = 0.0159, training acc = 1.00
Valid Test with nat
Test accuracy: 92.30% (4615/5000), Test loss:0.2732
Epoch [25/30], Passed time:[88.816/2220.396]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0357, training acc = 0.98
Batch [200/352] training loss = 0.0654, training acc = 0.97
Valid Test with nat
Test accuracy: 92.40% (4620/5000), Test loss:0.2897
Epoch [26/30], Passed time:[88.671/2305.456]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0380, training acc = 0.98
Batch [200/352] training loss = 0.0840, training acc = 0.97
Valid Test with nat
Test accuracy: 92.36% (4618/5000), Test loss:0.2723
Epoch [27/30], Passed time:[88.563/2391.188]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0171, training acc = 1.00
Batch [200/352] training loss = 0.0698, training acc = 0.98
Valid Test with nat
Test accuracy: 92.28% (4614/5000), Test loss:0.2722
Epoch [28/30], Passed time:[88.523/2478.647]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0959, training acc = 0.96
Batch [200/352] training loss = 0.0299, training acc = 1.00
Valid Test with nat
Test accuracy: 92.36% (4618/5000), Test loss:0.2774
Epoch [29/30], Passed time:[88.434/2564.574]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0383, training acc = 0.99
Batch [200/352] training loss = 0.0977, training acc = 0.96
Valid Test with nat
Test accuracy: 92.48% (4624/5000), Test loss:0.2791
Training done, model saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.01_warmup0.1.pth
Test on test set:
Test accuracy: 91.87% (9187/10000), Test loss:0.2843
