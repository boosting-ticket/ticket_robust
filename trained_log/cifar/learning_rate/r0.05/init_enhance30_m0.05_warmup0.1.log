model_type : resnet18
init_type : pure
finetune_method : nat
enhance_method : nat
gpu : 6
model_name : init_enhance30_m0.05_warmup0.1
model_width : 8
n_pruning_steps : 1
max_pruning_ratio : 80
train_epochs : 30
enhance_epochs : 30
prune_method : unstructured
dataset : cifar
noise_sd : 1.0
trades_beta : 6.0
seed : 7
warmup : True
parallel : False
create_init : False
init_step : 1400
train_method : nat
early_stop : 1000
norm : True
optm : sgd
batch_size : 128
test_batch_size : 100
learning_rate : 0.1
enhance_learning_rate : 0.1
schedule_length : 10
weight_decay : 0.0001
epsilon : 0.03137254901960784
attack_iter : 10
eps_step : 0.00784313725490196
targeted : False
clip_min : 0
clip_max : 1.0
starting_epsilon : 1e-05
interval_weight : 0.1
ft_interval_weight : 50
verbose : 200
resume : 0
model_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.05_warmup0.1.pth
last_model_path : ./trained_models_new/
mask_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/pruned_lr0.05_mask_r80.npy
mask_name : pruned_lr0.05_mask_r80
log_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.05_warmup0.1.log
init_path : ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
results_path : None
n_classes : 10
eval : False
init : True
transfer : False
CUDA enabled.
Enhance training config:
Enhance training method: nat
model will be saved in: ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.05_warmup0.1.pth
Init model is: ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
Init mask used from: ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/pruned_lr0.05_mask_r80.npy
Log will be saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.05_warmup0.1.log
Random seed is: 7

model loading from ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
Epoch [0/30]
learning rate: 0.05
Batch [0/352] training loss = 2.3039, training acc = 0.14
Batch [200/352] training loss = 0.6670, training acc = 0.78
Valid Test with nat
Test accuracy: 76.92% (3846/5000), Test loss:0.7423
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 76.81% (7681/10000), Test loss:0.7011
Epoch [1/30], Passed time:[56.437/56.437]
learning rate: 0.055
Batch [0/352] training loss = 0.5464, training acc = 0.81
Batch [200/352] training loss = 0.5864, training acc = 0.83
Valid Test with nat
Test accuracy: 80.96% (4048/5000), Test loss:0.6446
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 81.45% (8145/10000), Test loss:0.6038
Epoch [2/30], Passed time:[56.354/112.707]
learning rate: 0.060000000000000005
Batch [0/352] training loss = 0.3670, training acc = 0.87
Batch [200/352] training loss = 0.2755, training acc = 0.90
Valid Test with nat
Test accuracy: 81.70% (4085/5000), Test loss:0.5896
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 81.26% (8126/10000), Test loss:0.5823
Epoch [3/30], Passed time:[56.756/170.268]
learning rate: 0.065
Batch [0/352] training loss = 0.2827, training acc = 0.92
Batch [200/352] training loss = 0.2837, training acc = 0.89
Valid Test with nat
Test accuracy: 85.06% (4253/5000), Test loss:0.4936
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 84.95% (8495/10000), Test loss:0.5123
Epoch [4/30], Passed time:[57.511/230.045]
learning rate: 0.07
Batch [0/352] training loss = 0.1817, training acc = 0.92
Batch [200/352] training loss = 0.2757, training acc = 0.90
Valid Test with nat
Test accuracy: 88.28% (4414/5000), Test loss:0.3974
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 87.69% (8769/10000), Test loss:0.4045
Epoch [5/30], Passed time:[57.198/285.991]
learning rate: 0.07500000000000001
Batch [0/352] training loss = 0.2978, training acc = 0.86
Batch [200/352] training loss = 0.2000, training acc = 0.91
Valid Test with nat
Test accuracy: 87.32% (4366/5000), Test loss:0.4423
Epoch [6/30], Passed time:[56.336/338.014]
learning rate: 0.08000000000000002
Batch [0/352] training loss = 0.2056, training acc = 0.93
Batch [200/352] training loss = 0.2354, training acc = 0.93
Valid Test with nat
Test accuracy: 87.62% (4381/5000), Test loss:0.3952
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 87.81% (8781/10000), Test loss:0.3998
Epoch [7/30], Passed time:[56.694/396.855]
learning rate: 0.085
Batch [0/352] training loss = 0.1521, training acc = 0.95
Batch [200/352] training loss = 0.2471, training acc = 0.89
Valid Test with nat
Test accuracy: 86.36% (4318/5000), Test loss:0.4873
Epoch [8/30], Passed time:[56.450/451.600]
learning rate: 0.09
Batch [0/352] training loss = 0.2056, training acc = 0.91
Batch [200/352] training loss = 0.2967, training acc = 0.92
Valid Test with nat
Test accuracy: 89.02% (4451/5000), Test loss:0.3574
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 88.83% (8883/10000), Test loss:0.3621
Epoch [9/30], Passed time:[55.920/503.284]
learning rate: 0.095
Batch [0/352] training loss = 0.3399, training acc = 0.89
Batch [200/352] training loss = 0.2458, training acc = 0.91
Valid Test with nat
Test accuracy: 86.46% (4323/5000), Test loss:0.4747
Epoch [10/30], Passed time:[55.833/558.331]
learning rate: 0.1
Batch [0/352] training loss = 0.1716, training acc = 0.93
Batch [200/352] training loss = 0.2425, training acc = 0.91
Valid Test with nat
Test accuracy: 85.00% (4250/5000), Test loss:0.5024
Epoch [11/30], Passed time:[55.744/613.180]
learning rate: 0.1
Batch [0/352] training loss = 0.2555, training acc = 0.91
Batch [200/352] training loss = 0.2470, training acc = 0.88
Valid Test with nat
Test accuracy: 87.26% (4363/5000), Test loss:0.4748
Epoch [12/30], Passed time:[55.569/666.823]
learning rate: 0.1
Batch [0/352] training loss = 0.2124, training acc = 0.91
Batch [200/352] training loss = 0.1997, training acc = 0.94
Valid Test with nat
Test accuracy: 88.08% (4404/5000), Test loss:0.4191
Epoch [13/30], Passed time:[55.412/720.358]
learning rate: 0.1
Batch [0/352] training loss = 0.1273, training acc = 0.97
Batch [200/352] training loss = 0.1540, training acc = 0.94
Valid Test with nat
Test accuracy: 88.84% (4442/5000), Test loss:0.3927
Epoch [14/30], Passed time:[55.394/775.521]
learning rate: 0.1
Batch [0/352] training loss = 0.1632, training acc = 0.92
Batch [200/352] training loss = 0.2411, training acc = 0.89
Valid Test with nat
Test accuracy: 88.46% (4423/5000), Test loss:0.4363
Epoch [15/30], Passed time:[55.411/831.159]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0765, training acc = 0.98
Batch [200/352] training loss = 0.0845, training acc = 0.98
Valid Test with nat
Test accuracy: 92.92% (4646/5000), Test loss:0.2633
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 92.56% (9256/10000), Test loss:0.2492
Epoch [16/30], Passed time:[55.815/893.036]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0484, training acc = 0.99
Batch [200/352] training loss = 0.1218, training acc = 0.97
Valid Test with nat
Test accuracy: 92.94% (4647/5000), Test loss:0.2482
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 92.23% (9223/10000), Test loss:0.2583
Epoch [17/30], Passed time:[55.885/950.048]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0460, training acc = 0.98
Batch [200/352] training loss = 0.0505, training acc = 0.97
Valid Test with nat
Test accuracy: 93.08% (4654/5000), Test loss:0.2409
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 92.38% (9238/10000), Test loss:0.2652
Epoch [18/30], Passed time:[56.012/1008.221]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0319, training acc = 0.99
Batch [200/352] training loss = 0.0695, training acc = 0.98
Valid Test with nat
Test accuracy: 93.20% (4660/5000), Test loss:0.2527
Epoch [19/30], Passed time:[56.055/1065.046]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0622, training acc = 0.98
Batch [200/352] training loss = 0.0468, training acc = 0.98
Valid Test with nat
Test accuracy: 93.20% (4660/5000), Test loss:0.2472
Epoch [20/30], Passed time:[55.755/1115.094]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0176, training acc = 1.00
Batch [200/352] training loss = 0.0643, training acc = 0.97
Valid Test with nat
Test accuracy: 93.34% (4667/5000), Test loss:0.2493
Epoch [21/30], Passed time:[55.739/1170.526]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0583, training acc = 0.98
Batch [200/352] training loss = 0.0285, training acc = 0.98
Valid Test with nat
Test accuracy: 93.32% (4666/5000), Test loss:0.2484
Epoch [22/30], Passed time:[55.624/1223.739]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0112, training acc = 1.00
Batch [200/352] training loss = 0.0305, training acc = 0.99
Valid Test with nat
Test accuracy: 93.16% (4658/5000), Test loss:0.2639
Epoch [23/30], Passed time:[55.372/1273.564]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0216, training acc = 0.99
Batch [200/352] training loss = 0.0335, training acc = 0.98
Valid Test with nat
Test accuracy: 93.58% (4679/5000), Test loss:0.2467
Epoch [24/30], Passed time:[55.254/1326.085]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0191, training acc = 0.99
Batch [200/352] training loss = 0.0500, training acc = 0.98
Valid Test with nat
Test accuracy: 93.56% (4678/5000), Test loss:0.2472
Epoch [25/30], Passed time:[55.231/1380.781]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0351, training acc = 0.99
Batch [200/352] training loss = 0.0240, training acc = 0.99
Valid Test with nat
Test accuracy: 93.68% (4684/5000), Test loss:0.2478
Epoch [26/30], Passed time:[55.063/1431.628]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0472, training acc = 0.98
Batch [200/352] training loss = 0.0707, training acc = 0.98
Valid Test with nat
Test accuracy: 93.54% (4677/5000), Test loss:0.2504
Epoch [27/30], Passed time:[54.969/1484.168]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0235, training acc = 0.99
Batch [200/352] training loss = 0.0236, training acc = 0.99
Valid Test with nat
Test accuracy: 93.48% (4674/5000), Test loss:0.2689
Epoch [28/30], Passed time:[54.977/1539.359]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0256, training acc = 0.99
Batch [200/352] training loss = 0.0339, training acc = 0.98
Valid Test with nat
Test accuracy: 93.60% (4680/5000), Test loss:0.2545
Epoch [29/30], Passed time:[54.846/1590.539]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0595, training acc = 0.98
Batch [200/352] training loss = 0.0273, training acc = 0.99
Valid Test with nat
Test accuracy: 93.48% (4674/5000), Test loss:0.2467
Training done, model saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 92.71% (9271/10000), Test loss:0.2809
