model_type : resnet18
init_type : pure
finetune_method : nat
enhance_method : nat
gpu : 6
model_name : init_enhance60_m0.05_warmup0.1
model_width : 8
n_pruning_steps : 1
max_pruning_ratio : 80
train_epochs : 60
enhance_epochs : 60
prune_method : unstructured
dataset : cifar
noise_sd : 1.0
trades_beta : 6.0
seed : 7
warmup : True
parallel : False
create_init : False
init_step : 1400
train_method : nat
early_stop : 1000
norm : True
optm : sgd
batch_size : 128
test_batch_size : 100
learning_rate : 0.1
enhance_learning_rate : 0.1
schedule_length : 10
weight_decay : 0.0001
epsilon : 0.03137254901960784
attack_iter : 10
eps_step : 0.00784313725490196
targeted : False
clip_min : 0
clip_max : 1.0
starting_epsilon : 1e-05
interval_weight : 0.1
ft_interval_weight : 50
verbose : 200
resume : 0
model_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance60_m0.05_warmup0.1.pth
last_model_path : ./trained_models_new/
mask_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/pruned_lr0.05_mask_r80.npy
mask_name : pruned_lr0.05_mask_r80
log_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance60_m0.05_warmup0.1.log
init_path : ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
results_path : None
n_classes : 10
eval : False
init : True
transfer : False
CUDA enabled.
Enhance training config:
Enhance training method: nat
model will be saved in: ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance60_m0.05_warmup0.1.pth
Init model is: ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
Init mask used from: ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/pruned_lr0.05_mask_r80.npy
Log will be saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance60_m0.05_warmup0.1.log
Random seed is: 7

model loading from ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
Epoch [0/60]
learning rate: 0.05
Batch [0/352] training loss = 2.3039, training acc = 0.14
Batch [200/352] training loss = 0.6670, training acc = 0.78
Valid Test with nat
Test accuracy: 76.92% (3846/5000), Test loss:0.7423
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance60_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 76.81% (7681/10000), Test loss:0.7011
Epoch [1/60], Passed time:[96.564/96.564]
learning rate: 0.055
Batch [0/352] training loss = 0.5464, training acc = 0.81
Batch [200/352] training loss = 0.5864, training acc = 0.83
Valid Test with nat
Test accuracy: 80.96% (4048/5000), Test loss:0.6446
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance60_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 81.45% (8145/10000), Test loss:0.6038
Epoch [2/60], Passed time:[95.850/191.700]
learning rate: 0.060000000000000005
Batch [0/352] training loss = 0.3670, training acc = 0.87
Batch [200/352] training loss = 0.2755, training acc = 0.90
Valid Test with nat
Test accuracy: 81.70% (4085/5000), Test loss:0.5896
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance60_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 81.26% (8126/10000), Test loss:0.5823
Epoch [3/60], Passed time:[94.544/283.632]
learning rate: 0.065
Batch [0/352] training loss = 0.2827, training acc = 0.92
Batch [200/352] training loss = 0.2837, training acc = 0.89
Valid Test with nat
Test accuracy: 85.06% (4253/5000), Test loss:0.4936
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance60_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 84.95% (8495/10000), Test loss:0.5123
Epoch [4/60], Passed time:[93.959/375.835]
learning rate: 0.07
Batch [0/352] training loss = 0.1817, training acc = 0.92
Batch [200/352] training loss = 0.2757, training acc = 0.90
Valid Test with nat
Test accuracy: 88.28% (4414/5000), Test loss:0.3974
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance60_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 87.69% (8769/10000), Test loss:0.4045
Epoch [5/60], Passed time:[94.647/473.234]
learning rate: 0.07500000000000001
Batch [0/352] training loss = 0.2978, training acc = 0.86
Batch [200/352] training loss = 0.2000, training acc = 0.91
Valid Test with nat
Test accuracy: 87.32% (4366/5000), Test loss:0.4423
Epoch [6/60], Passed time:[94.209/565.255]
learning rate: 0.08000000000000002
Batch [0/352] training loss = 0.2056, training acc = 0.93
Batch [200/352] training loss = 0.2354, training acc = 0.93
Valid Test with nat
Test accuracy: 87.62% (4381/5000), Test loss:0.3952
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance60_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 87.81% (8781/10000), Test loss:0.3998
Epoch [7/60], Passed time:[94.407/660.849]
learning rate: 0.085
Batch [0/352] training loss = 0.1521, training acc = 0.95
Batch [200/352] training loss = 0.2471, training acc = 0.89
Valid Test with nat
Test accuracy: 86.36% (4318/5000), Test loss:0.4873
Epoch [8/60], Passed time:[93.713/749.701]
learning rate: 0.09
Batch [0/352] training loss = 0.2056, training acc = 0.91
Batch [200/352] training loss = 0.2967, training acc = 0.92
Valid Test with nat
Test accuracy: 89.02% (4451/5000), Test loss:0.3574
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance60_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 88.83% (8883/10000), Test loss:0.3621
Epoch [9/60], Passed time:[93.745/843.705]
learning rate: 0.095
Batch [0/352] training loss = 0.3399, training acc = 0.89
Batch [200/352] training loss = 0.2458, training acc = 0.91
Valid Test with nat
Test accuracy: 86.46% (4323/5000), Test loss:0.4747
Epoch [10/60], Passed time:[93.216/932.165]
learning rate: 0.1
Batch [0/352] training loss = 0.1716, training acc = 0.93
Batch [200/352] training loss = 0.2425, training acc = 0.91
Valid Test with nat
Test accuracy: 85.00% (4250/5000), Test loss:0.5024
Epoch [11/60], Passed time:[93.136/1024.501]
learning rate: 0.1
Batch [0/352] training loss = 0.2555, training acc = 0.91
Batch [200/352] training loss = 0.2470, training acc = 0.88
Valid Test with nat
Test accuracy: 87.26% (4363/5000), Test loss:0.4748
Epoch [12/60], Passed time:[92.399/1108.790]
learning rate: 0.1
Batch [0/352] training loss = 0.2124, training acc = 0.91
Batch [200/352] training loss = 0.1997, training acc = 0.94
Valid Test with nat
Test accuracy: 88.08% (4404/5000), Test loss:0.4191
Epoch [13/60], Passed time:[92.313/1200.063]
learning rate: 0.1
Batch [0/352] training loss = 0.1273, training acc = 0.97
Batch [200/352] training loss = 0.1540, training acc = 0.94
Valid Test with nat
Test accuracy: 88.84% (4442/5000), Test loss:0.3927
Epoch [14/60], Passed time:[91.905/1286.665]
learning rate: 0.1
Batch [0/352] training loss = 0.1632, training acc = 0.92
Batch [200/352] training loss = 0.2411, training acc = 0.89
Valid Test with nat
Test accuracy: 88.46% (4423/5000), Test loss:0.4363
Epoch [15/60], Passed time:[91.699/1375.483]
learning rate: 0.1
Batch [0/352] training loss = 0.0765, training acc = 0.98
Batch [200/352] training loss = 0.1517, training acc = 0.96
Valid Test with nat
Test accuracy: 89.24% (4462/5000), Test loss:0.3971
Epoch [16/60], Passed time:[91.752/1468.037]
learning rate: 0.1
Batch [0/352] training loss = 0.1210, training acc = 0.95
Batch [200/352] training loss = 0.0903, training acc = 0.97
Valid Test with nat
Test accuracy: 89.24% (4462/5000), Test loss:0.3651
Epoch [17/60], Passed time:[91.351/1552.973]
learning rate: 0.1
Batch [0/352] training loss = 0.0941, training acc = 0.98
Batch [200/352] training loss = 0.1225, training acc = 0.96
Valid Test with nat
Test accuracy: 88.30% (4415/5000), Test loss:0.4194
Epoch [18/60], Passed time:[91.228/1642.105]
learning rate: 0.1
Batch [0/352] training loss = 0.1623, training acc = 0.96
Batch [200/352] training loss = 0.0986, training acc = 0.96
Valid Test with nat
Test accuracy: 89.56% (4478/5000), Test loss:0.3693
Epoch [19/60], Passed time:[90.722/1723.709]
learning rate: 0.1
Batch [0/352] training loss = 0.0806, training acc = 0.98
Batch [200/352] training loss = 0.1009, training acc = 0.98
Valid Test with nat
Test accuracy: 90.24% (4512/5000), Test loss:0.3571
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance60_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 89.20% (8920/10000), Test loss:0.3809
Epoch [20/60], Passed time:[90.369/1807.389]
learning rate: 0.1
Batch [0/352] training loss = 0.0658, training acc = 0.98
Batch [200/352] training loss = 0.0971, training acc = 0.95
Valid Test with nat
Test accuracy: 90.08% (4504/5000), Test loss:0.3563
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance60_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 89.24% (8924/10000), Test loss:0.3874
Epoch [21/60], Passed time:[90.350/1897.346]
learning rate: 0.1
Batch [0/352] training loss = 0.1253, training acc = 0.96
Batch [200/352] training loss = 0.0618, training acc = 0.98
Valid Test with nat
Test accuracy: 88.24% (4412/5000), Test loss:0.4432
Epoch [22/60], Passed time:[90.331/1987.271]
learning rate: 0.1
Batch [0/352] training loss = 0.1427, training acc = 0.95
Batch [200/352] training loss = 0.0670, training acc = 0.98
Valid Test with nat
Test accuracy: 88.92% (4446/5000), Test loss:0.3875
Epoch [23/60], Passed time:[90.328/2077.551]
learning rate: 0.1
Batch [0/352] training loss = 0.0673, training acc = 0.99
Batch [200/352] training loss = 0.1082, training acc = 0.95
Valid Test with nat
Test accuracy: 90.16% (4508/5000), Test loss:0.3633
Epoch [24/60], Passed time:[90.398/2169.552]
learning rate: 0.1
Batch [0/352] training loss = 0.1177, training acc = 0.95
Batch [200/352] training loss = 0.0769, training acc = 0.98
Valid Test with nat
Test accuracy: 88.18% (4409/5000), Test loss:0.4650
Epoch [25/60], Passed time:[90.375/2259.370]
learning rate: 0.1
Batch [0/352] training loss = 0.0950, training acc = 0.96
Batch [200/352] training loss = 0.1076, training acc = 0.98
Valid Test with nat
Test accuracy: 89.18% (4459/5000), Test loss:0.4144
Epoch [26/60], Passed time:[90.446/2351.603]
learning rate: 0.1
Batch [0/352] training loss = 0.1209, training acc = 0.97
Batch [200/352] training loss = 0.0819, training acc = 0.97
Valid Test with nat
Test accuracy: 89.84% (4492/5000), Test loss:0.3680
Epoch [27/60], Passed time:[90.412/2441.116]
learning rate: 0.1
Batch [0/352] training loss = 0.1110, training acc = 0.96
Batch [200/352] training loss = 0.1631, training acc = 0.92
Valid Test with nat
Test accuracy: 89.36% (4468/5000), Test loss:0.3917
Epoch [28/60], Passed time:[90.556/2535.572]
learning rate: 0.1
Batch [0/352] training loss = 0.1212, training acc = 0.95
Batch [200/352] training loss = 0.1072, training acc = 0.95
Valid Test with nat
Test accuracy: 89.92% (4496/5000), Test loss:0.3848
Epoch [29/60], Passed time:[90.498/2624.445]
learning rate: 0.1
Batch [0/352] training loss = 0.1091, training acc = 0.97
Batch [200/352] training loss = 0.0654, training acc = 0.98
Valid Test with nat
Test accuracy: 89.12% (4456/5000), Test loss:0.4281
Epoch [30/60], Passed time:[90.452/2713.572]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0974, training acc = 0.98
Batch [200/352] training loss = 0.0447, training acc = 0.98
Valid Test with nat
Test accuracy: 92.94% (4647/5000), Test loss:0.2721
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance60_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 92.47% (9247/10000), Test loss:0.2640
Epoch [31/60], Passed time:[90.559/2807.325]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0480, training acc = 0.98
Batch [200/352] training loss = 0.0452, training acc = 0.99
Valid Test with nat
Test accuracy: 93.12% (4656/5000), Test loss:0.2693
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance60_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 92.56% (9256/10000), Test loss:0.2649
Epoch [32/60], Passed time:[90.793/2905.372]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0487, training acc = 0.98
Batch [200/352] training loss = 0.0361, training acc = 0.99
Valid Test with nat
Test accuracy: 93.34% (4667/5000), Test loss:0.2579
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance60_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 92.64% (9264/10000), Test loss:0.2675
Epoch [33/60], Passed time:[90.697/2992.991]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0487, training acc = 0.98
Batch [200/352] training loss = 0.0113, training acc = 1.00
Valid Test with nat
Test accuracy: 93.34% (4667/5000), Test loss:0.2604
Epoch [34/60], Passed time:[90.551/3078.729]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0255, training acc = 0.98
Batch [200/352] training loss = 0.0282, training acc = 0.99
Valid Test with nat
Test accuracy: 93.24% (4662/5000), Test loss:0.2846
Epoch [35/60], Passed time:[90.623/3171.815]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0402, training acc = 0.99
Batch [200/352] training loss = 0.0485, training acc = 0.98
Valid Test with nat
Test accuracy: 93.34% (4667/5000), Test loss:0.2600
Epoch [36/60], Passed time:[90.690/3264.834]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0174, training acc = 1.00
Batch [200/352] training loss = 0.0478, training acc = 0.98
Valid Test with nat
Test accuracy: 93.20% (4660/5000), Test loss:0.2709
Epoch [37/60], Passed time:[90.561/3350.756]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0485, training acc = 0.98
Batch [200/352] training loss = 0.0126, training acc = 1.00
Valid Test with nat
Test accuracy: 93.48% (4674/5000), Test loss:0.2595
Epoch [38/60], Passed time:[90.329/3432.493]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0290, training acc = 0.99
Batch [200/352] training loss = 0.0553, training acc = 0.98
Valid Test with nat
Test accuracy: 93.64% (4682/5000), Test loss:0.2665
Epoch [39/60], Passed time:[90.347/3523.515]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0173, training acc = 1.00
Batch [200/352] training loss = 0.0168, training acc = 0.99
Valid Test with nat
Test accuracy: 93.32% (4666/5000), Test loss:0.2757
Epoch [40/60], Passed time:[90.385/3615.415]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0058, training acc = 1.00
Batch [200/352] training loss = 0.0091, training acc = 1.00
Valid Test with nat
Test accuracy: 93.28% (4664/5000), Test loss:0.2842
Epoch [41/60], Passed time:[90.417/3707.110]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0199, training acc = 0.98
Batch [200/352] training loss = 0.0383, training acc = 0.98
Valid Test with nat
Test accuracy: 93.10% (4655/5000), Test loss:0.2751
Epoch [42/60], Passed time:[90.443/3798.611]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0357, training acc = 0.98
Batch [200/352] training loss = 0.0204, training acc = 0.99
Valid Test with nat
Test accuracy: 93.32% (4666/5000), Test loss:0.2769
Epoch [43/60], Passed time:[90.469/3890.159]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0351, training acc = 0.98
Batch [200/352] training loss = 0.0032, training acc = 1.00
Valid Test with nat
Test accuracy: 93.50% (4675/5000), Test loss:0.2814
Epoch [44/60], Passed time:[90.255/3971.205]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0221, training acc = 0.99
Batch [200/352] training loss = 0.0109, training acc = 0.99
Valid Test with nat
Test accuracy: 93.46% (4673/5000), Test loss:0.2769
Epoch [45/60], Passed time:[90.300/4063.504]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0189, training acc = 0.99
Batch [200/352] training loss = 0.0044, training acc = 1.00
Valid Test with nat
Test accuracy: 93.38% (4669/5000), Test loss:0.2886
Epoch [46/60], Passed time:[90.326/4155.004]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0090, training acc = 1.00
Batch [200/352] training loss = 0.0023, training acc = 1.00
Valid Test with nat
Test accuracy: 93.50% (4675/5000), Test loss:0.2845
Epoch [47/60], Passed time:[90.376/4247.649]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0348, training acc = 0.98
Batch [200/352] training loss = 0.0041, training acc = 1.00
Valid Test with nat
Test accuracy: 93.34% (4667/5000), Test loss:0.2790
Epoch [48/60], Passed time:[90.377/4338.090]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0161, training acc = 1.00
Batch [200/352] training loss = 0.0080, training acc = 1.00
Valid Test with nat
Test accuracy: 93.34% (4667/5000), Test loss:0.2760
Epoch [49/60], Passed time:[90.414/4430.268]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0092, training acc = 1.00
Batch [200/352] training loss = 0.0154, training acc = 0.99
Valid Test with nat
Test accuracy: 93.34% (4667/5000), Test loss:0.2773
Epoch [50/60], Passed time:[90.404/4520.184]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0061, training acc = 1.00
Batch [200/352] training loss = 0.0094, training acc = 1.00
Valid Test with nat
Test accuracy: 93.46% (4673/5000), Test loss:0.2902
Epoch [51/60], Passed time:[90.397/4610.238]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0140, training acc = 0.99
Batch [200/352] training loss = 0.0596, training acc = 0.98
Valid Test with nat
Test accuracy: 93.26% (4663/5000), Test loss:0.2834
Epoch [52/60], Passed time:[90.462/4703.999]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0385, training acc = 0.98
Batch [200/352] training loss = 0.0188, training acc = 0.99
Valid Test with nat
Test accuracy: 93.28% (4664/5000), Test loss:0.2901
Epoch [53/60], Passed time:[90.518/4797.446]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0030, training acc = 1.00
Batch [200/352] training loss = 0.0136, training acc = 0.99
Valid Test with nat
Test accuracy: 93.32% (4666/5000), Test loss:0.3153
Epoch [54/60], Passed time:[90.538/4889.066]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0041, training acc = 1.00
Batch [200/352] training loss = 0.0115, training acc = 0.99
Valid Test with nat
Test accuracy: 93.52% (4676/5000), Test loss:0.2816
Epoch [55/60], Passed time:[90.543/4979.884]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0128, training acc = 0.99
Batch [200/352] training loss = 0.0091, training acc = 1.00
Valid Test with nat
Test accuracy: 93.44% (4672/5000), Test loss:0.2930
Epoch [56/60], Passed time:[90.579/5072.439]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0118, training acc = 1.00
Batch [200/352] training loss = 0.0268, training acc = 0.98
Valid Test with nat
Test accuracy: 93.50% (4675/5000), Test loss:0.3094
Epoch [57/60], Passed time:[90.606/5164.554]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0222, training acc = 0.99
Batch [200/352] training loss = 0.0300, training acc = 0.99
Valid Test with nat
Test accuracy: 93.28% (4664/5000), Test loss:0.2770
Epoch [58/60], Passed time:[90.644/5257.338]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0210, training acc = 0.99
Batch [200/352] training loss = 0.0065, training acc = 1.00
Valid Test with nat
Test accuracy: 93.32% (4666/5000), Test loss:0.2945
Epoch [59/60], Passed time:[90.698/5351.203]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0378, training acc = 0.98
Batch [200/352] training loss = 0.0073, training acc = 1.00
Valid Test with nat
Test accuracy: 93.30% (4665/5000), Test loss:0.2772
Training done, model saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance60_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 93.17% (9317/10000), Test loss:0.2871
