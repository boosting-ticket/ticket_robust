model_type : resnet18
init_type : pure
finetune_method : nat
enhance_method : nat
gpu : 6
model_name : init_enhance50_m0.05_warmup0.1
model_width : 8
n_pruning_steps : 1
max_pruning_ratio : 80
train_epochs : 50
enhance_epochs : 50
prune_method : unstructured
dataset : cifar
noise_sd : 1.0
trades_beta : 6.0
seed : 7
warmup : True
parallel : False
create_init : False
init_step : 1400
train_method : nat
early_stop : 1000
norm : True
optm : sgd
batch_size : 128
test_batch_size : 100
learning_rate : 0.1
enhance_learning_rate : 0.1
schedule_length : 10
weight_decay : 0.0001
epsilon : 0.03137254901960784
attack_iter : 10
eps_step : 0.00784313725490196
targeted : False
clip_min : 0
clip_max : 1.0
starting_epsilon : 1e-05
interval_weight : 0.1
ft_interval_weight : 50
verbose : 200
resume : 0
model_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance50_m0.05_warmup0.1.pth
last_model_path : ./trained_models_new/
mask_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/pruned_lr0.05_mask_r80.npy
mask_name : pruned_lr0.05_mask_r80
log_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance50_m0.05_warmup0.1.log
init_path : ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
results_path : None
n_classes : 10
eval : False
init : True
transfer : False
CUDA enabled.
Enhance training config:
Enhance training method: nat
model will be saved in: ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance50_m0.05_warmup0.1.pth
Init model is: ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
Init mask used from: ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/pruned_lr0.05_mask_r80.npy
Log will be saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance50_m0.05_warmup0.1.log
Random seed is: 7

model loading from ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
Epoch [0/50]
learning rate: 0.05
Batch [0/352] training loss = 2.3039, training acc = 0.14
Batch [200/352] training loss = 0.6670, training acc = 0.78
Valid Test with nat
Test accuracy: 76.92% (3846/5000), Test loss:0.7423
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance50_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 76.81% (7681/10000), Test loss:0.7011
Epoch [1/50], Passed time:[63.318/63.318]
learning rate: 0.055
Batch [0/352] training loss = 0.5464, training acc = 0.81
Batch [200/352] training loss = 0.5864, training acc = 0.83
Valid Test with nat
Test accuracy: 80.96% (4048/5000), Test loss:0.6446
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance50_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 81.45% (8145/10000), Test loss:0.6038
Epoch [2/50], Passed time:[65.348/130.696]
learning rate: 0.060000000000000005
Batch [0/352] training loss = 0.3670, training acc = 0.87
Batch [200/352] training loss = 0.2755, training acc = 0.90
Valid Test with nat
Test accuracy: 81.70% (4085/5000), Test loss:0.5896
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance50_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 81.26% (8126/10000), Test loss:0.5823
Epoch [3/50], Passed time:[68.241/204.724]
learning rate: 0.065
Batch [0/352] training loss = 0.2827, training acc = 0.92
Batch [200/352] training loss = 0.2837, training acc = 0.89
Valid Test with nat
Test accuracy: 85.06% (4253/5000), Test loss:0.4936
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance50_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 84.95% (8495/10000), Test loss:0.5123
Epoch [4/50], Passed time:[71.085/284.341]
learning rate: 0.07
Batch [0/352] training loss = 0.1817, training acc = 0.92
Batch [200/352] training loss = 0.2757, training acc = 0.90
Valid Test with nat
Test accuracy: 88.28% (4414/5000), Test loss:0.3974
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance50_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 87.69% (8769/10000), Test loss:0.4045
Epoch [5/50], Passed time:[73.466/367.329]
learning rate: 0.07500000000000001
Batch [0/352] training loss = 0.2978, training acc = 0.86
Batch [200/352] training loss = 0.2000, training acc = 0.91
Valid Test with nat
Test accuracy: 87.32% (4366/5000), Test loss:0.4423
Epoch [6/50], Passed time:[74.478/446.870]
learning rate: 0.08000000000000002
Batch [0/352] training loss = 0.2056, training acc = 0.93
Batch [200/352] training loss = 0.2354, training acc = 0.93
Valid Test with nat
Test accuracy: 87.62% (4381/5000), Test loss:0.3952
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance50_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 87.81% (8781/10000), Test loss:0.3998
Epoch [7/50], Passed time:[72.808/509.659]
learning rate: 0.085
Batch [0/352] training loss = 0.1521, training acc = 0.95
Batch [200/352] training loss = 0.2471, training acc = 0.89
Valid Test with nat
Test accuracy: 86.36% (4318/5000), Test loss:0.4873
Epoch [8/50], Passed time:[72.585/580.684]
learning rate: 0.09
Batch [0/352] training loss = 0.2056, training acc = 0.91
Batch [200/352] training loss = 0.2967, training acc = 0.92
Valid Test with nat
Test accuracy: 89.02% (4451/5000), Test loss:0.3574
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance50_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 88.83% (8883/10000), Test loss:0.3621
Epoch [9/50], Passed time:[73.171/658.537]
learning rate: 0.095
Batch [0/352] training loss = 0.3399, training acc = 0.89
Batch [200/352] training loss = 0.2458, training acc = 0.91
Valid Test with nat
Test accuracy: 86.46% (4323/5000), Test loss:0.4747
Epoch [10/50], Passed time:[74.150/741.496]
learning rate: 0.1
Batch [0/352] training loss = 0.1716, training acc = 0.93
Batch [200/352] training loss = 0.2425, training acc = 0.91
Valid Test with nat
Test accuracy: 85.00% (4250/5000), Test loss:0.5024
Epoch [11/50], Passed time:[75.181/826.989]
learning rate: 0.1
Batch [0/352] training loss = 0.2555, training acc = 0.91
Batch [200/352] training loss = 0.2470, training acc = 0.88
Valid Test with nat
Test accuracy: 87.26% (4363/5000), Test loss:0.4748
Epoch [12/50], Passed time:[75.893/910.715]
learning rate: 0.1
Batch [0/352] training loss = 0.2124, training acc = 0.91
Batch [200/352] training loss = 0.1997, training acc = 0.94
Valid Test with nat
Test accuracy: 88.08% (4404/5000), Test loss:0.4191
Epoch [13/50], Passed time:[76.580/995.543]
learning rate: 0.1
Batch [0/352] training loss = 0.1273, training acc = 0.97
Batch [200/352] training loss = 0.1540, training acc = 0.94
Valid Test with nat
Test accuracy: 88.84% (4442/5000), Test loss:0.3927
Epoch [14/50], Passed time:[77.016/1078.220]
learning rate: 0.1
Batch [0/352] training loss = 0.1632, training acc = 0.92
Batch [200/352] training loss = 0.2411, training acc = 0.89
Valid Test with nat
Test accuracy: 88.46% (4423/5000), Test loss:0.4363
Epoch [15/50], Passed time:[77.468/1162.020]
learning rate: 0.1
Batch [0/352] training loss = 0.0765, training acc = 0.98
Batch [200/352] training loss = 0.1517, training acc = 0.96
Valid Test with nat
Test accuracy: 89.24% (4462/5000), Test loss:0.3971
Epoch [16/50], Passed time:[77.604/1241.667]
learning rate: 0.1
Batch [0/352] training loss = 0.1210, training acc = 0.95
Batch [200/352] training loss = 0.0903, training acc = 0.97
Valid Test with nat
Test accuracy: 89.24% (4462/5000), Test loss:0.3651
Epoch [17/50], Passed time:[77.939/1324.958]
learning rate: 0.1
Batch [0/352] training loss = 0.0941, training acc = 0.98
Batch [200/352] training loss = 0.1225, training acc = 0.96
Valid Test with nat
Test accuracy: 88.30% (4415/5000), Test loss:0.4194
Epoch [18/50], Passed time:[78.293/1409.273]
learning rate: 0.1
Batch [0/352] training loss = 0.1623, training acc = 0.96
Batch [200/352] training loss = 0.0986, training acc = 0.96
Valid Test with nat
Test accuracy: 89.56% (4478/5000), Test loss:0.3693
Epoch [19/50], Passed time:[78.564/1492.709]
learning rate: 0.1
Batch [0/352] training loss = 0.0806, training acc = 0.98
Batch [200/352] training loss = 0.1009, training acc = 0.98
Valid Test with nat
Test accuracy: 90.24% (4512/5000), Test loss:0.3571
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance50_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 89.20% (8920/10000), Test loss:0.3809
Epoch [20/50], Passed time:[78.906/1578.116]
learning rate: 0.1
Batch [0/352] training loss = 0.0658, training acc = 0.98
Batch [200/352] training loss = 0.0971, training acc = 0.95
Valid Test with nat
Test accuracy: 90.08% (4504/5000), Test loss:0.3563
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance50_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 89.24% (8924/10000), Test loss:0.3874
Epoch [21/50], Passed time:[79.383/1667.042]
learning rate: 0.1
Batch [0/352] training loss = 0.1253, training acc = 0.96
Batch [200/352] training loss = 0.0618, training acc = 0.98
Valid Test with nat
Test accuracy: 88.24% (4412/5000), Test loss:0.4432
Epoch [22/50], Passed time:[79.526/1749.579]
learning rate: 0.1
Batch [0/352] training loss = 0.1427, training acc = 0.95
Batch [200/352] training loss = 0.0670, training acc = 0.98
Valid Test with nat
Test accuracy: 88.92% (4446/5000), Test loss:0.3875
Epoch [23/50], Passed time:[79.848/1836.510]
learning rate: 0.1
Batch [0/352] training loss = 0.0673, training acc = 0.99
Batch [200/352] training loss = 0.1082, training acc = 0.95
Valid Test with nat
Test accuracy: 90.16% (4508/5000), Test loss:0.3633
Epoch [24/50], Passed time:[80.012/1920.277]
learning rate: 0.1
Batch [0/352] training loss = 0.1177, training acc = 0.95
Batch [200/352] training loss = 0.0769, training acc = 0.98
Valid Test with nat
Test accuracy: 88.18% (4409/5000), Test loss:0.4650
Epoch [25/50], Passed time:[80.058/2001.462]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0950, training acc = 0.96
Batch [200/352] training loss = 0.0818, training acc = 0.99
Valid Test with nat
Test accuracy: 92.76% (4638/5000), Test loss:0.2514
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance50_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 92.39% (9239/10000), Test loss:0.2586
Epoch [26/50], Passed time:[80.248/2086.455]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0289, training acc = 1.00
Batch [200/352] training loss = 0.0651, training acc = 0.98
Valid Test with nat
Test accuracy: 93.06% (4653/5000), Test loss:0.2621
Epoch [27/50], Passed time:[80.217/2165.847]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0324, training acc = 0.98
Batch [200/352] training loss = 0.0228, training acc = 0.98
Valid Test with nat
Test accuracy: 92.90% (4645/5000), Test loss:0.2752
Epoch [28/50], Passed time:[80.294/2248.229]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0261, training acc = 1.00
Batch [200/352] training loss = 0.0454, training acc = 0.98
Valid Test with nat
Test accuracy: 93.04% (4652/5000), Test loss:0.2568
Epoch [29/50], Passed time:[80.504/2334.618]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.1055, training acc = 0.97
Batch [200/352] training loss = 0.0294, training acc = 0.99
Valid Test with nat
Test accuracy: 93.00% (4650/5000), Test loss:0.2594
Epoch [30/50], Passed time:[80.425/2412.763]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0376, training acc = 0.98
Batch [200/352] training loss = 0.0331, training acc = 0.98
Valid Test with nat
Test accuracy: 92.82% (4641/5000), Test loss:0.2622
Epoch [31/50], Passed time:[80.702/2501.767]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0281, training acc = 0.99
Batch [200/352] training loss = 0.0373, training acc = 0.98
Valid Test with nat
Test accuracy: 93.06% (4653/5000), Test loss:0.2659
Epoch [32/50], Passed time:[80.893/2588.585]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0195, training acc = 0.99
Batch [200/352] training loss = 0.0447, training acc = 0.98
Valid Test with nat
Test accuracy: 93.22% (4661/5000), Test loss:0.2905
Epoch [33/50], Passed time:[81.031/2674.019]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0456, training acc = 0.98
Batch [200/352] training loss = 0.0644, training acc = 0.98
Valid Test with nat
Test accuracy: 93.46% (4673/5000), Test loss:0.2634
Epoch [34/50], Passed time:[81.111/2757.760]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0197, training acc = 0.99
Batch [200/352] training loss = 0.0091, training acc = 0.99
Valid Test with nat
Test accuracy: 93.34% (4667/5000), Test loss:0.2625
Epoch [35/50], Passed time:[81.227/2842.928]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0289, training acc = 0.98
Batch [200/352] training loss = 0.0271, training acc = 0.99
Valid Test with nat
Test accuracy: 93.22% (4661/5000), Test loss:0.2846
Epoch [36/50], Passed time:[81.317/2927.395]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0348, training acc = 0.98
Batch [200/352] training loss = 0.0379, training acc = 0.98
Valid Test with nat
Test accuracy: 93.24% (4662/5000), Test loss:0.2757
Epoch [37/50], Passed time:[81.423/3012.655]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0654, training acc = 0.98
Batch [200/352] training loss = 0.0102, training acc = 1.00
Valid Test with nat
Test accuracy: 93.26% (4663/5000), Test loss:0.2808
Epoch [38/50], Passed time:[81.489/3096.579]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0862, training acc = 0.98
Batch [200/352] training loss = 0.0263, training acc = 0.99
Valid Test with nat
Test accuracy: 93.30% (4665/5000), Test loss:0.2684
Epoch [39/50], Passed time:[81.696/3186.157]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0177, training acc = 0.99
Batch [200/352] training loss = 0.0158, training acc = 1.00
Valid Test with nat
Test accuracy: 93.40% (4670/5000), Test loss:0.2667
Epoch [40/50], Passed time:[81.789/3271.546]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0320, training acc = 0.98
Batch [200/352] training loss = 0.0182, training acc = 0.99
Valid Test with nat
Test accuracy: 93.18% (4659/5000), Test loss:0.2801
Epoch [41/50], Passed time:[81.765/3352.358]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0071, training acc = 1.00
Batch [200/352] training loss = 0.0148, training acc = 0.99
Valid Test with nat
Test accuracy: 93.34% (4667/5000), Test loss:0.2667
Epoch [42/50], Passed time:[81.621/3428.092]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0279, training acc = 0.99
Batch [200/352] training loss = 0.0330, training acc = 0.98
Valid Test with nat
Test accuracy: 93.42% (4671/5000), Test loss:0.2822
Epoch [43/50], Passed time:[81.568/3507.416]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0308, training acc = 0.98
Batch [200/352] training loss = 0.0365, training acc = 0.99
Valid Test with nat
Test accuracy: 93.42% (4671/5000), Test loss:0.2693
Epoch [44/50], Passed time:[81.486/3585.388]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0093, training acc = 1.00
Batch [200/352] training loss = 0.0119, training acc = 0.99
Valid Test with nat
Test accuracy: 93.34% (4667/5000), Test loss:0.2763
Epoch [45/50], Passed time:[81.476/3666.406]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0155, training acc = 1.00
Batch [200/352] training loss = 0.0120, training acc = 1.00
Valid Test with nat
Test accuracy: 93.22% (4661/5000), Test loss:0.2858
Epoch [46/50], Passed time:[81.418/3745.213]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0242, training acc = 0.98
Batch [200/352] training loss = 0.0365, training acc = 0.98
Valid Test with nat
Test accuracy: 93.42% (4671/5000), Test loss:0.2711
Epoch [47/50], Passed time:[81.569/3833.727]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0264, training acc = 0.98
Batch [200/352] training loss = 0.0115, training acc = 1.00
Valid Test with nat
Test accuracy: 93.44% (4672/5000), Test loss:0.2935
Epoch [48/50], Passed time:[81.566/3915.156]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0121, training acc = 1.00
Batch [200/352] training loss = 0.0240, training acc = 0.98
Valid Test with nat
Test accuracy: 93.50% (4675/5000), Test loss:0.2647
Epoch [49/50], Passed time:[81.560/3996.462]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0289, training acc = 0.99
Batch [200/352] training loss = 0.0282, training acc = 0.98
Valid Test with nat
Test accuracy: 93.46% (4673/5000), Test loss:0.2683
Training done, model saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance50_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 93.12% (9312/10000), Test loss:0.2896
