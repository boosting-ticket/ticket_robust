model_type : resnet18
init_type : pure
finetune_method : nat
enhance_method : nat
gpu : 6
model_name : init_enhance20_m0.05_warmup0.1
model_width : 8
n_pruning_steps : 1
max_pruning_ratio : 80
train_epochs : 20
enhance_epochs : 20
prune_method : unstructured
dataset : cifar
noise_sd : 1.0
trades_beta : 6.0
seed : 7
warmup : True
parallel : False
create_init : False
init_step : 1400
train_method : nat
early_stop : 1000
norm : True
optm : sgd
batch_size : 128
test_batch_size : 100
learning_rate : 0.1
enhance_learning_rate : 0.1
schedule_length : 10
weight_decay : 0.0001
epsilon : 0.03137254901960784
attack_iter : 10
eps_step : 0.00784313725490196
targeted : False
clip_min : 0
clip_max : 1.0
starting_epsilon : 1e-05
interval_weight : 0.1
ft_interval_weight : 50
verbose : 200
resume : 0
model_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.05_warmup0.1.pth
last_model_path : ./trained_models_new/
mask_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/pruned_lr0.05_mask_r80.npy
mask_name : pruned_lr0.05_mask_r80
log_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.05_warmup0.1.log
init_path : ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
results_path : None
n_classes : 10
eval : False
init : True
transfer : False
CUDA enabled.
Enhance training config:
Enhance training method: nat
model will be saved in: ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.05_warmup0.1.pth
Init model is: ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
Init mask used from: ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/pruned_lr0.05_mask_r80.npy
Log will be saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.05_warmup0.1.log
Random seed is: 7

model loading from ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
Epoch [0/20]
learning rate: 0.05
Batch [0/352] training loss = 2.3039, training acc = 0.14
Batch [200/352] training loss = 0.6670, training acc = 0.78
Valid Test with nat
Test accuracy: 76.92% (3846/5000), Test loss:0.7423
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 76.81% (7681/10000), Test loss:0.7011
Epoch [1/20], Passed time:[72.375/72.375]
learning rate: 0.055
Batch [0/352] training loss = 0.5464, training acc = 0.81
Batch [200/352] training loss = 0.5864, training acc = 0.83
Valid Test with nat
Test accuracy: 80.96% (4048/5000), Test loss:0.6446
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 81.45% (8145/10000), Test loss:0.6038
Epoch [2/20], Passed time:[72.529/145.057]
learning rate: 0.060000000000000005
Batch [0/352] training loss = 0.3670, training acc = 0.87
Batch [200/352] training loss = 0.2755, training acc = 0.90
Valid Test with nat
Test accuracy: 81.70% (4085/5000), Test loss:0.5896
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 81.26% (8126/10000), Test loss:0.5823
Epoch [3/20], Passed time:[71.914/215.741]
learning rate: 0.065
Batch [0/352] training loss = 0.2827, training acc = 0.92
Batch [200/352] training loss = 0.2837, training acc = 0.89
Valid Test with nat
Test accuracy: 85.06% (4253/5000), Test loss:0.4936
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 84.95% (8495/10000), Test loss:0.5123
Epoch [4/20], Passed time:[72.164/288.656]
learning rate: 0.07
Batch [0/352] training loss = 0.1817, training acc = 0.92
Batch [200/352] training loss = 0.2757, training acc = 0.90
Valid Test with nat
Test accuracy: 88.28% (4414/5000), Test loss:0.3974
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 87.69% (8769/10000), Test loss:0.4045
Epoch [5/20], Passed time:[71.791/358.956]
learning rate: 0.07500000000000001
Batch [0/352] training loss = 0.2978, training acc = 0.86
Batch [200/352] training loss = 0.2000, training acc = 0.91
Valid Test with nat
Test accuracy: 87.32% (4366/5000), Test loss:0.4423
Epoch [6/20], Passed time:[71.259/427.553]
learning rate: 0.08000000000000002
Batch [0/352] training loss = 0.2056, training acc = 0.93
Batch [200/352] training loss = 0.2354, training acc = 0.93
Valid Test with nat
Test accuracy: 87.62% (4381/5000), Test loss:0.3952
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 87.81% (8781/10000), Test loss:0.3998
Epoch [7/20], Passed time:[71.157/498.101]
learning rate: 0.085
Batch [0/352] training loss = 0.1521, training acc = 0.95
Batch [200/352] training loss = 0.2471, training acc = 0.89
Valid Test with nat
Test accuracy: 86.36% (4318/5000), Test loss:0.4873
Epoch [8/20], Passed time:[70.694/565.553]
learning rate: 0.09
Batch [0/352] training loss = 0.2056, training acc = 0.91
Batch [200/352] training loss = 0.2967, training acc = 0.92
Valid Test with nat
Test accuracy: 89.02% (4451/5000), Test loss:0.3574
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 88.83% (8883/10000), Test loss:0.3621
Epoch [9/20], Passed time:[70.927/638.343]
learning rate: 0.095
Batch [0/352] training loss = 0.3399, training acc = 0.89
Batch [200/352] training loss = 0.2458, training acc = 0.91
Valid Test with nat
Test accuracy: 86.46% (4323/5000), Test loss:0.4747
Epoch [10/20], Passed time:[70.781/707.809]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.1716, training acc = 0.93
Batch [200/352] training loss = 0.1214, training acc = 0.96
Valid Test with nat
Test accuracy: 92.58% (4629/5000), Test loss:0.2401
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 92.42% (9242/10000), Test loss:0.2518
Epoch [11/20], Passed time:[70.973/780.705]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.1424, training acc = 0.93
Batch [200/352] training loss = 0.0646, training acc = 0.99
Valid Test with nat
Test accuracy: 92.80% (4640/5000), Test loss:0.2511
Epoch [12/20], Passed time:[70.655/847.864]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0262, training acc = 1.00
Batch [200/352] training loss = 0.0759, training acc = 0.97
Valid Test with nat
Test accuracy: 92.46% (4623/5000), Test loss:0.2496
Epoch [13/20], Passed time:[70.533/916.924]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0995, training acc = 0.98
Batch [200/352] training loss = 0.0325, training acc = 0.99
Valid Test with nat
Test accuracy: 92.68% (4634/5000), Test loss:0.2448
Epoch [14/20], Passed time:[70.484/986.774]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0391, training acc = 0.99
Batch [200/352] training loss = 0.0842, training acc = 0.96
Valid Test with nat
Test accuracy: 92.80% (4640/5000), Test loss:0.2436
Epoch [15/20], Passed time:[70.389/1055.830]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0265, training acc = 1.00
Batch [200/352] training loss = 0.0635, training acc = 0.97
Valid Test with nat
Test accuracy: 92.72% (4636/5000), Test loss:0.2426
Epoch [16/20], Passed time:[70.172/1122.751]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0429, training acc = 0.98
Batch [200/352] training loss = 0.1009, training acc = 0.96
Valid Test with nat
Test accuracy: 92.90% (4645/5000), Test loss:0.2405
Epoch [17/20], Passed time:[69.808/1186.728]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0630, training acc = 0.99
Batch [200/352] training loss = 0.0616, training acc = 0.98
Valid Test with nat
Test accuracy: 92.80% (4640/5000), Test loss:0.2451
Epoch [18/20], Passed time:[69.739/1255.308]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0282, training acc = 0.99
Batch [200/352] training loss = 0.0336, training acc = 0.99
Valid Test with nat
Test accuracy: 92.86% (4643/5000), Test loss:0.2571
Epoch [19/20], Passed time:[69.575/1321.930]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0633, training acc = 0.98
Batch [200/352] training loss = 0.0322, training acc = 0.99
Valid Test with nat
Test accuracy: 93.02% (4651/5000), Test loss:0.2428
Training done, model saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.05_warmup0.1.pth
Test on test set:
Test accuracy: 92.55% (9255/10000), Test loss:0.2692
