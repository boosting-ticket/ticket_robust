model_type : resnet18
init_type : pure
finetune_method : nat
enhance_method : nat
gpu : 8
model_name : init_enhance90_m0.1_warmup0.1
model_width : 8
n_pruning_steps : 1
max_pruning_ratio : 80
train_epochs : 90
enhance_epochs : 90
prune_method : unstructured
dataset : cifar
noise_sd : 1.0
trades_beta : 6.0
seed : 7
warmup : True
parallel : False
create_init : False
init_step : 1400
train_method : nat
early_stop : 1000
norm : True
optm : sgd
batch_size : 128
test_batch_size : 100
learning_rate : 0.1
enhance_learning_rate : 0.1
schedule_length : 10
weight_decay : 0.0001
epsilon : 0.03137254901960784
attack_iter : 10
eps_step : 0.00784313725490196
targeted : False
clip_min : 0
clip_max : 1.0
starting_epsilon : 1e-05
interval_weight : 0.1
ft_interval_weight : 50
verbose : 200
resume : 0
model_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance90_m0.1_warmup0.1.pth
last_model_path : ./trained_models_new/
mask_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/pruned_lr0.1_mask_r80.npy
mask_name : pruned_lr0.1_mask_r80
log_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance90_m0.1_warmup0.1.log
init_path : ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
results_path : None
n_classes : 10
eval : False
init : True
transfer : False
CUDA enabled.
Enhance training config:
Enhance training method: nat
model will be saved in: ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance90_m0.1_warmup0.1.pth
Init model is: ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
Init mask used from: ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/pruned_lr0.1_mask_r80.npy
Log will be saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance90_m0.1_warmup0.1.log
Random seed is: 7

model loading from ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
Epoch [0/90]
learning rate: 0.05
Batch [0/352] training loss = 2.3339, training acc = 0.12
Batch [200/352] training loss = 1.4568, training acc = 0.42
Valid Test with nat
Test accuracy: 47.08% (2354/5000), Test loss:1.6841
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance90_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 46.13% (4613/10000), Test loss:1.7091
Epoch [1/90], Passed time:[83.842/83.842]
learning rate: 0.055
Batch [0/352] training loss = 1.2090, training acc = 0.56
Batch [200/352] training loss = 1.2143, training acc = 0.59
Valid Test with nat
Test accuracy: 66.28% (3314/5000), Test loss:0.9990
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance90_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 65.48% (6548/10000), Test loss:1.0107
Epoch [2/90], Passed time:[84.749/169.497]
learning rate: 0.060000000000000005
Batch [0/352] training loss = 0.7740, training acc = 0.70
Batch [200/352] training loss = 0.6964, training acc = 0.75
Valid Test with nat
Test accuracy: 70.28% (3514/5000), Test loss:0.9266
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance90_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 68.64% (6864/10000), Test loss:0.9548
Epoch [3/90], Passed time:[84.491/253.472]
learning rate: 0.065
Batch [0/352] training loss = 0.7613, training acc = 0.70
Batch [200/352] training loss = 0.7098, training acc = 0.76
Valid Test with nat
Test accuracy: 72.54% (3627/5000), Test loss:0.8091
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance90_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 71.56% (7156/10000), Test loss:0.8482
Epoch [4/90], Passed time:[84.292/337.168]
learning rate: 0.07
Batch [0/352] training loss = 0.6780, training acc = 0.77
Batch [200/352] training loss = 0.6809, training acc = 0.79
Valid Test with nat
Test accuracy: 75.56% (3778/5000), Test loss:0.7631
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance90_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 76.10% (7610/10000), Test loss:0.7369
Epoch [5/90], Passed time:[84.839/424.193]
learning rate: 0.07500000000000001
Batch [0/352] training loss = 0.5833, training acc = 0.79
Batch [200/352] training loss = 0.5895, training acc = 0.79
Valid Test with nat
Test accuracy: 76.40% (3820/5000), Test loss:0.7509
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance90_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 75.24% (7524/10000), Test loss:0.7792
Epoch [6/90], Passed time:[84.297/505.785]
learning rate: 0.08000000000000002
Batch [0/352] training loss = 0.3211, training acc = 0.91
Batch [200/352] training loss = 0.4041, training acc = 0.83
Valid Test with nat
Test accuracy: 78.90% (3945/5000), Test loss:0.7025
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance90_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 77.91% (7791/10000), Test loss:0.7214
Epoch [7/90], Passed time:[84.582/592.074]
learning rate: 0.085
Batch [0/352] training loss = 0.5847, training acc = 0.79
Batch [200/352] training loss = 0.4339, training acc = 0.85
Valid Test with nat
Test accuracy: 80.80% (4040/5000), Test loss:0.6341
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance90_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 80.15% (8015/10000), Test loss:0.6413
Epoch [8/90], Passed time:[84.916/679.332]
learning rate: 0.09
Batch [0/352] training loss = 0.5461, training acc = 0.80
Batch [200/352] training loss = 0.4164, training acc = 0.88
Valid Test with nat
Test accuracy: 82.30% (4115/5000), Test loss:0.5526
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance90_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 81.47% (8147/10000), Test loss:0.6023
Epoch [9/90], Passed time:[85.477/769.290]
learning rate: 0.095
Batch [0/352] training loss = 0.3766, training acc = 0.87
Batch [200/352] training loss = 0.4128, training acc = 0.85
Valid Test with nat
Test accuracy: 82.02% (4101/5000), Test loss:0.5595
Epoch [10/90], Passed time:[84.742/847.421]
learning rate: 0.1
Batch [0/352] training loss = 0.4248, training acc = 0.84
Batch [200/352] training loss = 0.3382, training acc = 0.91
Valid Test with nat
Test accuracy: 83.92% (4196/5000), Test loss:0.5264
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance90_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 83.65% (8365/10000), Test loss:0.4944
Epoch [11/90], Passed time:[84.896/933.856]
learning rate: 0.1
Batch [0/352] training loss = 0.3641, training acc = 0.87
Batch [200/352] training loss = 0.5245, training acc = 0.85
Valid Test with nat
Test accuracy: 85.86% (4293/5000), Test loss:0.4479
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance90_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 85.58% (8558/10000), Test loss:0.4239
Epoch [12/90], Passed time:[85.377/1024.522]
learning rate: 0.1
Batch [0/352] training loss = 0.3093, training acc = 0.90
Batch [200/352] training loss = 0.3456, training acc = 0.90
Valid Test with nat
Test accuracy: 84.60% (4230/5000), Test loss:0.4970
Epoch [13/90], Passed time:[85.224/1107.918]
learning rate: 0.1
Batch [0/352] training loss = 0.2800, training acc = 0.90
Batch [200/352] training loss = 0.3086, training acc = 0.89
Valid Test with nat
Test accuracy: 85.52% (4276/5000), Test loss:0.4482
Epoch [14/90], Passed time:[84.782/1186.946]
learning rate: 0.1
Batch [0/352] training loss = 0.3241, training acc = 0.88
Batch [200/352] training loss = 0.3906, training acc = 0.90
Valid Test with nat
Test accuracy: 82.46% (4123/5000), Test loss:0.5641
Epoch [15/90], Passed time:[84.959/1274.387]
learning rate: 0.1
Batch [0/352] training loss = 0.4291, training acc = 0.87
Batch [200/352] training loss = 0.2975, training acc = 0.91
Valid Test with nat
Test accuracy: 86.84% (4342/5000), Test loss:0.4177
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance90_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 87.09% (8709/10000), Test loss:0.4094
Epoch [16/90], Passed time:[85.499/1367.982]
learning rate: 0.1
Batch [0/352] training loss = 0.1677, training acc = 0.95
Batch [200/352] training loss = 0.3236, training acc = 0.88
Valid Test with nat
Test accuracy: 87.30% (4365/5000), Test loss:0.3969
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance90_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 86.13% (8613/10000), Test loss:0.4203
Epoch [17/90], Passed time:[86.198/1465.373]
learning rate: 0.1
Batch [0/352] training loss = 0.2532, training acc = 0.91
Batch [200/352] training loss = 0.2224, training acc = 0.92
Valid Test with nat
Test accuracy: 86.00% (4300/5000), Test loss:0.4698
Epoch [18/90], Passed time:[86.337/1554.066]
learning rate: 0.1
Batch [0/352] training loss = 0.2571, training acc = 0.90
Batch [200/352] training loss = 0.3131, training acc = 0.89
Valid Test with nat
Test accuracy: 84.32% (4216/5000), Test loss:0.5338
Epoch [19/90], Passed time:[86.283/1639.369]
learning rate: 0.1
Batch [0/352] training loss = 0.2667, training acc = 0.92
Batch [200/352] training loss = 0.2408, training acc = 0.91
Valid Test with nat
Test accuracy: 86.04% (4302/5000), Test loss:0.4129
Epoch [20/90], Passed time:[86.313/1726.254]
learning rate: 0.1
Batch [0/352] training loss = 0.2569, training acc = 0.91
Batch [200/352] training loss = 0.3588, training acc = 0.87
Valid Test with nat
Test accuracy: 85.66% (4283/5000), Test loss:0.4636
Epoch [21/90], Passed time:[86.287/1812.025]
learning rate: 0.1
Batch [0/352] training loss = 0.1997, training acc = 0.94
Batch [200/352] training loss = 0.3588, training acc = 0.86
Valid Test with nat
Test accuracy: 87.64% (4382/5000), Test loss:0.3963
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance90_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 86.98% (8698/10000), Test loss:0.4002
Epoch [22/90], Passed time:[86.698/1907.355]
learning rate: 0.1
Batch [0/352] training loss = 0.1651, training acc = 0.95
Batch [200/352] training loss = 0.1777, training acc = 0.91
Valid Test with nat
Test accuracy: 87.04% (4352/5000), Test loss:0.4106
Epoch [23/90], Passed time:[87.007/2001.151]
learning rate: 0.1
Batch [0/352] training loss = 0.2412, training acc = 0.91
Batch [200/352] training loss = 0.2542, training acc = 0.91
Valid Test with nat
Test accuracy: 86.80% (4340/5000), Test loss:0.4060
Epoch [24/90], Passed time:[86.904/2085.687]
learning rate: 0.1
Batch [0/352] training loss = 0.2806, training acc = 0.90
Batch [200/352] training loss = 0.2317, training acc = 0.91
Valid Test with nat
Test accuracy: 83.76% (4188/5000), Test loss:0.5782
Epoch [25/90], Passed time:[86.966/2174.149]
learning rate: 0.1
Batch [0/352] training loss = 0.2610, training acc = 0.91
Batch [200/352] training loss = 0.2940, training acc = 0.87
Valid Test with nat
Test accuracy: 86.82% (4341/5000), Test loss:0.4499
Epoch [26/90], Passed time:[87.036/2262.928]
learning rate: 0.1
Batch [0/352] training loss = 0.2405, training acc = 0.88
Batch [200/352] training loss = 0.2394, training acc = 0.89
Valid Test with nat
Test accuracy: 87.74% (4387/5000), Test loss:0.4140
Epoch [27/90], Passed time:[86.963/2348.012]
learning rate: 0.1
Batch [0/352] training loss = 0.2125, training acc = 0.92
Batch [200/352] training loss = 0.1917, training acc = 0.93
Valid Test with nat
Test accuracy: 86.44% (4322/5000), Test loss:0.4406
Epoch [28/90], Passed time:[87.015/2436.425]
learning rate: 0.1
Batch [0/352] training loss = 0.2535, training acc = 0.91
Batch [200/352] training loss = 0.2527, training acc = 0.89
Valid Test with nat
Test accuracy: 85.94% (4297/5000), Test loss:0.4769
Epoch [29/90], Passed time:[86.936/2521.147]
learning rate: 0.1
Batch [0/352] training loss = 0.1985, training acc = 0.92
Batch [200/352] training loss = 0.2061, training acc = 0.94
Valid Test with nat
Test accuracy: 86.82% (4341/5000), Test loss:0.4367
Epoch [30/90], Passed time:[87.029/2610.884]
learning rate: 0.1
Batch [0/352] training loss = 0.1849, training acc = 0.94
Batch [200/352] training loss = 0.2287, training acc = 0.91
Valid Test with nat
Test accuracy: 85.60% (4280/5000), Test loss:0.5008
Epoch [31/90], Passed time:[87.128/2700.959]
learning rate: 0.1
Batch [0/352] training loss = 0.2447, training acc = 0.93
Batch [200/352] training loss = 0.3090, training acc = 0.91
Valid Test with nat
Test accuracy: 87.66% (4383/5000), Test loss:0.4152
Epoch [32/90], Passed time:[87.077/2786.456]
learning rate: 0.1
Batch [0/352] training loss = 0.1357, training acc = 0.97
Batch [200/352] training loss = 0.2078, training acc = 0.92
Valid Test with nat
Test accuracy: 87.38% (4369/5000), Test loss:0.4478
Epoch [33/90], Passed time:[86.956/2869.535]
learning rate: 0.1
Batch [0/352] training loss = 0.2705, training acc = 0.91
Batch [200/352] training loss = 0.3184, training acc = 0.89
Valid Test with nat
Test accuracy: 88.18% (4409/5000), Test loss:0.3843
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance90_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 89.23% (8923/10000), Test loss:0.3490
Epoch [34/90], Passed time:[87.224/2965.619]
learning rate: 0.1
Batch [0/352] training loss = 0.1932, training acc = 0.91
Batch [200/352] training loss = 0.1782, training acc = 0.92
Valid Test with nat
Test accuracy: 87.72% (4386/5000), Test loss:0.4139
Epoch [35/90], Passed time:[87.448/3060.682]
learning rate: 0.1
Batch [0/352] training loss = 0.2851, training acc = 0.91
Batch [200/352] training loss = 0.2368, training acc = 0.91
Valid Test with nat
Test accuracy: 87.58% (4379/5000), Test loss:0.4297
Epoch [36/90], Passed time:[87.639/3155.014]
learning rate: 0.1
Batch [0/352] training loss = 0.2131, training acc = 0.93
Batch [200/352] training loss = 0.2230, training acc = 0.91
Valid Test with nat
Test accuracy: 88.28% (4414/5000), Test loss:0.3851
Epoch [37/90], Passed time:[87.738/3246.299]
learning rate: 0.1
Batch [0/352] training loss = 0.2152, training acc = 0.92
Batch [200/352] training loss = 0.1317, training acc = 0.95
Valid Test with nat
Test accuracy: 86.60% (4330/5000), Test loss:0.4717
Epoch [38/90], Passed time:[87.893/3339.938]
learning rate: 0.1
Batch [0/352] training loss = 0.2248, training acc = 0.93
Batch [200/352] training loss = 0.1350, training acc = 0.94
Valid Test with nat
Test accuracy: 83.28% (4164/5000), Test loss:0.6346
Epoch [39/90], Passed time:[88.089/3435.482]
learning rate: 0.1
Batch [0/352] training loss = 0.0801, training acc = 0.98
Batch [200/352] training loss = 0.2919, training acc = 0.90
Valid Test with nat
Test accuracy: 88.50% (4425/5000), Test loss:0.3803
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance90_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 88.88% (8888/10000), Test loss:0.3575
Epoch [40/90], Passed time:[88.236/3529.440]
learning rate: 0.1
Batch [0/352] training loss = 0.3147, training acc = 0.88
Batch [200/352] training loss = 0.1097, training acc = 0.96
Valid Test with nat
Test accuracy: 89.24% (4462/5000), Test loss:0.3682
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance90_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 87.41% (8741/10000), Test loss:0.4326
Epoch [41/90], Passed time:[88.425/3625.418]
learning rate: 0.1
Batch [0/352] training loss = 0.2090, training acc = 0.94
Batch [200/352] training loss = 0.1263, training acc = 0.97
Valid Test with nat
Test accuracy: 86.72% (4336/5000), Test loss:0.4560
Epoch [42/90], Passed time:[88.415/3713.420]
learning rate: 0.1
Batch [0/352] training loss = 0.2650, training acc = 0.91
Batch [200/352] training loss = 0.3310, training acc = 0.88
Valid Test with nat
Test accuracy: 87.14% (4357/5000), Test loss:0.4722
Epoch [43/90], Passed time:[88.531/3806.821]
learning rate: 0.1
Batch [0/352] training loss = 0.3644, training acc = 0.88
Batch [200/352] training loss = 0.2771, training acc = 0.89
Valid Test with nat
Test accuracy: 86.00% (4300/5000), Test loss:0.5278
Epoch [44/90], Passed time:[88.530/3895.327]
learning rate: 0.1
Batch [0/352] training loss = 0.1688, training acc = 0.94
Batch [200/352] training loss = 0.2009, training acc = 0.95
Valid Test with nat
Test accuracy: 89.22% (4461/5000), Test loss:0.3580
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance90_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 89.15% (8915/10000), Test loss:0.3574
Epoch [45/90], Passed time:[88.422/3979.005]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.1880, training acc = 0.94
Batch [200/352] training loss = 0.1307, training acc = 0.95
Valid Test with nat
Test accuracy: 91.88% (4594/5000), Test loss:0.2594
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance90_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 92.14% (9214/10000), Test loss:0.2659
Epoch [46/90], Passed time:[88.217/4057.968]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.1049, training acc = 0.97
Batch [200/352] training loss = 0.0868, training acc = 0.98
Valid Test with nat
Test accuracy: 92.36% (4618/5000), Test loss:0.2549
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance90_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 92.50% (9250/10000), Test loss:0.2597
Epoch [47/90], Passed time:[88.159/4143.455]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.1692, training acc = 0.93
Batch [200/352] training loss = 0.1153, training acc = 0.98
Valid Test with nat
Test accuracy: 92.60% (4630/5000), Test loss:0.2545
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance90_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 92.33% (9233/10000), Test loss:0.2636
Epoch [48/90], Passed time:[88.260/4236.466]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0783, training acc = 0.98
Batch [200/352] training loss = 0.0739, training acc = 0.98
Valid Test with nat
Test accuracy: 92.58% (4629/5000), Test loss:0.2522
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance90_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 92.52% (9252/10000), Test loss:0.2619
Epoch [49/90], Passed time:[88.384/4330.793]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0840, training acc = 0.95
Batch [200/352] training loss = 0.0385, training acc = 0.99
Valid Test with nat
Test accuracy: 92.44% (4622/5000), Test loss:0.2611
Epoch [50/90], Passed time:[88.398/4419.895]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0651, training acc = 0.98
Batch [200/352] training loss = 0.0449, training acc = 1.00
Valid Test with nat
Test accuracy: 92.54% (4627/5000), Test loss:0.2572
Epoch [51/90], Passed time:[88.419/4509.353]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0540, training acc = 0.98
Batch [200/352] training loss = 0.0607, training acc = 0.98
Valid Test with nat
Test accuracy: 92.74% (4637/5000), Test loss:0.2666
Epoch [52/90], Passed time:[88.413/4597.484]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0452, training acc = 0.97
Batch [200/352] training loss = 0.1202, training acc = 0.95
Valid Test with nat
Test accuracy: 92.80% (4640/5000), Test loss:0.2606
Epoch [53/90], Passed time:[88.360/4683.056]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0302, training acc = 0.98
Batch [200/352] training loss = 0.0174, training acc = 1.00
Valid Test with nat
Test accuracy: 92.64% (4632/5000), Test loss:0.2616
Epoch [54/90], Passed time:[88.421/4774.749]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0692, training acc = 0.97
Batch [200/352] training loss = 0.0517, training acc = 0.98
Valid Test with nat
Test accuracy: 92.80% (4640/5000), Test loss:0.3110
Epoch [55/90], Passed time:[88.452/4864.886]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0406, training acc = 0.98
Batch [200/352] training loss = 0.0375, training acc = 0.98
Valid Test with nat
Test accuracy: 92.68% (4634/5000), Test loss:0.2699
Epoch [56/90], Passed time:[88.483/4955.065]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0486, training acc = 0.98
Batch [200/352] training loss = 0.0797, training acc = 0.96
Valid Test with nat
Test accuracy: 92.64% (4632/5000), Test loss:0.2750
Epoch [57/90], Passed time:[88.490/5043.940]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0346, training acc = 0.99
Batch [200/352] training loss = 0.0670, training acc = 0.96
Valid Test with nat
Test accuracy: 92.72% (4636/5000), Test loss:0.2846
Epoch [58/90], Passed time:[88.483/5132.020]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0219, training acc = 0.99
Batch [200/352] training loss = 0.0660, training acc = 0.99
Valid Test with nat
Test accuracy: 92.96% (4648/5000), Test loss:0.2905
Epoch [59/90], Passed time:[88.367/5213.643]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0534, training acc = 0.97
Batch [200/352] training loss = 0.0226, training acc = 0.99
Valid Test with nat
Test accuracy: 92.88% (4644/5000), Test loss:0.2800
Epoch [60/90], Passed time:[88.368/5302.091]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0290, training acc = 0.99
Batch [200/352] training loss = 0.0501, training acc = 0.98
Valid Test with nat
Test accuracy: 92.92% (4646/5000), Test loss:0.2758
Epoch [61/90], Passed time:[88.354/5389.581]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0486, training acc = 0.99
Batch [200/352] training loss = 0.0377, training acc = 0.98
Valid Test with nat
Test accuracy: 92.58% (4629/5000), Test loss:0.2943
Epoch [62/90], Passed time:[88.411/5481.504]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0532, training acc = 0.98
Batch [200/352] training loss = 0.0339, training acc = 0.98
Valid Test with nat
Test accuracy: 92.74% (4637/5000), Test loss:0.2828
Epoch [63/90], Passed time:[88.390/5568.578]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0233, training acc = 0.99
Batch [200/352] training loss = 0.0207, training acc = 1.00
Valid Test with nat
Test accuracy: 92.86% (4643/5000), Test loss:0.2884
Epoch [64/90], Passed time:[88.438/5660.063]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0948, training acc = 0.95
Batch [200/352] training loss = 0.0450, training acc = 0.98
Valid Test with nat
Test accuracy: 93.00% (4650/5000), Test loss:0.2909
Epoch [65/90], Passed time:[88.409/5746.560]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0318, training acc = 0.99
Batch [200/352] training loss = 0.0418, training acc = 0.99
Valid Test with nat
Test accuracy: 92.80% (4640/5000), Test loss:0.2882
Epoch [66/90], Passed time:[88.395/5834.080]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0384, training acc = 0.98
Batch [200/352] training loss = 0.0145, training acc = 1.00
Valid Test with nat
Test accuracy: 92.76% (4638/5000), Test loss:0.3215
Epoch [67/90], Passed time:[88.358/5920.001]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.0358, training acc = 0.98
Batch [200/352] training loss = 0.0473, training acc = 0.98
Valid Test with nat
Test accuracy: 92.60% (4630/5000), Test loss:0.2981
Epoch [68/90], Passed time:[88.408/6011.751]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0232, training acc = 0.99
Batch [200/352] training loss = 0.0523, training acc = 0.98
Valid Test with nat
Test accuracy: 92.80% (4640/5000), Test loss:0.2935
Epoch [69/90], Passed time:[88.485/6105.495]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0739, training acc = 0.98
Batch [200/352] training loss = 0.0215, training acc = 0.99
Valid Test with nat
Test accuracy: 92.76% (4638/5000), Test loss:0.2968
Epoch [70/90], Passed time:[88.542/6197.939]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0194, training acc = 0.99
Batch [200/352] training loss = 0.0518, training acc = 0.98
Valid Test with nat
Test accuracy: 92.90% (4645/5000), Test loss:0.2889
Epoch [71/90], Passed time:[88.556/6287.510]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0568, training acc = 0.99
Batch [200/352] training loss = 0.0370, training acc = 0.98
Valid Test with nat
Test accuracy: 92.86% (4643/5000), Test loss:0.3255
Epoch [72/90], Passed time:[88.610/6379.938]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0138, training acc = 1.00
Batch [200/352] training loss = 0.0267, training acc = 1.00
Valid Test with nat
Test accuracy: 93.06% (4653/5000), Test loss:0.2898
Epoch [73/90], Passed time:[88.675/6473.257]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0306, training acc = 0.99
Batch [200/352] training loss = 0.0492, training acc = 0.98
Valid Test with nat
Test accuracy: 92.94% (4647/5000), Test loss:0.2939
Epoch [74/90], Passed time:[88.735/6566.384]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0359, training acc = 0.98
Batch [200/352] training loss = 0.0452, training acc = 0.98
Valid Test with nat
Test accuracy: 92.88% (4644/5000), Test loss:0.2881
Epoch [75/90], Passed time:[88.728/6654.608]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0263, training acc = 0.99
Batch [200/352] training loss = 0.0197, training acc = 0.99
Valid Test with nat
Test accuracy: 93.06% (4653/5000), Test loss:0.2860
Epoch [76/90], Passed time:[88.735/6743.825]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0334, training acc = 0.99
Batch [200/352] training loss = 0.0215, training acc = 0.99
Valid Test with nat
Test accuracy: 92.90% (4645/5000), Test loss:0.2874
Epoch [77/90], Passed time:[88.756/6834.207]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0406, training acc = 0.98
Batch [200/352] training loss = 0.0164, training acc = 0.99
Valid Test with nat
Test accuracy: 92.98% (4649/5000), Test loss:0.2997
Epoch [78/90], Passed time:[88.784/6925.144]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0122, training acc = 1.00
Batch [200/352] training loss = 0.0360, training acc = 0.98
Valid Test with nat
Test accuracy: 93.02% (4651/5000), Test loss:0.3003
Epoch [79/90], Passed time:[88.793/7014.683]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0390, training acc = 0.99
Batch [200/352] training loss = 0.0428, training acc = 0.98
Valid Test with nat
Test accuracy: 93.02% (4651/5000), Test loss:0.3332
Epoch [80/90], Passed time:[88.847/7107.776]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0131, training acc = 1.00
Batch [200/352] training loss = 0.0211, training acc = 0.99
Valid Test with nat
Test accuracy: 93.06% (4653/5000), Test loss:0.2884
Epoch [81/90], Passed time:[88.821/7194.501]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0145, training acc = 0.99
Batch [200/352] training loss = 0.0135, training acc = 1.00
Valid Test with nat
Test accuracy: 93.00% (4650/5000), Test loss:0.2905
Epoch [82/90], Passed time:[88.864/7286.854]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0192, training acc = 0.99
Batch [200/352] training loss = 0.0141, training acc = 1.00
Valid Test with nat
Test accuracy: 92.96% (4648/5000), Test loss:0.2861
Epoch [83/90], Passed time:[88.859/7375.311]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0124, training acc = 1.00
Batch [200/352] training loss = 0.0504, training acc = 0.98
Valid Test with nat
Test accuracy: 92.84% (4642/5000), Test loss:0.2867
Epoch [84/90], Passed time:[88.775/7457.078]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0672, training acc = 0.98
Batch [200/352] training loss = 0.0089, training acc = 1.00
Valid Test with nat
Test accuracy: 92.98% (4649/5000), Test loss:0.2877
Epoch [85/90], Passed time:[88.704/7539.870]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0366, training acc = 0.99
Batch [200/352] training loss = 0.0066, training acc = 1.00
Valid Test with nat
Test accuracy: 93.00% (4650/5000), Test loss:0.2968
Epoch [86/90], Passed time:[88.569/7616.973]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0443, training acc = 0.98
Batch [200/352] training loss = 0.0380, training acc = 0.99
Valid Test with nat
Test accuracy: 92.96% (4648/5000), Test loss:0.2936
Epoch [87/90], Passed time:[88.462/7696.236]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0331, training acc = 0.99
Batch [200/352] training loss = 0.0176, training acc = 1.00
Valid Test with nat
Test accuracy: 92.94% (4647/5000), Test loss:0.2989
Epoch [88/90], Passed time:[88.391/7778.433]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0396, training acc = 0.98
Batch [200/352] training loss = 0.0150, training acc = 0.99
Valid Test with nat
Test accuracy: 93.12% (4656/5000), Test loss:0.2890
Epoch [89/90], Passed time:[88.323/7860.759]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.0139, training acc = 1.00
Batch [200/352] training loss = 0.0264, training acc = 0.99
Valid Test with nat
Test accuracy: 93.06% (4653/5000), Test loss:0.2883
Training done, model saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance90_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 93.45% (9345/10000), Test loss:0.2970
