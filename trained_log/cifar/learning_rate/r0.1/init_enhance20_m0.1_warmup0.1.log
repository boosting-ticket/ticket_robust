model_type : resnet18
init_type : pure
finetune_method : nat
enhance_method : nat
gpu : 4
model_name : init_enhance20_m0.1_warmup0.1
model_width : 8
n_pruning_steps : 1
max_pruning_ratio : 80
train_epochs : 20
enhance_epochs : 20
prune_method : unstructured
dataset : cifar
noise_sd : 1.0
trades_beta : 6.0
seed : 7
warmup : True
parallel : False
create_init : False
init_step : 1400
train_method : nat
early_stop : 1000
norm : True
optm : sgd
batch_size : 128
test_batch_size : 100
learning_rate : 0.1
enhance_learning_rate : 0.1
schedule_length : 10
weight_decay : 0.0001
epsilon : 0.03137254901960784
attack_iter : 10
eps_step : 0.00784313725490196
targeted : False
clip_min : 0
clip_max : 1.0
starting_epsilon : 1e-05
interval_weight : 0.1
ft_interval_weight : 50
verbose : 200
resume : 0
model_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.1_warmup0.1.pth
last_model_path : ./trained_models_new/
mask_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/pruned_lr0.1_mask_r80.npy
mask_name : pruned_lr0.1_mask_r80
log_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.1_warmup0.1.log
init_path : ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
results_path : None
n_classes : 10
eval : False
init : True
transfer : False
CUDA enabled.
Enhance training config:
Enhance training method: nat
model will be saved in: ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.1_warmup0.1.pth
Init model is: ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
Init mask used from: ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/pruned_lr0.1_mask_r80.npy
Log will be saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.1_warmup0.1.log
Random seed is: 7

model loading from ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
Epoch [0/20]
learning rate: 0.05
Batch [0/352] training loss = 2.3339, training acc = 0.12
Batch [200/352] training loss = 1.4568, training acc = 0.42
Valid Test with nat
Test accuracy: 47.08% (2354/5000), Test loss:1.6841
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 46.13% (4613/10000), Test loss:1.7091
Epoch [1/20], Passed time:[76.944/76.944]
learning rate: 0.055
Batch [0/352] training loss = 1.2090, training acc = 0.56
Batch [200/352] training loss = 1.2143, training acc = 0.59
Valid Test with nat
Test accuracy: 66.28% (3314/5000), Test loss:0.9990
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 65.48% (6548/10000), Test loss:1.0107
Epoch [2/20], Passed time:[81.369/162.738]
learning rate: 0.060000000000000005
Batch [0/352] training loss = 0.7740, training acc = 0.70
Batch [200/352] training loss = 0.6964, training acc = 0.75
Valid Test with nat
Test accuracy: 70.28% (3514/5000), Test loss:0.9266
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 68.64% (6864/10000), Test loss:0.9548
Epoch [3/20], Passed time:[85.472/256.415]
learning rate: 0.065
Batch [0/352] training loss = 0.7613, training acc = 0.70
Batch [200/352] training loss = 0.7098, training acc = 0.76
Valid Test with nat
Test accuracy: 72.54% (3627/5000), Test loss:0.8091
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 71.56% (7156/10000), Test loss:0.8482
Epoch [4/20], Passed time:[86.690/346.760]
learning rate: 0.07
Batch [0/352] training loss = 0.6780, training acc = 0.77
Batch [200/352] training loss = 0.6809, training acc = 0.79
Valid Test with nat
Test accuracy: 75.56% (3778/5000), Test loss:0.7631
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 76.10% (7610/10000), Test loss:0.7369
Epoch [5/20], Passed time:[87.730/438.648]
learning rate: 0.07500000000000001
Batch [0/352] training loss = 0.5833, training acc = 0.79
Batch [200/352] training loss = 0.5895, training acc = 0.79
Valid Test with nat
Test accuracy: 76.40% (3820/5000), Test loss:0.7509
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 75.24% (7524/10000), Test loss:0.7792
Epoch [6/20], Passed time:[87.763/526.576]
learning rate: 0.08000000000000002
Batch [0/352] training loss = 0.3211, training acc = 0.91
Batch [200/352] training loss = 0.4041, training acc = 0.83
Valid Test with nat
Test accuracy: 78.90% (3945/5000), Test loss:0.7025
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 77.91% (7791/10000), Test loss:0.7214
Epoch [7/20], Passed time:[88.521/619.649]
learning rate: 0.085
Batch [0/352] training loss = 0.5847, training acc = 0.79
Batch [200/352] training loss = 0.4339, training acc = 0.85
Valid Test with nat
Test accuracy: 80.80% (4040/5000), Test loss:0.6341
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 80.15% (8015/10000), Test loss:0.6413
Epoch [8/20], Passed time:[89.121/712.969]
learning rate: 0.09
Batch [0/352] training loss = 0.5461, training acc = 0.80
Batch [200/352] training loss = 0.4164, training acc = 0.88
Valid Test with nat
Test accuracy: 82.30% (4115/5000), Test loss:0.5526
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 81.47% (8147/10000), Test loss:0.6023
Epoch [9/20], Passed time:[89.927/809.347]
learning rate: 0.095
Batch [0/352] training loss = 0.3766, training acc = 0.87
Batch [200/352] training loss = 0.4128, training acc = 0.85
Valid Test with nat
Test accuracy: 82.02% (4101/5000), Test loss:0.5595
Epoch [10/20], Passed time:[90.369/903.690]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.4248, training acc = 0.84
Batch [200/352] training loss = 0.2134, training acc = 0.94
Valid Test with nat
Test accuracy: 88.50% (4425/5000), Test loss:0.3512
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 87.98% (8798/10000), Test loss:0.3703
Epoch [11/20], Passed time:[91.040/1001.445]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.2481, training acc = 0.91
Batch [200/352] training loss = 0.3902, training acc = 0.84
Valid Test with nat
Test accuracy: 88.74% (4437/5000), Test loss:0.3476
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 88.53% (8853/10000), Test loss:0.3577
Epoch [12/20], Passed time:[91.729/1100.750]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.2523, training acc = 0.91
Batch [200/352] training loss = 0.2283, training acc = 0.91
Valid Test with nat
Test accuracy: 89.02% (4451/5000), Test loss:0.3287
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 88.98% (8898/10000), Test loss:0.3446
Epoch [13/20], Passed time:[92.324/1200.218]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.1425, training acc = 0.95
Batch [200/352] training loss = 0.3529, training acc = 0.91
Valid Test with nat
Test accuracy: 89.08% (4454/5000), Test loss:0.3287
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 88.73% (8873/10000), Test loss:0.3425
Epoch [14/20], Passed time:[92.901/1300.609]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.1324, training acc = 0.96
Batch [200/352] training loss = 0.1369, training acc = 0.95
Valid Test with nat
Test accuracy: 89.20% (4460/5000), Test loss:0.3287
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 88.93% (8893/10000), Test loss:0.3484
Epoch [15/20], Passed time:[93.440/1401.606]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.2066, training acc = 0.91
Batch [200/352] training loss = 0.3194, training acc = 0.89
Valid Test with nat
Test accuracy: 89.54% (4477/5000), Test loss:0.3154
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 89.37% (8937/10000), Test loss:0.3357
Epoch [16/20], Passed time:[93.541/1496.653]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.1283, training acc = 0.94
Batch [200/352] training loss = 0.2219, training acc = 0.90
Valid Test with nat
Test accuracy: 89.72% (4486/5000), Test loss:0.3160
Epoch [17/20], Passed time:[93.651/1592.059]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.2430, training acc = 0.89
Batch [200/352] training loss = 0.2139, training acc = 0.93
Valid Test with nat
Test accuracy: 89.82% (4491/5000), Test loss:0.3226
Epoch [18/20], Passed time:[93.668/1686.027]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.2156, training acc = 0.93
Batch [200/352] training loss = 0.3199, training acc = 0.90
Valid Test with nat
Test accuracy: 89.72% (4486/5000), Test loss:0.3241
Epoch [19/20], Passed time:[93.519/1776.864]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.2402, training acc = 0.89
Batch [200/352] training loss = 0.1465, training acc = 0.94
Valid Test with nat
Test accuracy: 89.92% (4496/5000), Test loss:0.3099
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 89.29% (8929/10000), Test loss:0.3358
Training done, model saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance20_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 89.29% (8929/10000), Test loss:0.3358
