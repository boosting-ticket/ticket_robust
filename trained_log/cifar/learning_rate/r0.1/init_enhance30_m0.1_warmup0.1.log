model_type : resnet18
init_type : pure
finetune_method : nat
enhance_method : nat
gpu : 8
model_name : init_enhance30_m0.1_warmup0.1
model_width : 8
n_pruning_steps : 1
max_pruning_ratio : 80
train_epochs : 30
enhance_epochs : 30
prune_method : unstructured
dataset : cifar
noise_sd : 1.0
trades_beta : 6.0
seed : 7
warmup : True
parallel : False
create_init : False
init_step : 1400
train_method : nat
early_stop : 1000
norm : True
optm : sgd
batch_size : 128
test_batch_size : 100
learning_rate : 0.1
enhance_learning_rate : 0.1
schedule_length : 10
weight_decay : 0.0001
epsilon : 0.03137254901960784
attack_iter : 10
eps_step : 0.00784313725490196
targeted : False
clip_min : 0
clip_max : 1.0
starting_epsilon : 1e-05
interval_weight : 0.1
ft_interval_weight : 50
verbose : 200
resume : 0
model_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.1_warmup0.1.pth
last_model_path : ./trained_models_new/
mask_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/pruned_lr0.1_mask_r80.npy
mask_name : pruned_lr0.1_mask_r80
log_path : ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.1_warmup0.1.log
init_path : ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
results_path : None
n_classes : 10
eval : False
init : True
transfer : False
CUDA enabled.
Enhance training config:
Enhance training method: nat
model will be saved in: ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.1_warmup0.1.pth
Init model is: ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
Init mask used from: ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/pruned_lr0.1_mask_r80.npy
Log will be saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.1_warmup0.1.log
Random seed is: 7

model loading from ./trained_models_new/cifar/resnet18/init/pure_resnet18_init.pth
Epoch [0/30]
learning rate: 0.05
Batch [0/352] training loss = 2.3339, training acc = 0.12
Batch [200/352] training loss = 1.4568, training acc = 0.42
Valid Test with nat
Test accuracy: 47.08% (2354/5000), Test loss:1.6841
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 46.13% (4613/10000), Test loss:1.7091
Epoch [1/30], Passed time:[83.049/83.049]
learning rate: 0.055
Batch [0/352] training loss = 1.2090, training acc = 0.56
Batch [200/352] training loss = 1.2143, training acc = 0.59
Valid Test with nat
Test accuracy: 66.28% (3314/5000), Test loss:0.9990
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 65.48% (6548/10000), Test loss:1.0107
Epoch [2/30], Passed time:[82.777/165.554]
learning rate: 0.060000000000000005
Batch [0/352] training loss = 0.7740, training acc = 0.70
Batch [200/352] training loss = 0.6964, training acc = 0.75
Valid Test with nat
Test accuracy: 70.28% (3514/5000), Test loss:0.9266
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 68.64% (6864/10000), Test loss:0.9548
Epoch [3/30], Passed time:[81.754/245.263]
learning rate: 0.065
Batch [0/352] training loss = 0.7613, training acc = 0.70
Batch [200/352] training loss = 0.7098, training acc = 0.76
Valid Test with nat
Test accuracy: 72.54% (3627/5000), Test loss:0.8091
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 71.56% (7156/10000), Test loss:0.8482
Epoch [4/30], Passed time:[80.396/321.582]
learning rate: 0.07
Batch [0/352] training loss = 0.6780, training acc = 0.77
Batch [200/352] training loss = 0.6809, training acc = 0.79
Valid Test with nat
Test accuracy: 75.56% (3778/5000), Test loss:0.7631
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 76.10% (7610/10000), Test loss:0.7369
Epoch [5/30], Passed time:[78.358/391.788]
learning rate: 0.07500000000000001
Batch [0/352] training loss = 0.5833, training acc = 0.79
Batch [200/352] training loss = 0.5895, training acc = 0.79
Valid Test with nat
Test accuracy: 76.40% (3820/5000), Test loss:0.7509
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 75.24% (7524/10000), Test loss:0.7792
Epoch [6/30], Passed time:[78.606/471.639]
learning rate: 0.08000000000000002
Batch [0/352] training loss = 0.3211, training acc = 0.91
Batch [200/352] training loss = 0.4041, training acc = 0.83
Valid Test with nat
Test accuracy: 78.90% (3945/5000), Test loss:0.7025
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 77.91% (7791/10000), Test loss:0.7214
Epoch [7/30], Passed time:[78.850/551.952]
learning rate: 0.085
Batch [0/352] training loss = 0.5847, training acc = 0.79
Batch [200/352] training loss = 0.4339, training acc = 0.85
Valid Test with nat
Test accuracy: 80.80% (4040/5000), Test loss:0.6341
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 80.15% (8015/10000), Test loss:0.6413
Epoch [8/30], Passed time:[79.329/634.629]
learning rate: 0.09
Batch [0/352] training loss = 0.5461, training acc = 0.80
Batch [200/352] training loss = 0.4164, training acc = 0.88
Valid Test with nat
Test accuracy: 82.30% (4115/5000), Test loss:0.5526
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 81.47% (8147/10000), Test loss:0.6023
Epoch [9/30], Passed time:[80.564/725.079]
learning rate: 0.095
Batch [0/352] training loss = 0.3766, training acc = 0.87
Batch [200/352] training loss = 0.4128, training acc = 0.85
Valid Test with nat
Test accuracy: 82.02% (4101/5000), Test loss:0.5595
Epoch [10/30], Passed time:[80.809/808.088]
learning rate: 0.1
Batch [0/352] training loss = 0.4248, training acc = 0.84
Batch [200/352] training loss = 0.3382, training acc = 0.91
Valid Test with nat
Test accuracy: 83.92% (4196/5000), Test loss:0.5264
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 83.65% (8365/10000), Test loss:0.4944
Epoch [11/30], Passed time:[81.656/898.215]
learning rate: 0.1
Batch [0/352] training loss = 0.3641, training acc = 0.87
Batch [200/352] training loss = 0.5245, training acc = 0.85
Valid Test with nat
Test accuracy: 85.86% (4293/5000), Test loss:0.4479
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 85.58% (8558/10000), Test loss:0.4239
Epoch [12/30], Passed time:[82.305/987.666]
learning rate: 0.1
Batch [0/352] training loss = 0.3093, training acc = 0.90
Batch [200/352] training loss = 0.3456, training acc = 0.90
Valid Test with nat
Test accuracy: 84.60% (4230/5000), Test loss:0.4970
Epoch [13/30], Passed time:[82.838/1076.889]
learning rate: 0.1
Batch [0/352] training loss = 0.2800, training acc = 0.90
Batch [200/352] training loss = 0.3086, training acc = 0.89
Valid Test with nat
Test accuracy: 85.52% (4276/5000), Test loss:0.4482
Epoch [14/30], Passed time:[83.172/1164.412]
learning rate: 0.1
Batch [0/352] training loss = 0.3241, training acc = 0.88
Batch [200/352] training loss = 0.3906, training acc = 0.90
Valid Test with nat
Test accuracy: 82.46% (4123/5000), Test loss:0.5641
Epoch [15/30], Passed time:[83.433/1251.493]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.4291, training acc = 0.87
Batch [200/352] training loss = 0.2150, training acc = 0.93
Valid Test with nat
Test accuracy: 89.72% (4486/5000), Test loss:0.3113
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 89.68% (8968/10000), Test loss:0.3171
Epoch [16/30], Passed time:[83.873/1341.971]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.1411, training acc = 0.95
Batch [200/352] training loss = 0.2484, training acc = 0.93
Valid Test with nat
Test accuracy: 90.34% (4517/5000), Test loss:0.2994
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 90.01% (9001/10000), Test loss:0.3030
Epoch [17/30], Passed time:[84.376/1434.391]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.2076, training acc = 0.92
Batch [200/352] training loss = 0.1166, training acc = 0.95
Valid Test with nat
Test accuracy: 90.46% (4523/5000), Test loss:0.3093
Epoch [18/30], Passed time:[84.299/1517.376]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.2467, training acc = 0.91
Batch [200/352] training loss = 0.2350, training acc = 0.91
Valid Test with nat
Test accuracy: 90.32% (4516/5000), Test loss:0.3159
Epoch [19/30], Passed time:[84.349/1602.631]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.1637, training acc = 0.94
Batch [200/352] training loss = 0.1649, training acc = 0.96
Valid Test with nat
Test accuracy: 90.34% (4517/5000), Test loss:0.3095
Epoch [20/30], Passed time:[84.547/1690.944]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.1706, training acc = 0.94
Batch [200/352] training loss = 0.1895, training acc = 0.92
Valid Test with nat
Test accuracy: 90.66% (4533/5000), Test loss:0.2966
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 90.61% (9061/10000), Test loss:0.2953
Epoch [21/30], Passed time:[84.649/1777.634]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.1647, training acc = 0.95
Batch [200/352] training loss = 0.0977, training acc = 0.97
Valid Test with nat
Test accuracy: 90.68% (4534/5000), Test loss:0.3111
Epoch [22/30], Passed time:[84.278/1854.106]
learning rate: 0.010000000000000002
Batch [0/352] training loss = 0.1238, training acc = 0.96
Batch [200/352] training loss = 0.1487, training acc = 0.96
Valid Test with nat
Test accuracy: 90.56% (4528/5000), Test loss:0.2986
Epoch [23/30], Passed time:[84.140/1935.221]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.2056, training acc = 0.93
Batch [200/352] training loss = 0.1195, training acc = 0.95
Valid Test with nat
Test accuracy: 91.00% (4550/5000), Test loss:0.2929
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 90.90% (9090/10000), Test loss:0.2940
Epoch [24/30], Passed time:[84.285/2022.830]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.1609, training acc = 0.95
Batch [200/352] training loss = 0.1797, training acc = 0.94
Valid Test with nat
Test accuracy: 91.04% (4552/5000), Test loss:0.2945
Epoch [25/30], Passed time:[84.361/2109.020]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.1279, training acc = 0.97
Batch [200/352] training loss = 0.1138, training acc = 0.95
Valid Test with nat
Test accuracy: 90.94% (4547/5000), Test loss:0.3112
Epoch [26/30], Passed time:[84.336/2192.735]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.1659, training acc = 0.94
Batch [200/352] training loss = 0.2501, training acc = 0.93
Valid Test with nat
Test accuracy: 91.06% (4553/5000), Test loss:0.3520
Epoch [27/30], Passed time:[84.208/2273.606]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.2334, training acc = 0.90
Batch [200/352] training loss = 0.1013, training acc = 0.95
Valid Test with nat
Test accuracy: 91.06% (4553/5000), Test loss:0.3087
Epoch [28/30], Passed time:[84.152/2356.255]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.1198, training acc = 0.97
Batch [200/352] training loss = 0.1304, training acc = 0.96
Valid Test with nat
Test accuracy: 91.04% (4552/5000), Test loss:0.2907
Best model so far saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 91.00% (9100/10000), Test loss:0.2968
Epoch [29/30], Passed time:[84.433/2448.564]
learning rate: 0.0010000000000000002
Batch [0/352] training loss = 0.1180, training acc = 0.95
Batch [200/352] training loss = 0.1418, training acc = 0.92
Valid Test with nat
Test accuracy: 90.96% (4548/5000), Test loss:0.2967
Training done, model saved in ./trained_models_new/cifar/resnet18/nat/pruned1_epoch100_r80/init_pure/init_enhance30_m0.1_warmup0.1.pth
Test on test set:
Test accuracy: 90.86% (9086/10000), Test loss:0.2984
